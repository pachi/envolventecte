{"version":3,"sources":["stores/GuiState.js","version.js","components/ui/Footer.js","utils.js","stores/defaults.js","stores/types.js","stores/AppState.js","components/img/logo.svg","components/img/outline-live_help-24px.svg","components/img/outline-info-24px.svg","components/img/baseline-archive-24px.svg","components/ui/Nav.js","components/ui/Page.js","components/img/FotoDani.jpg","components/img/FotoMarta.jpg","components/about/AboutPage.js","components/img/FotoPachi.jpg","components/img/baseline-add-24px.svg","components/img/baseline-remove-24px.svg","components/img/select-rows.svg","components/img/unselect-rows.svg","components/img/outline-file_copy-24px.svg","components/img/arrow_up.svg","components/img/arrow_down.svg","components/ui/AddRemoveButtonGroup.js","components/img/full_geom_icon.svg","components/img/null_pos_icon.svg","components/img/valid_pos_icon.svg","components/img/valid_poly_icon.svg","components/img/null_poly_icon.svg","components/img/partial_geom_icon.svg","components/helpers/IconsOrientaciones.js","components/tables/utils.js","components/tables/Formatters.js","components/ui/ListEditor.js","components/building/GeometryEditors.js","components/building/HuecosTable.js","components/building/HuecosView.js","components/building/OpacosTable.js","components/building/OpacosView.js","components/tables/Validators.js","components/building/PTsTable.js","components/building/PTsView.js","components/building/ShadesTable.js","components/building/ShadesView.js","components/building/SpacesTable.js","components/building/SpacesView.js","components/indicators/IndicatorsPanel.js","components/ui/PageWithIndicators.js","components/building/BuildingPage.js","components/uses/LoadsTable.js","components/uses/LoadsView.js","components/uses/ScheduleHoursEditor.js","components/uses/SchedulesDayTable.js","components/uses/SchedulesDayView.js","components/uses/ScheduleCountsEditor.js","components/uses/SchedulesWeekTable.js","components/uses/SchedulesWeekView.js","components/uses/SchedulesYearTable.js","components/uses/SchedulesYearView.js","components/uses/ThermostatsTable.js","components/uses/ThermostatsView.js","components/uses/UsesPage.js","components/constructions/LayersEditors.js","components/constructions/WallConsTable.js","components/constructions/WallConsView.js","components/constructions/WinConsTable.js","components/constructions/WinConsView.js","components/constructions/MaterialsTable.js","components/constructions/MaterialsView.js","components/constructions/GlassesTable.js","components/constructions/GlassesView.js","components/constructions/FramesTable.js","components/constructions/FramesView.js","components/constructions/ConsPage.js","components/three/ctematerials.js","components/three/ctemodel.js","components/three/gui/GUIView.js","components/three/ThreeView.js","components/three/ThreeDPage.js","components/helpers/elements.js","components/helpers/WindowProperties.js","components/helpers/MonthlyRadiationTable.js","components/helpers/IconsFshwith.js","components/helpers/ShadingFactorsTable.js","components/helpers/BoundaryWall.js","components/helpers/HelpersPage.js","components/img/5R1C.svg","components/img/orientaciones.svg","components/help/HelpPage.js","components/main/MainPage.js","components/reports/KChart.js","components/reports/KDetail.js","components/reports/UChart.js","components/reports/UDetail.js","components/reports/QSolJulChart.js","components/reports/QSolJulDetail.js","components/reports/N50Chart.js","components/reports/N50Detail.js","components/img/print-solid.svg","components/reports/He1Report.js","components/reports/QuantitiesReport.js","components/reports/ReportsPage.js","components/project/ClimateSelector.js","components/project/ProjectData.js","components/ui/DropZone.js","components/project/HulcImport.js","components/img/outline-new_document-24px.svg","components/project/EmptyModel.js","components/project/LoadData.js","components/project/ProjectPage.js","components/JsonDetail.js","components/App.js","main.js","../wasm/pkg/wasm_envolventecte_bg.js"],"names":["createContext","showJsonTab","makeAutoObservable","toggleShowJsonTab","this","GuiState","APP_VERSION","Footer","Row","Col","className","style","backgroundColor","uuidv4","replace","c","crypto","getRandomValues","Uint8Array","toString","round_or_dash","val","numDecimals","undefined","isNaN","toFixed","defaultsSpace","kind","name","multiplier","inside_tenv","z","loads","thermostats","n_v","illuminance","defaultsWall","next_to","defaultsWallgeom","position","polygon","defaultsWindow","defaultsWingeom","defaultsShade","defaultsTb","l","psi","defaultsWallcons","layers","defaultsWincons","g_glshwi","defaultsMaterial","defaultsGlass","defaultsFrame","newMeta","defaultsMeta","new_meta","global_ventilation_l_s","n50_test_ach","d_perim_insulation","rn_perim_insulation","defaultsLoad","people_schedule","lighting_schedule","equipment_schedule","defaultsSysSetting","temp_max","temp_min","defaultsScheduleDay","values","defaultsScheduleWeek","defaultsScheduleYear","SPACE","WALL","WINDOW","THERMAL_BRIDGE","SHADE","WALLCONS","WINCONS","MATERIAL","GLASS","FRAME","SCHEDULE_YEAR","SCHEDULE_WEEK","SCHEDULE_DAY","LOAD","THERMOSTAT","BOUNDARY_TYPES","BOUNDARY_TYPES_MAP","EXTERIOR","INTERIOR","ADIABATIC","GROUND","SPACE_TYPES","SPACE_TYPES_MAP","CONDITIONED","UNCONDITIONED","UNINHABITED","THERMAL_BRIDGE_TYPES_MAP","ROOF","BALCONY","CORNER","INTERMEDIATEFLOOR","INTERNALWALL","GROUNDFLOOR","PILLAR","GENERIC","ORIENTATION_TYPES","configure","enforceActions","MONTHLYRADIATIONDATA","get_monthly_radiation_data","EMPTY_ID","AppState","meta","spaces","walls","windows","shades","thermal_bridges","cons","wallcons","wincons","materials","glasses","frames","schedules","year","week","day","errors","makeObservable","observable","energy_indicators","computed","requiresReaction","zoneslist","orientations","warnings","climatedata","climateTotRadJul","addElement","action","duplicateElements","deleteElements","handleUpload","loadModel","clearModel","purgeModel","asJSON","loadData","Set","map","v","zone","orientation","filter","climate","reduce","acc","dir","dif","getModel","concat","elementType","types","idNameMap","getElements","s","id","addEmpty","opts","value","label","unshift","el","new_space","push","w","new_wall","geom","geometry","newWall","new_window","newWindow","new_thermalbridge","new_shade","newShade","new_wallcons","new_wincons","new_material","new_glass","new_frame","new_load","new_thermostat","new_schedule_day","new_schedule_week","new_schedule_year","selection","container","newIds","forEach","selectedIndex","findIndex","h","idx","selectedObj","newId","dupObj","splice","length","indices","cur","includes","minidx","Math","max","min","filtered","prev","elem","slice","next","purge_unused","cleanModel","model","inputData","tb","e","JSON","stringify","acceptedFiles","purge","file","reader","FileReader","onload","rawData","path","target","result","toLowerCase","readAsText","data","mode","loadWarnings","load_fshobst_data_from_kyg","load_data_from_ctehexml","load_data_from_json","level","msg","join","window","fshobst","err","appstate","example","NavBar","observer","projectName","useContext","guiState","Navbar","bg","variant","Brand","to","title","src","imglogo","height","alt","Toggle","Collapse","Nav","eventKey","Link","borderLeft","margin","md","Form","Group","as","Label","column","htmlFor","sm","Select","size","onChange","placeholder","onClick","_e","contents","contenthash","str","hashvalue","i","charCodeAt","hash","filename","blob","Blob","type","uri","URL","createObjectURL","link","document","createElement","download","href","body","appendChild","click","removeChild","open","handleDownload","icondownload","iconhelp","Item","iconinfo","Page","route","children","Container","fluid","AboutPage","get_version","Alert","span","offset","Image","FotoDani","FotoMarta","AddRemoveButtonGroup","selectedIds","setSelectedIds","ButtonToolbar","ButtonGroup","Button","newid","iconplus","newids","iconduplicate","iconless","iconselectall","iconselectnone","moveUpFirstSelectedElement","iconarrowup","moveDownFirstSelectedElement","iconarrowdown","OrientacionesSprite","xmlns","display","viewBox","d","fill","color","opacity","cx","cy","stroke","strokeWidth","rx","ry","width","y","x","OrientaIcon","verticalAlign","xlinkHref","TiltIcon","getFloatOrOld","newValue","oldValue","parseFloat","normalize","start","end","floor","selectColor","saturation","goldenAngle","hue","brightness","Float0DigitsFmt","cell","_row","_rowIndex","_formatExtraData","Number","Float1DigitsFmt","Float2DigitsFmt","Float3DigitsFmt","NameFromIdFmt","idMapper","MultiplierFmt","InsideTeFmt","ZFmt","AzimuthFmt","azimuth_angle","azimuth","azimuth_name","TiltFmt","tilt_angle","tilt","tilt_name","PosFmt","pos","OpaqueGeomFmt","poly","point","WindowGeomFmt","setback","WindowGeomIconFmt","row","wallData","wall","has_wall","azimuth_dir","tilt_dir","fullGeometryIcon","partialGeometryIcon","OpaqueGeomIconFmt","BoundaryFmt","BoundaryOpts","Object","keys","k","ThermalBridgeTypesFmt","ThermalBridgeTypesOpts","SpaceTypeFmt","spaceTypesOpts","WallConsThicknessFmt","_cell","wallconsPropsMap","p","thickness","WallConsResistanceFmt","resistance","LayersFmt","xPos","entries","material","mat","conductivity","lambda","getMatColor","find","m","round","WinAreaFmt","winProps","props","area","FshobstFmt","f_shobst_override","f_shobst","WindowUFmt","u_value","WallAreaFmt","wallPropsMap","area_net","WallUFmt","uvalue","SpaceAreaFmt","spacePropsMap","SpaceVolumeFmt","volume_net","WinconsUFmt","propsMap","WinconsGglwiFmt","g_glwi","getY","diff","DayScheduleFmt","svgWidth","pathY","svgHeight","pathCoords","tickCoords","CountScheduleFmt","totalCount","a","b","colors","n","Array","_","palette","colorMap","Map","stepX","key","count","get","ListEditor","list","setList","newElement","element","iconPlus","iconDuplicate","newList","iconLess","iconSelectAll","iconSelectNone","GeometryOpaquesEditor","React","forwardRef","_ref","onUpdate","hasDefinedPos","useState","hasPos","setHasPos","show","setShow","setXPos","yPos","setYPos","zPos","setZPos","X","Y","setPoly","setAzimuth","setTilt","handleCancel","Modal","role","centered","onHide","Header","closeButton","Title","Body","updateData","AzimuthTiltEditor","ev","currentTarget","background","PositionEditor","inputXRef","useRef","inputYRef","inputZRef","ToggleButtonGroup","ToggleButton","Control","ref","readOnly","CoordsTable","selected","setSelected","columns","dataField","isKey","hidden","formatter","text","align","headerTitle","_col","_colIndex","headerClasses","headerAlign","headerFormatter","fontWeight","keyField","striped","hover","bordered","cellEdit","cellEditFactory","blurToSave","afterSaveCell","selectRow","clickToSelect","clickToEdit","onSelect","isSelected","it","hideSelectColumn","bgColor","GeometryWindowEditor","setWidth","setHeight","setSetback","WidthHeightSetbackEditor","winPropsMap","winconsMap","getIdNameMap","wallsMap","winconsOpts","getElementOptions","wallsOpts","error_ids_warning","error_ids_danger","fromEntries","classes","headerStyle","u_value_window","formatExtraData","editor","Type","SELECT","options","editorRenderer","editorProps","isDummyField","editable","rowClasses","_rowIdx","is_tenv","HuecosView","wallconsMap","spaceMap","wallconsOpts","spaceOpts","spaceOptsAndNull","u_value_wall","bounds","A","OpacosView","validateNonNegNumber","_column","valid","message","validateNumber","validateIntegerNumber","validator","headerAttrs","PTsView","tableHeaderClass","ShadesView","InsideTeEditor","cellValue","setValue","checked","onKeyDown","onBlur","NVEditor","defaultValue","res","loadsMap","loadsOpts","thermostatsMap","thermostatsOpts","_columnIndex","customEditor","getElement","SpacesView","setWarnings","area_ref","q_soljul_data","n50_data","K_data","K","q_soljul","n50","numavisos","Badge","clear","in","Card","border","PageWithIndicators","BuildingPage","activeKey","setActiveKey","Tabs","Tab","schedulesMap","schedulesOpts","LoadsView","ScheduleHoursEditor","hourValues","hours","newHourValues","ScheduleHoursTable","SchedulesDayView","ScheduleCountsEditor","idMap","scheduleOpts","schedule_id","yearSchedules","setYearSchedules","schedule","setSchedule","ScheduleListTable","daySchedulesMap","daySchedulesOpts","SchedulesWeekView","weekSchedulesMap","weekSchedulesOpts","SchedulesYearView","ThermostatsView","UsesPage","LayersEditor","layer","setLayers","LayersTable","matsMap","materialOpts","AddRemovePolyButtonGroup","newPoly","walls_Co100","walls_c","mats","WallConsView","winconsPropsMap","glassMap","frameMap","glassOpts","frameOpts","beforeSaveCell","density","specific_heat","MaterialsView","GlassesView","FramesView","FramesTable","ConsPage","material_lines","LineBasicMaterial","linewidth","material_select","MeshLambertMaterial","side","DoubleSide","material_shades","transparent","material_windows","material_adiabatic","material_walls","material_walls_interior","material_walls_ground","material_roofs","material_roofs_interior","material_roofs_ground","material_floors","material_floors_interior","material_floors_ground","getMaterial","mesh","userData","subtype","console","log","degToRad","MathUtils","initObjectsFromModel","scene","buildingGroup","wireframeGroup","bGroup","getObjectByName","remove","rotation","PI","wfGroup","wallUserData","getUserData","wallTransform","transformMatrix","wallLocal2WallPolyTransform","wall_polygon","v0","v1","angleX","Vector2","angle","cos","sin","Matrix3","set","wallLocal2WallPolygon","wallWindows","wallHoles","winContour","getWindowContour","winMesh","meshFromCoords","applyMatrix4","setWindowMeshSetback","add","wallMesh","wireframe","LineSegments","EdgesGeometry","renderOrder","shade","shadeTransform","shadeMesh","obj","parentUserData","prototype","hasOwnProperty","call","getWallSubtype","parent","parentId","contour","points","holes","BufferGeometry","triangles","ShapeUtils","triangulateShape","pointsAll","triangle","j","vertex","setFromPoints","computeVertexNormals","Mesh","castShadow","receiveShadow","applyMatrix3","winSetback","Vector3","fromBufferAttribute","getAttribute","multiplyScalar","translate","toArray","tilt_rot_mat","Matrix4","makeRotationX","azimuth_rot_mat","makeRotationZ","makeTranslation","multiply","abs","globalClippingPlane","Plane","GUIView","renderer","containerRef","params","inspectMode","selectedElementName","showExteriorRoofs","showExteriorWalls","showExteriorFloors","showExteriorWindows","showInteriorWalls","showGroundWalls","showAdiabaticWalls","showShades","zClipping","zClippingValue","lastSelected","initPane","current","pane","dispose","Pane","expanded","folder","addFolder","addInput","on","onselectedElementChange","bind","folder2","step","onOpacityChange","onVisibilityChange","folder3","clippingPlanes","bbox","Box3","setFromObject","zCut","setComponents","clippingValueController","event","traverse","child","oldMaterial","selector","presetKey","_subtype","_type","_bounds","visible","flexFlow","northSymbolCircleMaterial","THREE","northSymbolArrowMaterial","groundPlaneMaterial","ShadowMaterial","createNorthSymbol","symbolGroup","circle","arrowShape","Shape","moveTo","lineTo","closePath","arrow","ShapeGeometry","initGround","groundGroup","ground","PlaneGeometry","gridHelper","GridHelper","setValues","AxesHelper","updateGround","center","getSize","getCenter","maxSize","initLights","group","light_amb","AmbientLight","light","DirectionalLight","shadow","normalBias","bias","camera","left","right","top","bottom","far","mapSize","copy","altitude","dist","azim","sunPos","DirectionalLightHelper","updateCameraAndLight","control","lookAt","fitHeightDistance","atan","fov","fitWidthDistance","aspect","distance","direction","clone","sub","maxDistance","near","updateProjectionMatrix","update","lights","resizeToDisplaySize","canvas","domElement","clientWidth","clientHeight","setSize","guiView","cameraControlRef","ctrlKey","altKey","code","toggle","cameraControl","reset","refresh","onPointerDown","domNodeRef","domNode","rect","getBoundingClientRect","xCoord","clientX","yCoord","clientY","posX","posY","pointer3D","raycaster","Raycaster","setFromCamera","intersects","intersectObjects","getElementById","ll","padding","font","zIndex","getTextElement","objectNames","object","setTextData","gui","innerHTML","li","listStyle","onmouseover","stopPropagation","textContent","onmouseleave","onpointerdown","selectedElement","buttons","guiPaneRef","WebGLRenderer","antialias","alpha","setPixelRatio","devicePixelRatio","shadowMap","enabled","physicallyCorrectLights","PerspectiveCamera","innerWidth","innerHeight","up","Scene","useEffect","OrbitControls","enableDamping","addEventListener","requestID","animate","render","requestAnimationFrame","cancelAnimationFrame","autorun","tabIndex","ThreeDPage","ELEMENTOS","acristalamientos","tipos","g_gl_n","U_gl","propiedades","F_w","sombreamientos","transmitancia","opacidad","tau_e_B","reflexion","rho_e_B","ACRISTALAMIENTOS","SOMBREAMIENTOS","TIPOSVIDRIO","TIPOSSOMBRA","HuecosParams","_props","g_gl_sh_wi","tipovidrio","setTipovidrio","tiposombra","setTiposombra","setTau_e_B","setRho_e_B","wrapperSetTau_e_B","useCallback","wrapperSetRho_e_B","vidrio","g_gl_wi","G","g_t_e","g_t_i","g_t_m","controlId","OPACIDAD","REFLEXION","SombrasForm","setOpacidad","setColor","findTauRho","GlazingPropertiesCard","Text","FactorsCard","fshwithsummer","setFshwithSummer","fshwithwinter","setFshwithWinter","buildingUseCoef","setBuildingUseCoef","f_sh_with_summer","f_sh_with_winter","g_gl_sh_wi_on","g_gl_sh_wi_off","g_gl_wi_ref_on","g_gl_wi_ref_off","MESES","split","MonthlyRadiationTable","climatezone","showDetail","setShowDetail","Check","borderBottom","Fragment","borderTop","rowSpan","borderRight","FshwithSprite","fillRule","FshwithIcon","fsh","LEVELS","DAYS","ShadingFactorsTable","showlevel","setShowlevel","startMonth","setStartMonth","endMonth","setEndMonth","indexOf","selStart","selEnd","meanSummerVals","vals","days","sum","meanWinterVals","surfidx","textAlign","BoundaryWallResistance","supInt","setSupInt","supExt","setSupExt","uExt","setUExt","setN","volume","setVolume","HelpersPage","HelpPage","esquema5R1C","orientaciones","MainPage","KChart","format","bar_value_padding","d3Container","chart_width","chart_height","d3","selectChildren","svg","attr","append","range","domain","short_title","areSubtype","selectAll","k_pct","nice","tickSize","tickFormat","bar","enter","bandwidth","formatted","bold","KElementsTable","Table","colSpan","au","u_mean","k_contrib","elem_tr","build_k_data","total_a","U_mean","K_contrib","K_pct","elem_au","elem_a","summary","roofs","floors","tbs","opaques_a","opaques_au","windows_a","windows_au","tbs_l","tbs_psil","all_elements","roof","psil","balcony","corner","intermediate_floor","internal_wall","ground_floor","pillar","generic","k_data","patternUnits","patternTransform","UElementsChart","u_max","filtered_data","uColor","ticks","select","tickSizeOuter","tickSizeInner","tooltip","insert","u_min","transition","duration","html","pageX","pageY","_d","UElementsTable","QSolJulChartWindRose","radius","outerRadius","innerRadius","chart","dataOrientations","max_pct","ceil","q_pct","arc","startAngle","orient","endAngle","pie","sort","g","centroid","txt","inLowerHalf","_g","Orientations","QSolJulTable","Q_soljul","a_wp","irradiance_mean","fshobst_mean","gglshwi_mean","Ff_mean","detail_data","irradiance","gains","detail","q_soljul_detail","det","q_contrib","N50ChartPie","pct","outerArc","exit","midAngle","polyline","posA","posB","posC","n50_ref","walls_a","walls_c_ref","walls_c_a","windows_c","windows_c_a","vol","factor_n50_to_ca","factor_ca_to_n50","ca_tot","co_ensayo","n50_info","ca","kdetail","udetail","qsoljuldetail","n50detail","vol_env_net","vol_env_gross","compactness","date","Date","now","print","printer","scrollIntoView","UDetail","N50Detail","toLocaleString","spaces_detail","opaques_detail","windows_detail","spacesData","spaceLoads","tenvTotal","spaceTypeTotal","spaceLoadsTotal","computeSpacesRows","loadsIdMap","computeRows","windowData","shadesData","orientTotal","computeShadesRows","SpacesByConceptTable","total_area","total_volume","marginBottom","row2","idx2","row3","idx3","ByConceptTable","total","ShadesByConceptTable","adder","wc","consTotal","boundTotal","ReportsPage","ClimateSelector","labelStyle","ProjectData","is_new_building","is_dwelling","num_dwellings","baseStyle","flex","flexDirection","alignItems","borderWidth","borderRadius","borderColor","borderStyle","outline","activeStyle","acceptStyle","rejectStyle","StyledDropzone","onDrop","accept","maxFiles","useDropzone","fileRejections","getRootProps","getInputProps","isDragActive","isDragAccept","isDragReject","useMemo","fileRejectionItems","HulcImport","setPurge","_rejectedFiles","_event","EmptyModel","fontSize","marginTop","iconclearmodel","LoadData","containerHeight","ProjectPage","projectActiveKey","setProjectActiveKey","buildingActiveKey","setBuildingActiveKey","consActiveKey","setConsActiveKey","usesActiveKey","setUsesActiveKey","reportActiveKey","setReportActiveKey","helpersActiveKey","setHelpersActiveKey","handleUserKeyPress","removeEventListener","exact","set_panic_hook","set_log_hook","ReactDOM","cachedTextDecoder","TextDecoder","ignoreBOM","fatal","decode","cachegetUint8Memory0","getUint8Memory0","buffer","wasm","getStringFromWasm0","ptr","len","subarray","heap","heap_next","addHeapObject","getObject","WASM_VECTOR_LEN","cachedTextEncoder","TextEncoder","encodeString","encodeInto","arg","view","buf","encode","read","written","passStringToWasm0","malloc","realloc","mem","cachegetInt32Memory0","getInt32Memory0","Int32Array","takeObject","ret","dropObject","retptr","r0","r1","ptr0","len0","stack_pointer","addBorrowedObject","Error","model_js","handleError","f","args","apply","getArrayU8FromWasm0","__wbindgen_json_parse","arg0","arg1","parse","__wbindgen_json_serialize","__wbindgen_string_new","__wbg_new_59cb74e423758ede","__wbg_stack_558ba5917b466edd","stack","__wbg_error_4bb6c2a97407129a","error","__wbindgen_object_drop_ref","__wbg_process_70251ed1291754d5","process","__wbindgen_is_object","__wbg_versions_b23f2588cdb2ddbb","versions","__wbg_node_61b8c9a82499895d","node","__wbindgen_is_string","__wbg_require_2a93bc09fee45aca","arg2","require","arguments","__wbg_crypto_2f56257a38275dbd","__wbg_msCrypto_d07655bf62361f21","msCrypto","__wbg_getRandomValues_fb6b088efb6bead2","__wbg_static_accessor_NODE_MODULE_33b45247c55045b0","module","__wbg_randomFillSync_654a7797990fb8db","randomFillSync","__wbg_newnoargs_be86524d73f67598","Function","__wbg_call_888d259a5fefc347","__wbg_self_c6fbdfc2918d5e58","self","__wbg_window_baec038b5ab35c54","__wbg_globalThis_3f735a5746d41fbd","globalThis","__wbg_global_1bc0b39582740e95","global","__wbindgen_is_undefined","__wbg_buffer_397eaa4d72ee94dd","__wbg_new_a7ce447f15ff496f","__wbg_set_969ad0a60e51d320","__wbg_length_1eb8fc608a0d4cdb","__wbg_newwithlength_929232475839a482","__wbg_subarray_8b658422a224f479","__wbindgen_object_clone_ref","__wbindgen_throw","__wbindgen_rethrow","__wbindgen_memory"],"mappings":"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","file":"static/js/3.24380e8d.chunk.js","sourcesContent":["/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport { createContext } from \"react\";\nimport { makeAutoObservable } from \"mobx\";\n\nconst GuiState = ({ showJsonTab }) => {\n  return makeAutoObservable({\n    showJsonTab,\n    toggleShowJsonTab() {\n      this.showJsonTab = !this.showJsonTab;\n    },\n  });\n};\n\nconst defaultGuiState = { showJsonTab: false };\n\nexport default createContext(GuiState(defaultGuiState));\n","export const APP_VERSION = \"22.10.0\";\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\n\nconst Footer = () => (\n  <Row>\n    <Col>\n      <footer\n        className=\"navbar fixed-bottom\"\n        style={{ backgroundColor: \"rgba(255, 255, 255, 0.7)\" }}\n      >\n        <p className=\"mx-auto small text-muted\">\n          2018-2022 - Rafael Villar Burke, Daniel Jiménez González, Marta\n          Sorribes Gil.\n        </p>\n      </footer>\n    </Col>\n  </Row>\n);\n\nexport default Footer;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n// https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nexport function uuidv4() {\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(\n    /[018]/g,\n    // eslint-disable-next-line\n    (c) =>\n      (\n        c ^\n        (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))\n      ).toString(16)\n  );\n}\n\n// Hashing function based on code from https://jsperf.com/hashing-strings by Jelle De Loecker\nexport function hash(str) {\n  let hashvalue = 0;\n  if (str.length === 0) return hashvalue;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hashvalue = (hashvalue << 5) - hashvalue + char;\n    hashvalue = hashvalue & hashvalue; // Convert to 32bit integer\n  }\n  return hashvalue;\n}\n\nexport function UserException(message, kind = \"UserException\") {\n  this.message = message;\n  this.kind = kind;\n}\n\n// Cadena con valor redondeado si el valor es un número y está definido o, si no, guión\nexport const round_or_dash = (val, numDecimals = 2) =>\n  val === null || val === undefined || isNaN(val)\n    ? \"-\"\n    : val.toFixed(numDecimals);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport {\n  new_glass,\n  new_frame,\n  new_material,\n  new_shade,\n  new_space,\n  new_thermalbridge,\n  new_wall,\n  new_wallcons,\n  new_wincons,\n  new_window,\n  new_meta,\n  new_load,\n  new_thermostat,\n  new_schedule_day,\n  new_schedule_week,\n  new_schedule_year,\n} from \"wasm-envolventecte\";\n\nexport const newSpace = () => ({\n  ...defaultsSpace,\n  ...new_space(),\n});\n\nexport const defaultsSpace = {\n  kind: \"CONDITIONED\",\n  name: \"Espacio\",\n  multiplier: 1.0,\n  inside_tenv: true,\n  z: 0.0,\n  loads: null,\n  thermostats: null,\n  n_v: null,\n  illuminance: null,\n};\n\nexport const newWall = () => {\n  let w = { ...defaultsWall, ...new_wall() };\n  let geom = { ...defaultsWallgeom, ...w.geometry };\n  w.geometry = geom;\n\n  return w;\n};\n\nexport const defaultsWall = {\n  name: \"Opaco\",\n  next_to: null,\n};\n\nexport const defaultsWallgeom = {\n  position: null,\n  polygon: [],\n};\n\nexport const newWindow = () => {\n  let w = { ...defaultsWindow, ...new_window() };\n  let geom = { ...defaultsWingeom, ...w.geometry };\n  w.geometry = geom;\n\n  return w;\n};\n\nexport const defaultsWindow = {\n  name: \"Hueco\",\n};\n\nexport const defaultsWingeom = {\n  position: null,\n};\n\nexport const newShade = () => {\n  let w = { ...defaultsShade, ...new_shade() };\n  let geom = { ...defaultsWallgeom, ...w.geometry };\n  w.geometry = geom;\n\n  return w;\n};\n\nexport const defaultsShade = {\n  name: \"Sombra\",\n};\n\nexport const newTb = () => ({\n  ...defaultsTb,\n  ...new_thermalbridge(),\n});\n\nexport const defaultsTb = {\n  name: \"Puente térmico\",\n  kind: \"GENERIC\",\n  l: 1.0,\n  psi: 0.0,\n};\n\nexport const newWallcons = () => ({\n  ...defaultsWallcons,\n  ...new_wallcons(),\n});\n\nexport const defaultsWallcons = {\n  name: \"Construcción de opaco\",\n  layers: [],\n};\n\nexport const newWincons = () => ({\n  ...defaultsWincons,\n  ...new_wincons(),\n});\n\nexport const defaultsWincons = {\n  name: \"Construcción de hueco\",\n  g_glshwi: null,\n};\n\nexport const newMaterial = () => ({ ...defaultsMaterial, ...new_material() });\n\nexport const defaultsMaterial = {\n  name: \"Material\",\n};\n\nexport const newGlass = () => new_glass();\n\nexport const defaultsGlass = {\n  name: \"Vidrio\",\n};\n\nexport const newFrame = () => new_frame();\n\nexport const defaultsFrame = {\n  name: \"Marco\",\n};\n\nexport const newMeta = () => ({\n  ...defaultsMeta,\n  ...new_meta(),\n});\n\nexport const defaultsMeta = {\n  name: \"Nombre del proyecto\",\n  global_ventilation_l_s: null,\n  n50_test_ach: null,\n  d_perim_insulation: 0.0,\n  rn_perim_insulation: 0.0,\n};\n\nexport const newLoad = () => ({\n  ...defaultsLoad,\n  ...new_load(),\n});\n\nexport const defaultsLoad = {\n  name: \"Carga de espacio\",\n  people_schedule: null,\n  lighting_schedule: null,\n  equipment_schedule: null,\n};\n\nexport const newThermostat = () => ({\n  ...defaultsSysSetting,\n  ...new_thermostat(),\n});\n\nexport const defaultsSysSetting = {\n  name: \"Consignas de espacio\",\n  temp_max: null,\n  temp_min: null,\n};\n\nexport const newScheduleDay = () => ({\n  ...defaultsScheduleDay,\n  ...new_schedule_day(),\n});\n\nexport const defaultsScheduleDay = {\n  name: \"Horario diario todo 0\",\n  values: [\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  ],\n};\n\nexport const newScheduleWeek = () => ({\n  ...defaultsScheduleWeek,\n  ...new_schedule_week(),\n});\n\nexport const defaultsScheduleWeek = {\n  name: \"Horario semanal vacío\",\n  values: [],\n};\n\nexport const newScheduleYear = () => ({\n  ...defaultsScheduleYear,\n  ...new_schedule_year(),\n});\n\nexport const defaultsScheduleYear = {\n  name: \"Horario anual vacío\",\n  values: [],\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nexport const SPACE = \"spaces\";\nexport const WALL = \"walls\";\nexport const WINDOW = \"windows\";\nexport const THERMAL_BRIDGE = \"thermal_bridges\";\nexport const SHADE = \"shades\";\nexport const WALLCONS = \"wallcons\";\nexport const WINCONS = \"wincons\";\nexport const MATERIAL = \"materials\";\nexport const GLASS = \"glasses\";\nexport const FRAME = \"frames\";\nexport const SCHEDULE_YEAR = \"year\";\nexport const SCHEDULE_WEEK = \"week\";\nexport const SCHEDULE_DAY = \"day\";\nexport const LOAD = \"loads\";\nexport const THERMOSTAT = \"thermostats\";\n\n// Lista y mapeado de de condiciones de contorno\nexport const BOUNDARY_TYPES = [\"EXTERIOR\", \"INTERIOR\", \"ADIABATIC\", \"GROUND\"];\nexport const BOUNDARY_TYPES_MAP = {\n  EXTERIOR: \"EXTERIOR\",\n  INTERIOR: \"INTERIOR\",\n  ADIABATIC: \"ADIABÁTICO\",\n  GROUND: \"TERRENO\",\n};\n\n// Tipos de espacios según nivel de acondicionamiento\nexport const SPACE_TYPES = [\"CONDITIONED\", \"UNCONDITIONED\", \"UNINHABITED\"];\nexport const SPACE_TYPES_MAP = {\n  CONDITIONED: \"ACONDICIONADO\",\n  UNCONDITIONED: \"NO ACONDICIONADO\",\n  UNINHABITED: \"NO HABITABLE\",\n};\n\n// Tipos de puentes térmicos\nexport const THERMAL_BRIDGE_TYPES = [\n  \"ROOF\",\n  \"BALCONY\",\n  \"CORNER\",\n  \"INTERMEDIATEFLOOR\",\n  \"INTERNALWALL\",\n  \"GROUNDFLOOR\",\n  \"PILLAR\",\n  \"WINDOW\",\n  \"GENERIC\",\n];\nexport const THERMAL_BRIDGE_TYPES_MAP = {\n  ROOF: \"CUBIERTA\",\n  BALCONY: \"BALCÓN\",\n  CORNER: \"ESQUINA\",\n  INTERMEDIATEFLOOR: \"FORJADO\",\n  INTERNALWALL: \"PARTICIÓN\",\n  GROUNDFLOOR: \"SOLERA\",\n  PILLAR: \"PILAR\",\n  WINDOW: \"HUECO\",\n  GENERIC: \"GENÉRICO\",\n};\n\nexport const ORIENTATION_TYPES = [\"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\", \"HZ\"];","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport { createContext } from \"react\";\nimport { action, observable, computed, makeObservable, configure } from \"mobx\";\n\nimport {\n  energy_indicators,\n  get_monthly_radiation_data,\n  load_data_from_json,\n  load_data_from_ctehexml,\n  load_fshobst_data_from_kyg,\n  purge_unused,\n} from \"wasm-envolventecte\";\n\nimport {\n  newShade,\n  newSpace,\n  newTb,\n  newWall,\n  newWallcons,\n  newWindow,\n  newWincons,\n  newMaterial,\n  newFrame,\n  newGlass,\n  defaultsSpace,\n  defaultsWall,\n  defaultsWindow,\n  defaultsShade,\n  defaultsWallcons,\n  defaultsWincons,\n  defaultsMaterial,\n  defaultsGlass,\n  defaultsFrame,\n  newMeta,\n  defaultsTb,\n  newThermostat,\n  newLoad,\n  defaultsLoad,\n  defaultsSysSetting,\n  newScheduleDay,\n  newScheduleYear,\n  newScheduleWeek,\n} from \"./defaults\";\n\n// import radiationdata from \"../zcraddata.json\";\nimport example from \"./example.json\";\nimport { uuidv4 } from \"../utils\";\nimport * as types from \"./types\";\n\n// DEBUG:\n/* lint import/no-webpack-loader-syntax: off */\n// import test_ctehexml from '!raw-loader!../test/casopracticof21_ventanas_cubierta_raras_rot45.ctehexml';\n// import test_ctehexml from '!raw-loader!../test/casopracticof21_ventanas_cubierta_raras.ctehexml';\n// import test_ctehexml from '!raw-loader!../test/prueba_cub_rotada.ctehexml';\n// import test_ctehexml from '!raw-loader!../test/ventanas_cubierta.ctehexml';\n// import test_ctehexml from '!raw-loader!../test/ventanas_cubierta_reducido.ctehexml';\n\n// no obligamos a usar acciones para cambiar el estado. El default es \"always\".\n// Ver https://mobx.js.org/configuration.html#enforceactions\nconfigure({\n  enforceActions: \"never\",\n});\n\n// Valores de radiación\nconst MONTHLYRADIATIONDATA = get_monthly_radiation_data();\nexport const EMPTY_ID = \"00000000-0000-0000-0000-000000000000\";\n\nclass AppState {\n  // Datos climáticos --------\n\n  // Zona climática y otros metadatos\n  meta = newMeta();\n\n  // Datos geométricos y constructivos -----------\n  // Espacios de la envolvente térmica\n  spaces = [];\n  // Opacos\n  walls = [];\n  // Huecos\n  windows = [];\n  // Sombras\n  shades = [];\n  // Puentes térmicos\n  thermal_bridges = [];\n  // Construcciones de opacos y huecos\n  cons = { wallcons: [], wincons: [], materials: [], glasses: [], frames: [] };\n\n  // Datos de uso\n  // Horarios\n  schedules = { year: [], week: [], day: [] };\n  // Cargas\n  loads = [];\n  // Consignas\n  thermostats = [];\n\n  // Lista de errores y avisos -------\n  // Contiene objetos  { level: warninglevel, id: \"element_id\", msg: \"my msg\" }\n  // donde warninglevel puede ser: SUCCESS | DANGER | WARNING | INFO (y corresponden a clases Bootstrap en minúsculas)\n  errors = [];\n\n  constructor() {\n    makeObservable(this, {\n      // Decorators\n      // title: observable can be omitted, its is the default when using observable.object\n      meta: observable,\n      spaces: observable,\n      walls: observable,\n      windows: observable,\n      shades: observable,\n      thermal_bridges: observable,\n      cons: observable,\n      schedules: observable,\n      loads: observable,\n      thermostats: observable,\n      errors: observable,\n\n      // Valores calculados (resultan de modificaciones del estado)\n      energy_indicators: computed({ requiresReaction: true }),\n      zoneslist: computed,\n      orientations: computed,\n      warnings: computed,\n      // TODO: estos dos se podrían llegar a eliminar si cambiamos climas y usamos los del wasm\n      climatedata: computed({ requiresReaction: true }),\n      climateTotRadJul: computed({ requiresReaction: true }),\n\n      // Acciones (modifican el estado)\n      addElement: action,\n      duplicateElements: action,\n      deleteElements: action,\n      handleUpload: action,\n      loadModel: action,\n      clearModel: action,\n      purgeModel: action,\n      asJSON: computed,\n      loadData: action,\n    });\n  }\n\n  // Propiedades de datos climáticos ----------------\n  get zoneslist() {\n    return [...new Set(MONTHLYRADIATIONDATA.map((v) => v.zone))];\n  }\n\n  get orientations() {\n    return [...new Set(MONTHLYRADIATIONDATA.map((v) => v.orientation))];\n  }\n\n  get climatedata() {\n    return MONTHLYRADIATIONDATA.filter((v) => v.zone === this.meta.climate);\n  }\n\n  get climateTotRadJul() {\n    return this.climatedata.reduce(\n      (acc, v) => ({ ...acc, [v.orientation]: v.dir[6] + v.dif[6] }),\n      {}\n    );\n  }\n\n  get energy_indicators() {\n    return energy_indicators(this.getModel());\n  }\n\n  // Acumula errores de la app y avisos de los cálculos\n  get warnings() {\n    return this.errors.concat(this.energy_indicators.warnings);\n  }\n\n  getElements(elementType) {\n    switch (elementType) {\n      case types.SPACE:\n        return this.spaces;\n      case types.WALL:\n        return this.walls;\n      case types.WINDOW:\n        return this.windows;\n      case types.THERMAL_BRIDGE:\n        return this.thermal_bridges;\n      case types.SHADE:\n        return this.shades;\n      case types.WALLCONS:\n        return this.cons.wallcons;\n      case types.WINCONS:\n        return this.cons.wincons;\n      case types.MATERIAL:\n        return this.cons.materials;\n      case types.GLASS:\n        return this.cons.glasses;\n      case types.FRAME:\n        return this.cons.frames;\n      case types.SCHEDULE_YEAR:\n        return this.schedules.year;\n      case types.SCHEDULE_WEEK:\n        return this.schedules.week;\n      case types.SCHEDULE_DAY:\n        return this.schedules.day;\n      case types.LOAD:\n        return this.loads;\n      case types.THERMOSTAT:\n        return this.thermostats;\n      default:\n        return [];\n    }\n  }\n\n  getIdNameMap(elementType) {\n    const idNameMap = {};\n    this.getElements(elementType).map((s) =>\n      s.id != EMPTY_ID\n        ? (idNameMap[s.id] = s.name)\n        : (idNameMap[EMPTY_ID] = \"-\")\n    );\n    return idNameMap;\n  }\n\n  getElementOptions(elementType, addEmpty = false) {\n    const opts = this.getElements(elementType).map(({ id, name }) => ({\n      value: id,\n      label: name,\n    }));\n    if (addEmpty) {\n      opts.unshift({ value: \"\", label: \"<Vacío>\" });\n    }\n    return opts;\n  }\n\n  // Acciones --------\n\n  // Añade un nuevo elemento del tipo indicado y devuelve su UUID\n  addElement(elementType) {\n    let el;\n    switch (elementType) {\n      case types.SPACE:\n        el = newSpace();\n        this.spaces.push(el);\n        break;\n      case types.WALL:\n        el = newWall();\n        this.walls.push(el);\n        break;\n      case types.WINDOW:\n        el = newWindow();\n        this.windows.push(el);\n        break;\n      case types.THERMAL_BRIDGE:\n        el = newTb();\n        this.thermal_bridges.push(el);\n        break;\n      case types.SHADE:\n        el = newShade();\n        this.shades.push(el);\n        break;\n      case types.WALLCONS:\n        el = newWallcons();\n        this.cons.wallcons.push(el);\n        break;\n      case types.WINCONS:\n        el = newWincons();\n        this.cons.wincons.push(el);\n        break;\n      case types.MATERIAL:\n        el = newMaterial();\n        this.cons.materials.push(el);\n        break;\n      case types.GLASS:\n        el = newGlass();\n        this.cons.glasses.push(el);\n        break;\n      case types.FRAME:\n        el = newFrame();\n        this.cons.frames.push(el);\n        break;\n      case types.LOAD:\n        el = newLoad();\n        this.loads.push(el);\n        break;\n      case types.THERMOSTAT:\n        el = newThermostat();\n        this.thermostats.push(el);\n        break;\n      case types.SCHEDULE_DAY:\n        el = newScheduleDay();\n        this.schedules.day.push(el);\n        break;\n      case types.SCHEDULE_WEEK:\n        el = newScheduleWeek();\n        this.schedules.week.push(el);\n        break;\n      case types.SCHEDULE_YEAR:\n        el = newScheduleYear();\n        this.schedules.year.push(el);\n        break;\n      default:\n        break;\n    }\n    return el.id || EMPTY_ID;\n  }\n\n  // Duplica elementos seleccionados y devuelve UUIDs de los elementos generados\n  duplicateElements(elementType, selection) {\n    const container = this.getElements(elementType);\n\n    const newIds = [];\n    selection.forEach((id) => {\n      const selectedIndex = container.findIndex((h) => h.id === id);\n      if (selectedIndex !== -1) {\n        const idx = selectedIndex >= 0 ? selectedIndex : 0;\n        const selectedObj = container[idx];\n        const newId = uuidv4();\n        const dupObj = {\n          ...selectedObj,\n          name: selectedObj.name + \" (dup.)\",\n          id: newId,\n        };\n        newIds.push(newId);\n        container.splice(idx + 1, 0, dupObj);\n      }\n    });\n    return newIds;\n  }\n\n  // Elimina los elementos seleccionados del tipo indicado y devuelve el UUID del nuevo elemento seleccionado (o null)\n  deleteElements(elementType, selection) {\n    const container = this.getElements(elementType);\n\n    if (selection.length > 0) {\n      const indices = container.reduce((acc, cur, idx) => {\n        if (selection.includes(cur.id)) {\n          acc.push(idx);\n        }\n        return acc;\n      }, []);\n      const minidx = Math.max(0, Math.min(...indices) - 1);\n      const filtered = container.filter((h) => !selection.includes(h.id));\n      // usa replace: https://mobx.js.org/api.html#observablearray\n      container.replace(filtered);\n      // Selecciona el elemento anterior al primero seleccionado salvo que no queden elementos o sea el primero, o nada si no hay elementos\n      if (filtered.length > 0) {\n        return container[minidx].id;\n      } else {\n        return null;\n      }\n    }\n  }\n\n  // Mueve una posición hacia arriba el primer elemento seleccionado\n  moveUpFirstSelectedElement(elementType, selection) {\n    const container = this.getElements(elementType);\n\n    if (selection.length === 0) return;\n    selection = selection[0];\n\n    const idx = container.findIndex((h) => selection.includes(h.id));\n    if (idx < 1) return;\n    const prev = container[idx - 1];\n    const elem = container[idx];\n\n    container.replace([\n      ...container.slice(0, idx - 1),\n      elem,\n      prev,\n      ...container.splice(idx + 1),\n    ]);\n  }\n\n  // Mueve una posición hacia arriba el primer elemento seleccionado\n  moveDownFirstSelectedElement(elementType, selection) {\n    const container = this.getElements(elementType);\n\n    if (selection.length === 0) return;\n    selection = selection[0];\n\n    const idx = container.findIndex((h) => selection.includes(h.id));\n    if (idx > container.length - 2 || idx < 0) return;\n    const elem = container[idx];\n    const next = container[idx + 1];\n    \n    container.replace([\n      ...container.slice(0, idx),\n      next,\n      elem,\n      ...container.splice(idx + 2),\n    ]);\n  }\n\n  // Recopila modelo desde el appstate\n  getModel() {\n    const {\n      meta,\n      spaces,\n      walls,\n      windows,\n      shades,\n      thermal_bridges,\n      cons,\n      schedules,\n      loads,\n      thermostats,\n    } = this;\n    return {\n      meta,\n      spaces,\n      walls,\n      windows,\n      shades,\n      thermal_bridges,\n      cons,\n      schedules,\n      loads,\n      thermostats,\n    };\n  }\n\n  // Deja modelo limpio\n  clearModel() {\n    this.meta = newMeta();\n    this.spaces = [];\n    this.walls = [];\n    this.windows = [];\n    this.shades = [];\n    this.thermal_bridges = [];\n    this.cons = {\n      wallcons: [],\n      wincons: [],\n      materials: [],\n      glasses: [],\n      frames: [],\n    };\n    this.schedules = { year: [], week: [], day: [] };\n    this.loads = [];\n    this.thermostats = [];\n  }\n\n  // Purga datos no usados del modelo\n  purgeModel() {\n    const { model: cleanModel, warnings } = purge_unused(this.getModel());\n    this.loadModel(cleanModel);\n    this.errors = warnings;\n  }\n\n  // Carga modelo JSON en el appstate\n  loadModel(inputData) {\n    const {\n      meta = { climate: \"D3\" },\n      spaces = [],\n      walls = [],\n      windows = [],\n      shades = [],\n      thermal_bridges = [],\n      cons = {\n        wallcons: [],\n        wincons: [],\n        materials: [],\n        glasses: [],\n        frames: [],\n      },\n      schedules = {\n        year: [],\n        week: [],\n        day: [],\n      },\n      loads = [],\n      thermostats = [],\n    } = inputData;\n\n    // Carga datos en el store\n    // Asignamos valores por defecto de las propiedades que pueden ser omitidas\n    this.meta = meta;\n    this.thermal_bridges = thermal_bridges.map((tb) => ({\n      ...defaultsTb,\n      ...tb,\n    }));\n    this.walls = walls.map((w) => ({\n      ...defaultsWall,\n      ...w,\n    }));\n    this.windows = windows.map((w) => ({\n      ...defaultsWindow,\n      ...w,\n    }));\n    this.spaces = spaces.map((s) => ({\n      ...defaultsSpace,\n      ...s,\n    }));\n    this.shades = shades.map((w) => ({\n      ...defaultsShade,\n      ...w,\n    }));\n    this.cons = {\n      wallcons: cons.wallcons.map((w) => ({\n        ...defaultsWallcons,\n        ...w,\n      })),\n      wincons: cons.wincons.map((w) => ({\n        ...defaultsWincons,\n        ...w,\n      })),\n      materials: cons.materials.map((w) => ({\n        ...defaultsMaterial,\n        ...w,\n      })),\n      glasses: cons.glasses.map((w) => ({\n        ...defaultsGlass,\n        ...w,\n      })),\n      frames: cons.frames.map((w) => ({\n        ...defaultsFrame,\n        ...w,\n      })),\n    };\n    this.schedules = {\n      year: schedules.year,\n      week: schedules.week,\n      day: schedules.day,\n    };\n    this.loads = loads.map((e) => ({ ...defaultsLoad, ...e }));\n    this.thermostats = thermostats.map((e) => ({\n      ...defaultsSysSetting,\n      ...e,\n    }));\n  }\n\n  // Importación y exportación de datos -------------\n\n  // Serialización de los datos\n  get asJSON() {\n    const {\n      meta,\n      spaces,\n      walls,\n      windows,\n      shades,\n      thermal_bridges,\n      cons,\n      schedules,\n      loads,\n      thermostats,\n    } = this;\n\n    return JSON.stringify(\n      {\n        meta,\n        spaces,\n        walls,\n        windows,\n        shades,\n        thermal_bridges,\n        cons,\n        schedules,\n        loads,\n        thermostats,\n      },\n      null,\n      2\n    );\n  }\n\n  // Carga datos desde lista de archivos subida, identificando el tipo\n  handleUpload(acceptedFiles, purge = false) {\n    if (acceptedFiles.length > 0) {\n      const file = acceptedFiles[0];\n      const reader = new FileReader();\n      reader.onload = (rawData) => {\n        if (\n          file.name.includes(\"KyGananciasSolares.txt\") ||\n          file.path.includes(\"KyGananciasSolares.txt\")\n        ) {\n          this.loadData(rawData.target.result, \"FSHOBST\");\n        } else if (\n          file.name.toLowerCase().includes(\".ctehexml\") ||\n          file.path.toLowerCase().includes(\".ctehexml\")\n        ) {\n          this.loadData(rawData.target.result, \"CTEHEXML\", purge);\n        } else {\n          this.loadData(rawData.target.result, \"JSON\", purge);\n        }\n      };\n      reader.readAsText(file);\n    }\n  }\n\n  // Deserialización de datos desde\n  // - JSON (mode = \"JSON\")\n  // - CTEHEXML (mode=\"CTEHEXML\")\n  // - KyGananciasSolares.txt (mode=\"FSHOBST\")\n  loadData(data, mode, purge = false) {\n    // Lee datos\n    try {\n      let inputData;\n      let loadWarnings = [];\n      if (mode === \"FSHOBST\") {\n        inputData = load_fshobst_data_from_kyg(data);\n      } else if (mode === \"CTEHEXML\") {\n        const { model, warnings } = load_data_from_ctehexml(data, purge);\n        loadWarnings = warnings;\n        inputData = model;\n      } else {\n        const { model, warnings } = load_data_from_json(data, purge);\n        loadWarnings = warnings;\n        inputData = model;\n      }\n\n      if (mode === \"CTEHEXML\" || mode === \"JSON\") {\n        this.loadModel(inputData);\n        this.errors = [\n          { level: \"SUCCESS\", id: null, msg: \"Datos cargados correctamente.\" },\n          ...loadWarnings,\n          {\n            level: \"INFO\",\n            id: null,\n            msg: [\n              `Clima ${this.meta.climate}, Cargados: `,\n              `${this.spaces.length} espacios, `,\n              `${this.walls.length} opacos, `,\n              `${this.windows.length} huecos, `,\n              `${this.thermal_bridges.length} PTs, `,\n              `${this.shades.length} elementos de sombra, `,\n              `${this.cons.wallcons.length} construcciones de opacos, `,\n              `${this.cons.wincons.length} construcciones de huecos, `,\n              `${this.loads.length} definiciones de cargas y `,\n              `${this.thermostats.length} definiciones de consignas`,\n            ].join(\"\"),\n          },\n        ];\n      } else if (mode === \"FSHOBST\") {\n        this.errors = [\n          { level: \"SUCCESS\", id: null, msg: \"Datos cargados correctamente.\" },\n          {\n            level: \"INFO\",\n            id: null,\n            msg: `Cargados ${inputData.length} factores de sombra de obstáculos remotos (F_sh;obst) de huecos`,\n          },\n        ];\n\n        for (let window of this.windows) {\n          let fshobst = inputData[window.name];\n          if (fshobst === undefined || isNaN(fshobst)) {\n            this.errors.push({\n              level: \"INFO:\",\n              id: null,\n              msg: `Hueco ${window.name} sin datos de factor reductor por sombreamiento de obstáculos remotos F_sh;obst`,\n            });\n          } else {\n            window.fshobst = fshobst;\n          }\n        }\n      } else {\n        this.errors = [\n          {\n            level: \"INFO\",\n            id: null,\n            msg: `No se han encontrado datos de modelo en el archivo.`,\n          },\n        ];\n      }\n    } catch (err) {\n      this.errors = [\n        {\n          level: \"DANGER\",\n          id: null,\n          msg: `El archivo no contiene datos con un formato adecuado. ${err}`,\n        },\n      ];\n    }\n  }\n}\n\nconst appstate = new AppState();\n\n// // DEBUG: carga este caso para depurar\n// appstate.loadData(test_ctehexml, \"CTEHEXML\");\nappstate.loadModel(example);\n\nexport default createContext(appstate);\n","export default __webpack_public_path__ + \"static/media/logo.152c1c37.svg\";","export default __webpack_public_path__ + \"static/media/outline-live_help-24px.1dbc8e9a.svg\";","export default __webpack_public_path__ + \"static/media/outline-info-24px.7f5d49ce.svg\";","export default __webpack_public_path__ + \"static/media/baseline-archive-24px.e47369bc.svg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { LinkContainer } from \"react-router-bootstrap\";\nimport { Form, Nav, Navbar, Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport { hash } from \"../../utils.js\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport imglogo from \"../img/logo.svg\";\nimport iconhelp from \"../img/outline-live_help-24px.svg\";\nimport iconinfo from \"../img/outline-info-24px.svg\";\nimport icondownload from \"../img/baseline-archive-24px.svg\";\nimport GuiState from \"../../stores/GuiState.js\";\n\nconst NavBar = observer(({ projectName = \"Envolvente CTE\" }) => {\n  const appstate = useContext(AppState);\n  const guiState = useContext(GuiState);\n\n  const handleDownload = (_e) => {\n    const contents = appstate.asJSON;\n    const contenthash = hash(contents).toString(16);\n    const filename = `EnvolventeCTE-${contenthash}.json`;\n    const blob = new Blob([contents], { type: \"application/json\" });\n    const uri = URL.createObjectURL(blob);\n    // from http://stackoverflow.com/questions/283956/\n    const link = document.createElement(\"a\");\n    if (typeof link.download === \"string\") {\n      link.href = uri;\n      link.download = filename;\n      // Firefox requires the link to be in the body\n      document.body.appendChild(link);\n      // Simulate click\n      link.click();\n      // Remove the link when done\n      document.body.removeChild(link);\n    } else {\n      window.open(uri);\n    }\n  };\n\n  return (\n    <Navbar bg=\"dark\" variant=\"dark\">\n      <Navbar.Brand>\n        <Link\n          className=\"navbar-brand ps-3\"\n          to=\"/\"\n          title=\"EnvolventeCTE. Aplicación para el cálculo de indicadores de calidad y parámetros descriptivos de la envolvente térmica de los edificios para su evaluación energética y para la aplicación del CTE DB-HE (2019)\"\n        >\n          <img src={imglogo} height=\"40px\" className=\"mr-2\" alt=\"logo\" />{\" \"}\n          {projectName}\n        </Link>\n      </Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav>\n          <LinkContainer to=\"/project\" eventKey={0}>\n            <Nav.Link title=\"Datos generales del proyecto\">Proyecto</Nav.Link>\n          </LinkContainer>\n          <LinkContainer to=\"/elements\" eventKey={1}>\n            <Nav.Link title=\"Espacios y superficies del edificio y su envolvente térmica\">\n              Elementos\n            </Nav.Link>\n          </LinkContainer>\n          <LinkContainer to=\"/constructions\" eventKey={2}>\n            <Nav.Link title=\"Construcciones y materiales del edificio\">\n              Construcción\n            </Nav.Link>\n          </LinkContainer>\n          <LinkContainer to=\"/uses\" eventKey={3}>\n            <Nav.Link title=\"Horarios, cargas y consignas de los espacios\">\n              Uso\n            </Nav.Link>\n          </LinkContainer>\n          <LinkContainer to=\"/3d\" eventKey={4}>\n            <Nav.Link title=\"Visualización tridimensional del modelo del edificio\">\n              Vista3D\n            </Nav.Link>\n          </LinkContainer>\n          <span style={{ borderLeft: \"1px solid gray\", margin: \"0px 25px\" }} />\n          <LinkContainer to=\"/reports\" eventKey={5}>\n            <Nav.Link title=\"Informes\">Informes</Nav.Link>\n          </LinkContainer>\n          <span style={{ borderLeft: \"1px solid gray\", margin: \"0px 25px\" }} />\n          <LinkContainer to=\"/helpers\" eventKey={6}>\n            <Nav.Link title=\"Ayudas para el cálculo de parámetros climáticos y elementos constructivos\">\n              Ayudas\n            </Nav.Link>\n          </LinkContainer>\n          {guiState.showJsonTab ? (\n            <>\n              <span\n                style={{ borderLeft: \"1px solid gray\", margin: \"0px 25px\" }}\n              />\n              <LinkContainer to=\"/detail\" eventKey={7}>\n                <Nav.Link title=\"Detalle\">Detalle</Nav.Link>\n              </LinkContainer>\n            </>\n          ) : null}\n        </Nav>\n        <Nav className=\"ms-auto pe-3\">\n          <Nav.Link\n            md={6}\n            title=\"Zona climática, de acuerdo al DB-HE 2019, en la que se sitúa el edificio.\"\n          >\n            <Form>\n              <Form.Group as={Row}>\n                <Form.Label column htmlFor=\"climateselector\">\n                  Zona Climática\n                </Form.Label>\n                <Col sm={5}>\n                  <Form.Select\n                    id=\"climateselector\"\n                    size=\"sm\"\n                    value={appstate?.meta?.climate || \"\"}\n                    onChange={(e) => {\n                      appstate.meta.climate = e.target.value;\n                    }}\n                    placeholder=\"Zona climática\"\n                  >\n                    {appstate.zoneslist.map((z) => (\n                      <option value={z} key={\"zone_\" + z}>\n                        {z}\n                      </option>\n                    ))}\n                  </Form.Select>\n                </Col>\n              </Form.Group>\n            </Form>\n          </Nav.Link>\n          <span style={{ borderLeft: \"1px solid gray\", margin: \"0px 25px\" }} />\n          <Nav.Link\n            title=\"Descarga del archivo de datos del modelo actual.\"\n            onClick={(e) => handleDownload(e)}\n          >\n            <img src={icondownload} alt=\"Descargar datos de envolvente\" />{\" \"}\n            Descarga\n          </Nav.Link>\n          <LinkContainer to=\"/help\" eventKey={8}>\n            <Nav.Link title=\"Ayuda general\">\n              <img src={iconhelp} alt=\"Ayuda\" />\n            </Nav.Link>\n          </LinkContainer>\n          <LinkContainer to=\"/about\" eventKey={9}>\n            <Nav.Link>\n              <Nav.Item title=\"Descripción, autoría y licencia\">\n                <img src={iconinfo} alt=\"Créditos\" />\n              </Nav.Item>\n            </Nav.Link>\n          </LinkContainer>\n        </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n  );\n});\n\nexport default NavBar;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Container, Row } from \"react-bootstrap\";\n\nimport Footer from \"../ui/Footer\";\nimport NavBar from \"../ui/Nav\";\n\nexport const Page = ({ route, children }) => {\n  return (\n    <Container fluid>\n      <Row className=\"pb-2 mb-2 d-print-none\">\n        <NavBar route={route} />\n      </Row>\n      {children}\n      <Footer />\n    </Container>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/FotoDani.a707bf6c.jpg\";","export default __webpack_public_path__ + \"static/media/FotoMarta.48d0cd56.jpg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Alert, Col, Image, Row } from \"react-bootstrap\";\n\nimport { APP_VERSION } from \"../../version.js\";\n\nimport { Page } from \"../ui/Page\";\n\nimport FotoPachi from \"../img/FotoPachi.jpg\";\nimport FotoDani from \"../img/FotoDani.jpg\";\nimport FotoMarta from \"../img/FotoMarta.jpg\";\nimport { get_version } from \"wasm-envolventecte\";\n\nconst AboutPage = () => (\n  <Page>\n    <Row>\n      <Col>\n        <h1>EnvolventeCTE</h1>\n        <p className=\"font-weight-bold\">\n          Versión {APP_VERSION}, BEModel {get_version()}\n        </p>\n        <p>\n          Aplicación para el cálculo de indicadores de calidad y parámetros\n          descriptivos de la envolvente térmica de los edificios para la\n          evaluación energética y aplicación del CTE DB-HE (2019):\n        </p>\n      </Col>\n    </Row>\n    <Row>\n      <Col>\n        <Alert variant=\"warning\">\n          <b>NOTA:</b> Esta aplicación y la información contenida en ella no\n          tienen valor reglamentario.\n        </Alert>\n      </Col>\n    </Row>\n    <Row>\n      <Col>\n        <h2>Equipo de desarrollo:</h2>\n        <p>\n          Grupo de <i>Ahorro de Energía y Sostenibilidad</i> de la{\" \"}\n          <i>Unidad de Calidad en la Construcción</i> del{\" \"}\n          <a href=\"https://ietcc.csic.es\">\n            Instituto Eduardo Torroja de Ciencias de la Construcción\n            (IETcc-CSIC)\n          </a>{\" \"}\n          del <i>Consejo Superior de Investigaciones Científicas (CSIC)</i>.\n        </p>\n      </Col>\n    </Row>\n    <Row>\n      <Col md={{ span: 2, offset: 3 }}>\n        <Image fluid alt=\"Rafael Villar Burke\" src={FotoPachi} />\n        <p>\n          Rafael Villar Burke (pachi), <i>pachi@ietcc.csic.es</i>\n        </p>\n      </Col>\n      <Col md={2}>\n        <Image fluid alt=\"Daniel Jiménez González\" src={FotoDani} />\n        <p>\n          Daniel Jiménez González, <i>danielj@ietcc.csic.es</i>\n        </p>\n      </Col>\n      <Col md={2}>\n        <Image fluid alt=\"Marta Sorribes Gil\" src={FotoMarta} />\n        <p>\n          Marta Sorribes Gil, <i>msorribes@ietcc.csic.es</i>\n        </p>\n      </Col>\n    </Row>\n    <Row>\n      <Col>\n        <h2>Licencia:</h2>\n        <p>\n          Esta aplicación es software libre y se distribuye con licencia MIT,\n          que permite su uso, modificación y redistribución mientras se mantenga\n          el copyright.\n        </p>\n        <p>\n          El código está disponible en{\" \"}\n          <a href=\"https://github.com/pachi/envolventecte\">\n            https://github.com/pachi/envolventecte\n          </a>\n        </p>\n      </Col>\n    </Row>\n    <Row>\n      <Col>\n        <Alert variant=\"secondary\">\n          <p className=\"lead\">The MIT License (MIT)</p>\n          <p>\n            Copyright (c) 2018-2021 Rafael Villar Burke\n            &lt;pachi&#64;ietcc.csic.es&gt;, Daniel Jiménez González\n            &lt;danielj&#64;ietcc.csic.es&gt;, Marta Sorribes Gil\n            &lt;msorribes&#64;ietcc.csic.es&gt;\n          </p>\n\n          <p>\n            Permission is hereby granted, free of charge, to any person\n            obtaining a copy of this software and associated documentation files\n            (the &quot;Software&quot;), to deal in the Software without\n            restriction, including without limitation the rights to use, copy,\n            modify, merge, publish, distribute, sublicense, and/or sell copies\n            of the Software, and to permit persons to whom the Software is\n            furnished to do so, subject to the following conditions:\n          </p>\n\n          <p>\n            The above copyright notice and this permission notice shall be\n            included in all copies or substantial portions of the Software.\n          </p>\n\n          <p>\n            THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY\n            KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\n            WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n            NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS\n            BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n            ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n            CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n            SOFTWARE.\n          </p>\n        </Alert>\n      </Col>\n    </Row>\n  </Page>\n);\n\nexport default AboutPage;\n","export default \"data:image/jpeg;base64,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\"","export default __webpack_public_path__ + \"static/media/baseline-add-24px.b16f86ed.svg\";","export default __webpack_public_path__ + \"static/media/baseline-remove-24px.811c054e.svg\";","export default __webpack_public_path__ + \"static/media/select-rows.fc6944e5.svg\";","export default __webpack_public_path__ + \"static/media/unselect-rows.1bbc986b.svg\";","export default __webpack_public_path__ + \"static/media/outline-file_copy-24px.45f813b5.svg\";","export default __webpack_public_path__ + \"static/media/arrow_up.807e68e4.svg\";","export default __webpack_public_path__ + \"static/media/arrow_down.048c6af1.svg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Button, ButtonGroup, ButtonToolbar } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport iconplus from \"../img/baseline-add-24px.svg\";\nimport iconless from \"../img/baseline-remove-24px.svg\";\nimport iconselectall from \"../img/select-rows.svg\";\nimport iconselectnone from \"../img/unselect-rows.svg\";\nimport iconduplicate from \"../img/outline-file_copy-24px.svg\";\nimport iconarrowup from \"../img/arrow_up.svg\";\nimport iconarrowdown from \"../img/arrow_down.svg\";\n\nconst AddRemoveButtonGroup = observer(\n  ({ elementType, selectedIds, setSelectedIds }) => {\n    const appstate = useContext(AppState);\n\n    return (\n      <ButtonToolbar>\n        <ButtonGroup\n          className=\"mr-2\"\n          aria-label=\"Barra de modificación de líneas\"\n        >\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Añadir una fila al final de la tabla\"\n            onClick={() => {\n              const newid = appstate.addElement(elementType);\n              setSelectedIds([newid]);\n            }}\n          >\n            <img src={iconplus} alt=\"Añadir fila\" />\n          </Button>\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Duplicar filas seleccionadas de la tabla\"\n            onClick={() => {\n              const newids = appstate.duplicateElements(\n                elementType,\n                selectedIds\n              );\n              setSelectedIds(newids);\n            }}\n          >\n            <img src={iconduplicate} alt=\"Duplicar fila\" />\n          </Button>\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Eliminar filas seleccionadas de la tabla\"\n            onClick={() => {\n              if (selectedIds.length > 0) {\n                let newid = appstate.deleteElements(elementType, selectedIds);\n                newid !== null ? setSelectedIds([newid]) : setSelectedIds([]);\n              }\n            }}\n          >\n            <img src={iconless} alt=\"Eliminar fila\" />\n          </Button>\n        </ButtonGroup>\n        <ButtonGroup aria-label=\"Barra de selección y deselección de filas\">\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Seleccionar todas las filas de la tabla\"\n            onClick={() => {\n              setSelectedIds(\n                appstate.getElements(elementType).map((e) => e.id)\n              );\n            }}\n          >\n            <img src={iconselectall} alt=\"Seleccionar todo\" />\n          </Button>\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Deseleccionar todas las filas de la tabla\"\n            onClick={() => {\n              setSelectedIds([]);\n            }}\n          >\n            <img src={iconselectnone} alt=\"Deseleccionar todo\" />\n          </Button>\n        </ButtonGroup>\n        <ButtonGroup aria-label=\"Barra de subir o bajar filas\">\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Subir primer elemento seleccionado en la tabla\"\n            onClick={() => {\n              appstate.moveUpFirstSelectedElement(elementType, selectedIds);\n            }}\n          >\n            <img src={iconarrowup} alt=\"Subir filas\" />\n          </Button>\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            title=\"Bajar primer elemento seleccionado en la tabla\"\n            onClick={() => {\n              appstate.moveDownFirstSelectedElement(elementType, selectedIds);\n            }}\n          >\n            <img src={iconarrowdown} alt=\"Bajar filas\" />\n          </Button>\n        </ButtonGroup>\n      </ButtonToolbar>\n    );\n  }\n);\n\nexport default AddRemoveButtonGroup;\n","export default __webpack_public_path__ + \"static/media/full_geom_icon.84975aac.svg\";","export default __webpack_public_path__ + \"static/media/null_pos_icon.196bc7a8.svg\";","export default __webpack_public_path__ + \"static/media/valid_pos_icon.8296e01e.svg\";","export default __webpack_public_path__ + \"static/media/valid_poly_icon.ff7781e5.svg\";","export default __webpack_public_path__ + \"static/media/null_poly_icon.30dba2cc.svg\";","export default __webpack_public_path__ + \"static/media/partial_geom_icon.e30e0637.svg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\n\n// Optimizador en https://jakearchibald.github.io/svgomg/\nconst OrientacionesSprite = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" display=\"none\">\n    <defs>\n      <symbol id=\"sN\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M29 8C45.6-.3 66 0 82 10L54 56 29 8\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sNE\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M82 7c9 5 16 12 21 21L54 55l28-48\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sNW\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M7 30A55 55 0 0 1 29 8l25 47-46-27\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sE\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M102 28a55 55 0 0 1 2.8 46L54 55 102 28\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sW\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M7.2 28a55 55 0 0 0-2.8 46l51-19-48-27\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sSE\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M105 73.7a55 55 0 0 1-33 33l-17-52 50 19\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sSW\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M5 73A55 55 0 0 0 37 106l17-52L5 73\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"sS\" viewBox=\"0 0 112 112\">\n        <path\n          d=\"M36 105a55 55 0 0 0 35 0L55 55l-18 52\"\n          fill=\"red\"\n          color=\"#000\"\n          opacity=\".8\"\n        />\n      </symbol>\n      <symbol id=\"circulo\" viewBox=\"0 0 112 112\">\n        <ellipse\n          cx=\"55.4\"\n          cy=\"55.4\"\n          fill=\"#FFFA\"\n          stroke=\"#000\"\n          strokeWidth=\"2.8\"\n          color=\"#000\"\n          rx=\"53\"\n          ry=\"53\"\n        />\n      </symbol>\n      <symbol id=\"cuadrado\" viewBox=\"0 0 112 112\">\n        <rect\n          width=\"112\"\n          height=\"112\"\n          fill=\"#ffaaaa\"\n        />\n      </symbol>\n      <symbol id=\"TECHO\" viewBox=\"0 0 112 112\">\n        <rect\n          width=\"112\"\n          height=\"40\"\n          fill=\"#777\"\n        />\n      </symbol>\n      <symbol id=\"SUELO\" viewBox=\"0 0 112 112\">\n        <rect\n          y=\"72\"\n          width=\"112\"\n          height=\"40\"\n          fill=\"#777\"\n        />\n      </symbol>\n      <symbol id=\"PARED\" viewBox=\"0 0 112 112\">\n        <rect\n          x=\"72\"\n          width=\"42\"\n          height=\"112\"\n          fill=\"#777\"\n        />\n      </symbol>\n    </defs>\n  </svg>\n);\n\nconst OrientaIcon = ({ dir, width = \"1.2em\", height = \"1.2em\" }) => {\n  if ([\"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\", \"N\"].includes(dir)) {\n    return (\n      <svg width={width} height={height} style={{ verticalAlign: \"middle\" }}>\n        <use xlinkHref=\"#circulo\" />\n        <use xlinkHref={`#s${dir}`} />\n      </svg>\n    );\n  }\n  return (\n    <svg width={width} height={height}>\n      <use xlinkHref=\"#circulo\" />\n    </svg>\n  );\n};\n\nconst TiltIcon = ({ dir, width = \"1.2em\", height = \"1.2em\" }) => {\n  if ([\"PARED\", \"SUELO\", \"TECHO\"].includes(dir)) {\n    return (\n      <svg width={width} height={height} style={{ verticalAlign: \"middle\" }}>\n        <use xlinkHref=\"#cuadrado\" />\n        <use xlinkHref={`#${dir}`} />\n      </svg>\n    );\n  }\n  return (\n    <svg width={width} height={height}>\n      <use xlinkHref=\"#cuadrado\" />\n    </svg>\n  );\n};\n\nexport { OrientacionesSprite, OrientaIcon, TiltIcon };\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n// Devuelve el campo convertido a valor numérico o el valor previo\nexport const getFloatOrOld = (newValue, oldValue) => {\n  const value = parseFloat(newValue.replace(\",\", \".\"));\n  return isNaN(value) ? oldValue : value;\n};\n\n// Normaliza número a un intervalo arbitrario (wrapping)\nexport function normalize(value, start, end) {\n  // ancho del intervalo\n  const width = end - start;\n  // convertimos el intervalo a [0, ancho] restando el valor inicial\n  const offset = value - start;\n  // volvemos a sumar el valor incial para volver al intervalo [start, end]\n  return offset - Math.floor(offset / width) * width + start;\n}\n\n// Conversión de orientación de ángulo a nombre\nexport function azimuth_name(azimuth_angle) {\n  const azimuth = normalize(azimuth_angle, 0.0, 360.0);\n  if (azimuth < 18.0) {\n    return \"S\";\n  } else if (azimuth < 69.0) {\n    return \"SE\";\n  } else if (azimuth < 120.0) {\n    return \"E\";\n  } else if (azimuth < 157.5) {\n    return \"NE\";\n  } else if (azimuth < 202.5) {\n    return \"N\";\n  } else if (azimuth < 240.0) {\n    // 202.5 = 360 - 157.5\n    return \"NW\";\n  } else if (azimuth < 291.0) {\n    // 240 = 360 - 120\n    return \"W\";\n  } else if (azimuth < 342.0) {\n    // 291 = 360 - 69\n    return \"SW\";\n  }\n\n  // 342 = 360 - 18\n  return \"S\";\n}\n\n// Conversión de inclinación de ángulo a nombre\nexport function tilt_name(tilt_angle) {\n  const tilt = normalize(tilt_angle, 0.0, 360.0);\n  if (tilt <= 60.0) {\n    return \"TECHO\";\n  } else if (tilt < 120.0) {\n    return \"PARED\";\n  } else if (tilt < 240.0) {\n    return \"SUELO\";\n  } else if (tilt < 300.0) {\n    return \"PARED\";\n  }\n\n  return \"TECHO\";\n}\n\n// Selecciona color según propiedades del material\n// Combinar conductividad con densidad para mejorar heurística según\n// https://www.codigotecnico.org/pdf/Programas/CEC/CAT-EC-v06.3_marzo_10.pdf\nexport const getMatColor = (mat, _e) => {\n  if (mat.conductivity) {\n    const lambda = mat.conductivity;\n    if (lambda < 0.1) {\n      // Aislantes - amarillo\n      return \"yellow\";\n    } else if (lambda < 0.35) {\n      // Madera / Morteros / piezas cerámicas ligeras - naranja\n      return \"orange\";\n    } else if (lambda < 0.9) {\n      // Madera / Morteros / piezas cerámicas ligeras - verde\n      return \"green\";\n    } else if (lambda < 1.5) {\n      // Cerámica - marrón\n      return \"brown\";\n    } else if (lambda < 3.0) {\n      // Mortero / hormigón - gris oscuro\n      return \"darkgray\";\n    } else {\n      // Metal - azul oscuro\n      return \"navyblue\";\n    }\n  } else {\n    return \"lightblue\";\n  }\n};\n\n// Selecciona color i\n// Based on https://stackoverflow.com/a/20129594/901944\nfunction selectColor(i, saturation = 100, opacity = 100) {\n  const goldenAngle = 137.508;\n  const hue = (i * goldenAngle).toFixed(2); // use golden angle approximation\n  const brightness = ((((i + 50) * goldenAngle) % 30) + 20).toFixed(2);\n\n  return `hsla(${hue},${saturation}%,${brightness}%,${opacity}%)`;\n}\n\n// Selecciona paleta de n colores\nexport default function palette(n, saturation = 100, opacity = 100) {\n  return [...Array(n)].map((_, i) => selectColor(i, saturation, opacity));\n}\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\n\nimport nullPosIcon from \"../img/null_pos_icon.svg\";\nimport validPosIcon from \"../img/valid_pos_icon.svg\";\nimport validPolyIcon from \"../img/valid_poly_icon.svg\";\nimport nullPolyIcon from \"../img/null_poly_icon.svg\";\nimport fullGeometryIcon from \"../img/full_geom_icon.svg\";\nimport partialGeometryIcon from \"../img/partial_geom_icon.svg\";\n\nimport { OrientaIcon, TiltIcon } from \"../helpers/IconsOrientaciones\";\n\nimport palette, { azimuth_name, tilt_name, getMatColor } from \"./utils\";\nimport {\n  BOUNDARY_TYPES_MAP,\n  SPACE_TYPES_MAP,\n  THERMAL_BRIDGE_TYPES_MAP,\n} from \"../../stores/types\";\n\n// Formateadores -------------------------------------------------------------\n\n// Muestra número sin decimales\nexport const Float0DigitsFmt = (cell, _row, _rowIndex, _formatExtraData) => {\n  if (cell === null || cell === undefined) {\n    return <span>-</span>;\n  }\n  return <span>{Number(cell).toFixed(0)}</span>;\n};\n\n// Muestra número con 1 decimal\nexport const Float1DigitsFmt = (cell, _row, _rowIndex, _formatExtraData) => {\n  if (cell === null || cell === undefined) {\n    return <span>-</span>;\n  }\n  return <span>{Number(cell).toFixed(1)}</span>;\n};\n\n// Muestra número con 2 decimales\nexport const Float2DigitsFmt = (cell, _row) => {\n  if (cell === null || cell === undefined) {\n    return <span>-</span>;\n  }\n\n  return <span>{Number(cell).toFixed(2)}</span>;\n};\n\n// Muestra número con 3 decimales\nexport const Float3DigitsFmt = (cell, _row) => {\n  if (cell === null || cell === undefined) {\n    return <span>-</span>;\n  }\n\n  return <span>{Number(cell).toFixed(3)}</span>;\n};\n\n/// Formato de id a nombre usando mapper\nexport const NameFromIdFmt = (cell, _row, _rowIndex, idMapper) => (\n  <span>{idMapper[cell]}</span>\n);\n\n// Muestra valor booleano\nexport const BoolFmt = (cell, _row, _rowIndex, _formatExtraData) => (\n  <span>{cell === true ? \"Sí\" : \"No\"}</span>\n);\n\n// Multiplier (por defecto es 1.0)\nexport const MultiplierFmt = (cell, _row, _rowIndex, _formatExtraData) =>\n  cell === null || cell === undefined ? (\n    <span>1</span>\n  ) : (\n    <span>{Number(cell).toFixed(0)}</span>\n  );\n\n// Muestra pertenencia a la ET (por defecto es sí)\nexport const InsideTeFmt = (cell, _row, _rowIndex, _formatExtraData) => (\n  <span>{cell !== false ? \"Sí\" : \"No\"}</span>\n);\n\n// Cota (por defecto es 0.00)\nexport const ZFmt = (cell, _row, _rowIndex, _formatExtraData) =>\n  cell === null || cell === undefined ? (\n    <span>0.00</span>\n  ) : (\n    <span>{Number(cell).toFixed(2)}</span>\n  );\n\n// Convierte ángulo de azimuth a nombre\nexport const AzimuthFmt = (azimuth_angle) =>\n  azimuth_angle === undefined ? \"-\" : azimuth_name(azimuth_angle);\n\n// Convierte ángulo de inclinación a nombre\nexport const TiltFmt = (tilt_angle) =>\n  tilt_angle === undefined ? \"-\" : tilt_name(tilt_angle);\n\n// Convierte punto 3D de posición a cadena de coordenadas\nexport const PosFmt = (pos) => {\n  if (pos === null) {\n    return \"-\";\n  } else if (pos.length === 3) {\n    return `[${pos[0].toFixed(2)}, ${pos[1].toFixed(2)}, ${pos[2].toFixed(2)}]`;\n  }\n  if (pos.length === 2) {\n    return `[${pos[0].toFixed(2)}, ${pos[1].toFixed(2)}]`;\n  }\n  return \"-\";\n};\n\n// Convierte vector de puntos 2D de polígono a cadena de lista de coordenadas\nexport const PolyFmt = (poly) =>\n  poly !== null && poly.length !== 0\n    ? `[${poly\n        .map((point) => `[${point[0].toFixed(2)}, ${point[1].toFixed(2)}]`)\n        .join(\", \")}]`\n    : \"-\";\n\n// Convierte punto 3D de posición o valor nulo a icono\nexport const PosIconFmt = (pos, _row) =>\n  pos !== null ? (\n    <img src={validPosIcon} alt=\"+\" />\n  ) : (\n    <img src={nullPosIcon} alt=\"-\" />\n  );\n\n// Convierte vector de puntos 3D a icono según tenga o no puntos\nexport const PolyIconFmt = (poly, _row) =>\n  poly !== null && poly.length !== 0 ? (\n    <img src={validPolyIcon} alt=\"+\" />\n  ) : (\n    <img src={nullPolyIcon} alt=\"-\" />\n  );\n\n// Línea descriptiva de geometría\nexport const OpaqueGeomFmt = (geom, _row) => {\n  return `azimuth: ${geom.azimuth.toFixed(2)},\ninclinación: ${geom.tilt.toFixed(2)},\nposición: ${PosFmt(geom.position)},\npolígono: ${PolyFmt(geom.polygon)}`;\n};\n\n// Línea descriptiva de huecos\nexport const WindowGeomFmt = (geom, _row) => {\n  return `ancho: ${geom.width.toFixed(2)},\nalto: ${geom.height.toFixed(2)},\nretranqueo: ${geom.setback.toFixed(2)},\nposición: ${PosFmt(geom.position)}`;\n};\n\n// Convierte geometría de hueco a icono según tenga o no punto de inserción\nexport const WindowGeomIconFmt = (geometry, row, _rowIndex, wallData) => {\n  const wall = wallData[row.wall];\n  const has_wall = wall !== undefined;\n  const azimuth_dir = has_wall ? AzimuthFmt(wall.azimuth) : \"-\";\n  const azimuth = has_wall ? <OrientaIcon dir={azimuth_dir} /> : \"-\";\n  const tilt_dir = has_wall ? TiltFmt(wall.tilt) : \"-\";\n  const tilt = has_wall ? <TiltIcon dir={tilt_dir} /> : \"-\";\n  const position = geometry.position ? (\n    <img src={fullGeometryIcon} alt=\"+\" />\n  ) : (\n    <img src={partialGeometryIcon} alt=\"-\" />\n  );\n  return (\n    <>\n      {position} | {azimuth} {azimuth_dir} | {tilt} {tilt_dir[0]}\n    </>\n  );\n};\n\n// Convierte geometría de hueco a icono según tenga o no punto de inserción\nexport const OpaqueGeomIconFmt = (\n  geometry,\n  _row,\n  _rowIndex,\n  _formatExtraData\n) => {\n  const azimuth_dir = AzimuthFmt(geometry.azimuth);\n  const azimuth = <OrientaIcon dir={azimuth_dir} />;\n  const tilt_dir = TiltFmt(geometry.tilt);\n  const tilt = <TiltIcon dir={tilt_dir} />;\n  const position = geometry.position ? (\n    <img src={fullGeometryIcon} alt=\"+\" />\n  ) : (\n    <img src={partialGeometryIcon} alt=\"-\" />\n  );\n  return (\n    <>\n      {position} | {azimuth} {azimuth_dir} | {tilt} {tilt_dir[0]}\n    </>\n  );\n};\n\n// Formato y opciones de condiciones de contorno\nexport const BoundaryFmt = (cell, _row) => (\n  <span>{BOUNDARY_TYPES_MAP[cell]}</span>\n);\nexport const BoundaryOpts = Object.keys(BOUNDARY_TYPES_MAP).map((k) => {\n  return { value: k, label: BOUNDARY_TYPES_MAP[k] };\n});\n\n// Formato y opciones de tipos de puentes térmicos\nexport const ThermalBridgeTypesFmt = (cell, _row) => (\n  <span>{THERMAL_BRIDGE_TYPES_MAP[cell]}</span>\n);\n\nexport const ThermalBridgeTypesOpts = Object.keys(THERMAL_BRIDGE_TYPES_MAP).map(\n  (k) => {\n    return { value: k, label: THERMAL_BRIDGE_TYPES_MAP[k] };\n  }\n);\n\n// Muestra tipo de espacio\nexport const SpaceTypeFmt = (cell, _row, _rowIndex, _formatExtraData) =>\n  cell === null || cell === undefined ? (\n    <span>ACONDICIONADO</span>\n  ) : (\n    <span>{SPACE_TYPES_MAP[cell]}</span>\n  );\n\n// Opciones de tipo de espacio\nexport const spaceTypesOpts = Object.keys(SPACE_TYPES_MAP).map((k) => {\n  return { value: k, label: SPACE_TYPES_MAP[k] };\n});\n\n// Formato de horarios como listas de [id, repeticiones]\n// con id a nombre usando mapper\nexport const ScheduleFmt = (cell, _row, _rowIndex, idMapper) => {\n  const txt = cell\n    .map(([id, count]) => `(${idMapper[id]}, ${count})`)\n    .join(\", \");\n  return <span>[{txt}]</span>;\n};\n\n/// Formato de espesor total de construcción de opaco (id -> thickness)\nexport const WallConsThicknessFmt = (\n  _cell,\n  row,\n  _rowIndex,\n  wallconsPropsMap\n) => {\n  // cell == id\n  const props = wallconsPropsMap[row.id];\n  const p = props.thickness;\n  if (p === undefined || p === null || isNaN(p)) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(3)}</span>;\n};\n\n/// Formato de resistencia intrínseca de construcción de opaco (id -> r_intrinsic)\nexport const WallConsResistanceFmt = (\n  _cell,\n  row,\n  _rowIndex,\n  wallconsPropsMap\n) => {\n  // cell == id\n  const props = wallconsPropsMap[row.id];\n  const p = props.resistance;\n  if (p === undefined || p === null || isNaN(p)) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(2)}</span>;\n};\n\nexport const LayersFmt = (cell, _row, _rowIndex, materials) => {\n  // cell == id\n  const num_layers = cell.length;\n  if (num_layers === 0) {\n    return (\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 10\">\n        <rect x=\"0\" y=\"0\" width=\"100\" height=\"10\" fill=\"white\" />\n      </svg>\n    );\n  }\n  let xPos = 0;\n  const layers = [];\n  for (const [idx, { material, e }] of cell.entries()) {\n    const mat = materials.find((m) => m.id === material);\n    const color = getMatColor(mat, e);\n    const width = Math.round(e * 100);\n    layers.push(\n      <rect key={idx} x={xPos} y=\"0\" width={width} height=\"10\" fill={color} />\n    );\n    xPos += Math.round(e * 100);\n  }\n\n  //  = cell.map(({ material, e }, idx) => {\n  //   const mat = materials.find((m) => m.id === material);\n  //   return <rect key={idx} x={10 * idx} width=\"10\" height=\"10\" fill={getMatColor(mat, e)} />;\n  // });\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 10\">\n      {layers}\n    </svg>\n  );\n};\n\n// Formato de área de huecos (id -> area)\nexport const WinAreaFmt = (_cell, row, _rowIndex, winProps) => {\n  // cell == id\n  const props = winProps[row.id];\n  const area = props.area * props.multiplier;\n  if (area === undefined || area === null || isNaN(area)) {\n    return <span>-</span>;\n  }\n  return <span>{area.toFixed(2)}</span>;\n};\n\n// Formato de fshobst (id -> fshobst)\nexport const FshobstFmt = (_cell, row, _rowIndex, winProps) => {\n  // cell == id\n  const props = winProps[row.id];\n  const p = props.f_shobst_override || props.f_shobst;\n  if (p === undefined || p === null || isNaN(p)) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(2)}</span>;\n};\n\n// Transmitancia de huecos (id -> window U-value)\nexport const WindowUFmt = (_cell, row, _rowIndex, winProps) => {\n  const props = winProps[row.id];\n  const p = props.u_value;\n  if (p === undefined || p === null) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(2)}</span>;\n};\n\n/// Formato de area de opaco (id -> area)\nexport const WallAreaFmt = (_cell, row, _rowIndex, wallPropsMap) => {\n  // cell == id\n  const props = wallPropsMap[row.id];\n  const p = props.area_net * props.multiplier;\n  if (p === undefined || p === null || isNaN(p)) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(2)}</span>;\n};\n\n/// Formato de U de opaco (id -> U_value)\nexport const WallUFmt = (_cell, row, _rowIndex, wallPropsMap) => {\n  // cell == id\n  const uvalue = wallPropsMap[row.id].u_value;\n  if (uvalue === undefined || uvalue === null || isNaN(uvalue)) {\n    return <span>-</span>;\n  }\n  return <span>{uvalue.toFixed(2)}</span>;\n};\n\n// Formato de area de espacio (id -> area)\nexport const SpaceAreaFmt = (_cell, row, _rowIndex, spacePropsMap) => {\n  // cell == id\n  const props = spacePropsMap[row.id];\n  const area = props.area * props.multiplier;\n  if (area === undefined || area === null || isNaN(area)) {\n    return <span>-</span>;\n  }\n  return <span>{area.toFixed(2)}</span>;\n};\n\n// Formato de volumen neto de espacio (id -> volume_net)\nexport const SpaceVolumeFmt = (_cell, row, _rowIndex, spacePropsMap) => {\n  // cell == id\n  const props = spacePropsMap[row.id];\n  const volume_net = props.volume_net * props.multiplier;\n  if (volume_net === undefined || volume_net === null || isNaN(volume_net)) {\n    return <span>-</span>;\n  }\n  return <span>{volume_net.toFixed(2)}</span>;\n};\n\n/// Formato de U de hueco (id -> U)\nexport const WinconsUFmt = (_cell, row, _rowIndex, propsMap) => {\n  const props = propsMap[row.id];\n  const p = props.u_value;\n  if (p === undefined || p === null || isNaN(p)) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(2)}</span>;\n};\n\n/// Formato de g_gl;wi de hueco (id -> g_glwi)\nexport const WinconsGglwiFmt = (_cell, row, _rowIndex, propsMap) => {\n  const props = propsMap[row.id];\n  const p = props.g_glwi;\n  if (p === undefined || p === null || isNaN(p)) {\n    return <span>-</span>;\n  }\n  return <span>{p.toFixed(2)}</span>;\n};\n\n// Valor en Y del valor value para una altura total disponible height\n// y con valores máximos y mínimo max y min, y un desplazamiento diff\nfunction getY(max, min, height, diff, value) {\n  return parseFloat(\n    (height - ((value - min) * height) / (max - min) + diff).toFixed(2)\n  );\n}\n\n// Formato de horario diario como sparkline\nexport const DayScheduleFmt = (cell, _row, _rowIndex) => {\n  // cell == [f32, ...]\n  const svgWidth = 200;\n  const svgHeight = 4;\n\n  if (cell.length === 0) {\n    return (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox={`0 0 ${svgWidth} ${svgHeight}`}\n      >\n        <rect x=\"0\" y=\"0\" width={svgWidth} height={svgHeight} fill=\"white\" />\n      </svg>\n    );\n  }\n\n  const strokeWidth = 0.5;\n  const height = svgHeight - 2 * strokeWidth;\n  const stepX = svgWidth / (24.0 - 1.0);\n  const max = Math.max(...cell, 1);\n  const min = Math.min(...cell, 0);\n\n  const pathY = getY(max, min, height, strokeWidth, cell[0]);\n  let pathCoords = `M0 ${pathY}`;\n  let tickCoords = \"\";\n  cell.forEach((value, idx) => {\n    const x = (idx * stepX).toFixed(2);\n    const y = getY(max, min, height, strokeWidth, value);\n    pathCoords += `L ${x} ${y}`;\n    tickCoords += `M${x} 0 L${x} ${svgHeight}`;\n  });\n\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox={`0 0 ${svgWidth} ${svgHeight}`}\n    >\n      <path\n        className=\"line\"\n        d={pathCoords}\n        fill=\"none\"\n        strokeWidth={0.5}\n        stroke=\"black\"\n      />\n      <path\n        className=\"fill\"\n        d={`${pathCoords} V ${svgHeight} L 0 ${svgHeight} Z`}\n        stroke=\"none\"\n        fill=\"#FF333355\"\n      />\n      <path\n        className=\"tick_lines\"\n        d={tickCoords}\n        fill=\"none\"\n        strokeWidth={0.1}\n        stroke=\"gray\"\n      />\n    </svg>\n  );\n};\n\n// Formato de horario mensual o anual como sparkline\n// Colorea cada elemento de repetición según su id\nexport const CountScheduleFmt = (cell, _row, _rowIndex, idMapper) => {\n  // cell == [(string, u32), ...]\n  const svgWidth = 200;\n  const svgHeight = 4;\n\n  if (cell.length === 0) {\n    return (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox={`0 0 ${svgWidth} ${svgHeight}`}\n      >\n        <rect x=\"0\" y=\"0\" width={svgWidth} height={svgHeight} fill=\"white\" />\n      </svg>\n    );\n  }\n\n  const totalCount = cell.map((v) => v[1]).reduce((a, b) => a + b, 0);\n  let keys = Object.keys(idMapper);\n  const colors = palette(keys.length, 100, 40);\n  const colorMap = new Map(keys.map((k, i) => [k, colors[i]]));\n\n  const stepX = svgWidth / totalCount;\n\n  let xPos = 0;\n  const layers = [];\n  let tickCoords = \"\";\n  for (const [idx, [key, count]] of cell.entries()) {\n    const color = colorMap.get(key);\n    for (let i = 0; i < count; i++) {\n      layers.push(\n        <rect\n          key={`${idx}-${i}`}\n          x={xPos.toFixed(2)}\n          y=\"0\"\n          width={stepX}\n          height=\"10\"\n          fill={color}\n        >\n          <title>\n            {idMapper[key]} ({count} repeticiones)\n          </title>\n        </rect>\n      );\n      tickCoords += `M${xPos} 0 L${xPos} ${svgHeight}`;\n      xPos += stepX;\n    }\n  }\n\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox={`0 0 ${svgWidth} ${svgHeight}`}\n    >\n      <path\n        className=\"tick_lines\"\n        d={tickCoords}\n        fill=\"none\"\n        strokeWidth={0.1}\n        stroke=\"gray\"\n      />\n      {layers}\n    </svg>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Button, ButtonGroup, ButtonToolbar } from \"react-bootstrap\";\n\nimport iconPlus from \"../img/baseline-add-24px.svg\";\nimport iconLess from \"../img/baseline-remove-24px.svg\";\nimport iconSelectAll from \"../img/select-rows.svg\";\nimport iconSelectNone from \"../img/unselect-rows.svg\";\nimport iconDuplicate from \"../img/outline-file_copy-24px.svg\";\nimport { uuidv4 } from \"../../utils\";\n\n// Componente de edición de listas\n// Permite añadir, duplicar, eliminar, seleccionar y deseleccionar elementos de la lista\nexport const ListEditor = ({\n  list,\n  setList,\n  newElement,\n  selectedIds,\n  setSelectedIds,\n}) => {\n  return (\n    <ButtonToolbar>\n      <ButtonGroup\n        className=\"mr-2\"\n        aria-label=\"Barra de modificación de líneas\"\n      >\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Añadir una fila al final de la tabla\"\n          onClick={() => {\n            const element = newElement();\n            setList([...list, element]);\n            // seleccionamos nuevo elemento recién creado\n            setSelectedIds([element.id]);\n          }}\n        >\n          <img src={iconPlus} alt=\"Añadir fila\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Duplicar filas seleccionadas de la tabla\"\n          onClick={() => {\n            const newids = [];\n            selectedIds.forEach((id) => {\n              const selectedIndex = list.findIndex((h) => h.id === id);\n              if (selectedIndex !== -1) {\n                const idx = selectedIndex >= 0 ? selectedIndex : 0;\n                const selectedObj = list[idx];\n                const dupObj = {\n                  ...selectedObj,\n                  id: uuidv4(),\n                };\n                newids.push(dupObj.id);\n                list.splice(idx + 1, 0, dupObj);\n                setList(list);\n              }\n            });\n            // Reseleccionamos lo nuevo\n            setSelectedIds(newids);\n          }}\n        >\n          <img src={iconDuplicate} alt=\"Duplicar fila\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Eliminar filas seleccionadas de la tabla\"\n          onClick={() => {\n            if (selectedIds.length > 0) {\n              const indices = list.reduce((acc, cur, idx) => {\n                if (selectedIds.includes(cur.id)) {\n                  acc.push(idx);\n                }\n                return acc;\n              }, []);\n              const minidx = Math.max(0, Math.min(...indices) - 1);\n              const newList = list.filter((h) => !selectedIds.includes(h.id));\n              // Selecciona el elemento anterior al primero seleccionado salvo que no queden elementos o sea el primero, o nada si no hay elementos\n              if (newList.length > 0) {\n                setSelectedIds([newList[minidx].id]);\n              } else {\n                setSelectedIds([]);\n              }\n              setList(newList);\n            }\n          }}\n        >\n          <img src={iconLess} alt=\"Eliminar fila\" />\n        </Button>\n      </ButtonGroup>\n      <ButtonGroup aria-label=\"Barra de selección y deselección de filas\">\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Seleccionar todas las filas de la tabla\"\n          onClick={() => {\n            setSelectedIds(list.map((e) => e.id));\n          }}\n        >\n          <img src={iconSelectAll} alt=\"Seleccionar todo\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Deseleccionar todas las filas de la tabla\"\n          onClick={() => {\n            setSelectedIds([]);\n          }}\n        >\n          <img src={iconSelectNone} alt=\"Deseleccionar todo\" />\n        </Button>\n      </ButtonGroup>\n    </ButtonToolbar>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useRef } from \"react\";\nimport {\n  Modal,\n  Button,\n  ToggleButtonGroup,\n  Col,\n  Container,\n  Form,\n  Row,\n  ToggleButton,\n} from \"react-bootstrap\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { uuidv4 } from \"../../utils\";\n\nimport { AzimuthFmt, Float2DigitsFmt, TiltFmt } from \"../tables/Formatters\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { ListEditor } from \"../ui/ListEditor\";\n\n/*\n  The getElement function from customEditor takes two arguments,\n  1. onUpdate: if you want to apply the modified data, call this function\n  2. props: contains alls customEditorParameters, \"row\" with whole row data, \"defaultValue\" with the received object, and attrs\n*/\n// Editor de datos geométricos de opacos\n// Recibe la geometría de un opaco {tilt: f32, azimuth: f32, position: null | [f32, f32, f32], polygon: [[f32, f32], ...]}\n// No se comprueba la coherencia de la definición geométrica con la superficie\nexport const GeometryOpaquesEditor = React.forwardRef(\n  ({ onUpdate, value, name }, _ref) => {\n    const hasDefinedPos = !(\n      value.position === null || value.position.length === 0\n    );\n    let x = 0.0,\n      y = 0.0,\n      z = 0.0;\n    if (hasDefinedPos) {\n      x = value.position[0];\n      y = value.position[1];\n      z = value.position[2];\n    }\n    const [hasPos, setHasPos] = useState(hasDefinedPos);\n    const [show, setShow] = useState(true);\n    // Posición\n    const [xPos, setXPos] = useState(x);\n    const [yPos, setYPos] = useState(y);\n    const [zPos, setZPos] = useState(z);\n    // Lista de puntos 2D del polígono como objetos\n    const [poly, setPoly] = useState(\n      (value.polygon || []).map((p) => ({ id: uuidv4(), X: p[0], Y: p[1] }))\n    );\n\n    const [azimuth, setAzimuth] = useState(value.azimuth);\n    const [tilt, setTilt] = useState(value.tilt);\n\n    const updateData = () => {\n      const position = hasPos\n        ? [parseFloat(xPos), parseFloat(yPos), parseFloat(zPos)]\n        : null;\n      const polygon = poly.map((p) => [p.X, p.Y]);\n      return onUpdate({\n        azimuth: parseFloat(azimuth),\n        tilt: parseFloat(tilt),\n        position,\n        polygon,\n      });\n    };\n\n    const handleClose = () => {\n      setShow(false);\n      updateData();\n    };\n\n    const handleCancel = () => {\n      setShow(false);\n      return onUpdate(value);\n    };\n\n    return (\n      <Modal\n        role=\"dialog\"\n        show={show}\n        centered\n        size=\"lg\"\n        onHide={() => handleCancel()}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>\n            Definición geométrica de opaco o sombra ({name})\n          </Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <Container>\n            <AzimuthTiltEditor\n              azimuth={azimuth}\n              setAzimuth={setAzimuth}\n              tilt={tilt}\n              setTilt={setTilt}\n            />\n            <PositionEditor\n              hasPos={hasPos}\n              setHasPos={setHasPos}\n              xPos={xPos}\n              setXPos={setXPos}\n              yPos={yPos}\n              setYPos={setYPos}\n              zPos={zPos}\n              setZPos={setZPos}\n            />\n            <CoordsTable poly={poly} setPoly={setPoly} />\n          </Container>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleCancel}>\n            Cancelar\n          </Button>\n          <Button variant=\"primary\" onClick={handleClose}>\n            Aceptar\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n);\n\n// Editor de Azimuth y Tilt\nconst AzimuthTiltEditor = ({ azimuth, setAzimuth, tilt, setTilt }) => (\n  <>\n    <Row>\n      <Col>\n        <Form.Label htmlFor=\"azimuth\">\n          Azimuth, γ [º] [-180,+180] (S=0, E+, W-).\n        </Form.Label>\n        <Row>\n          <Col md={6}>\n            <input\n              id=\"azimuth\"\n              className=\"form-control editor edit-text\"\n              type=\"text\"\n              size=\"7\"\n              title=\"Azimuth geográfico de la proyección horizontal de la normal a la superficie. Ángulo de desviación de la normal respecto al sur, E+, W+\"\n              value={azimuth}\n              onChange={(ev) => {\n                setAzimuth(ev.currentTarget.value.replace(\",\", \".\"));\n              }}\n            />\n          </Col>\n          <Col style={{ background: \"#EEE\", color: \"gray\" }}>\n            {AzimuthFmt(azimuth)}\n          </Col>\n        </Row>\n      </Col>\n    </Row>\n    <Row>\n      <Col>\n        <Form.Label htmlFor=\"tilt\">\n          Inclinación, β [º] [0, -+180] (0=techo, 90=pared vert., 180=suelo)\n        </Form.Label>\n        <Row>\n          <Col md={6}>\n            <input\n              id=\"tilt\"\n              className=\"form-control editor edit-text\"\n              type=\"text\"\n              size=\"7\"\n              title=\"Ángulo que forma la normal de la superficie respecto al eje +Z (0 = horizontal hacia arriba, 180 = horizontal hacia abajo)\"\n              value={tilt}\n              onChange={(ev) => {\n                setTilt(ev.currentTarget.value.replace(\",\", \".\"));\n              }}\n            />\n          </Col>\n          <Col style={{ background: \"#EEE\", color: \"gray\" }}>\n            {TiltFmt(tilt)}\n          </Col>\n        </Row>\n      </Col>\n    </Row>\n  </>\n);\n\nconst PositionEditor = ({\n  hasPos,\n  setHasPos,\n  xPos,\n  setXPos,\n  yPos,\n  setYPos,\n  zPos,\n  setZPos,\n}) => {\n  const inputXRef = useRef(null);\n  const inputYRef = useRef(null);\n  const inputZRef = useRef(null);\n  return (\n    <>\n      <Row id=\"position\">\n        <Col>\n          <label htmlFor=\"position\">Punto de inserción del elemento:</label>\n          <ToggleButtonGroup\n            type=\"radio\"\n            name=\"insertion_point_present\"\n            className=\"mb-2 btn-block\"\n            value={hasPos ? 2 : 1}\n          >\n            <ToggleButton\n              type=\"radio\"\n              variant=\"secondary\"\n              value={1}\n              className=\"col-md-6\"\n              onClick={(_e) => setHasPos(false)}\n            >\n              Sin posición definida\n            </ToggleButton>\n            <ToggleButton\n              type=\"radio\"\n              variant=\"secondary\"\n              value={2}\n              className=\"col-md-6\"\n              onClick={(_e) => setHasPos(true)}\n            >\n              Posición definida por coordenadas\n            </ToggleButton>\n          </ToggleButtonGroup>\n        </Col>\n      </Row>\n      <Form.Group as={Row}>\n        <Form.Label as={Col} md={1} htmlFor=\"xInput\" className=\"mr-3\">\n          X:\n        </Form.Label>\n        <Col>\n          <Form.Control\n            id=\"xInput\"\n            ref={inputXRef}\n            value={hasPos ? xPos : \"\"}\n            readOnly={!hasPos}\n            onChange={(ev) => {\n              setXPos(ev.currentTarget.value.replace(\",\", \".\"));\n            }}\n            className=\"mr-3\"\n          />\n        </Col>\n        <Form.Label as={Col} md={1} htmlFor=\"yInput\" className=\"mr-3\">\n          Y:\n        </Form.Label>\n        <Col>\n          <Form.Control\n            id=\"yInput\"\n            ref={inputYRef}\n            value={hasPos ? yPos : \"\"}\n            readOnly={!hasPos}\n            onChange={(ev) => {\n              setYPos(ev.currentTarget.value.replace(\",\", \".\"));\n            }}\n            className=\"mr-3\"\n          />\n        </Col>\n        {zPos === null || zPos === undefined ? null : (\n          <>\n            <Form.Label as={Col} md={1} htmlFor=\"zInput\" className=\"mr-3\">\n              Z:\n            </Form.Label>\n            <Col>\n              <Form.Control\n                md=\"2\"\n                id=\"zInput\"\n                ref={inputZRef}\n                value={hasPos ? zPos : \"\"}\n                readOnly={!hasPos}\n                onChange={(ev) => {\n                  setZPos(ev.currentTarget.value.replace(\",\", \".\"));\n                }}\n                className=\"mr-3\"\n              />\n            </Col>\n          </>\n        )}\n      </Form.Group>\n    </>\n  );\n};\n\n// Tabla de coordenadas X, Y de polígonos\nconst CoordsTable = ({ poly, setPoly }) => {\n  // Filas de puntos 2D seleccionados\n  const [selected, setSelected] = useState([]);\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"X\",\n      formatter: Float2DigitsFmt,\n      text: \"Coordenada X (coordenadas locales)\",\n      align: \"center\",\n      headerTitle: (_col, _colIndex) => \"Coordenadas locales eje X\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          X\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"Y\",\n      formatter: Float2DigitsFmt,\n      text: \"Coordenada Y (coordenadas locales)\",\n      align: \"center\",\n      headerTitle: (_col, _colIndex) => \"Coordenadas locales eje Y\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Y\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  const newPoint = () => ({ id: uuidv4(), X: 0.0, Y: 0.0 });\n\n  return (\n    <Row id=\"ctable\">\n      <Col>\n        <label htmlFor=\"ctable\">Polígono:</label>\n        <ListEditor\n          list={poly}\n          setList={setPoly}\n          newElement={newPoint}\n          selectedIds={selected}\n          setSelectedIds={setSelected}\n        />\n        <BootstrapTable\n          data={poly}\n          keyField=\"id\"\n          striped\n          hover\n          bordered={false}\n          cellEdit={cellEditFactory({\n            mode: \"dbclick\",\n            blurToSave: true,\n            afterSaveCell: (oldValue, newValue, row, column) => {\n              // Convierte a número campos numéricos\n              if ([\"X\", \"Y\"].includes(column.dataField)) {\n                row[column.dataField] = getFloatOrOld(newValue, oldValue);\n              }\n            },\n          })}\n          selectRow={{\n            mode: \"checkbox\",\n            clickToSelect: true,\n            clickToEdit: true,\n            selected: selected,\n            onSelect: (row, isSelected, _rowIndex, _e) => {\n              if (isSelected) {\n                setSelected([...selected, row.id]);\n              } else {\n                setSelected(selected.filter((it) => it !== row.id));\n              }\n            },\n            hideSelectColumn: true,\n            bgColor: \"lightgray\",\n          }}\n          columns={columns}\n        />\n      </Col>\n    </Row>\n  );\n};\n\n/*\n  The getElement function from customEditor takes two arguments,\n  1. onUpdate: if you want to apply the modified data, call this function\n  2. props: contains alls customEditorParameters, \"row\" with whole row data, \"defaultValue\" with the received object, and attrs\n*/\n// Editor de datos geométricos de huecos\n// Recibe la geometría de un hueco {position: [f32, f32], height: f32, width: f32, setback: f32}\n// No se comprueba la coherencia de la definición geométrica con la superficie\nexport const GeometryWindowEditor = React.forwardRef(\n  ({ onUpdate, value, name, ..._rest }, _ref) => {\n    const hasDefinedPos = !(\n      value.position === null || value.position.length === 0\n    );\n    let x = 0.0,\n      y = 0.0;\n    if (hasDefinedPos) {\n      x = value.position[0];\n      y = value.position[1];\n    }\n    const [hasPos, setHasPos] = useState(hasDefinedPos);\n    const [show, setShow] = useState(true);\n    // Posición\n    const [xPos, setXPos] = useState(x);\n    const [yPos, setYPos] = useState(y);\n\n    // Propiedades del hueco\n    const [width, setWidth] = useState(value.width);\n    const [height, setHeight] = useState(value.height);\n    const [setback, setSetback] = useState(value.setback);\n\n    const updateData = () => {\n      if (!hasPos) {\n        return onUpdate({\n          width: parseFloat(width),\n          height: parseFloat(height),\n          setback: parseFloat(setback),\n          position: null,\n        });\n      }\n\n      return onUpdate({\n        width: parseFloat(width),\n        height: parseFloat(height),\n        setback: parseFloat(setback),\n        position: [parseFloat(xPos), parseFloat(yPos)],\n      });\n    };\n\n    const handleClose = () => {\n      setShow(false);\n      updateData();\n    };\n\n    const handleCancel = () => {\n      setShow(false);\n      return onUpdate(value);\n    };\n\n    return (\n      <Modal\n        role=\"dialog\"\n        show={show}\n        centered\n        size=\"lg\"\n        onHide={() => handleCancel()} // Evitar enviar acciones a la tabla posterior\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Definición geométrica del hueco ({name})</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <WidthHeightSetbackEditor\n            width={width}\n            setWidth={setWidth}\n            height={height}\n            setHeight={setHeight}\n            setback={setback}\n            setSetback={setSetback}\n          />\n          <PositionEditor\n            hasPos={hasPos}\n            setHasPos={setHasPos}\n            xPos={xPos}\n            setXPos={setXPos}\n            yPos={yPos}\n            setYPos={setYPos}\n          />\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleCancel}>\n            Cancelar\n          </Button>\n          <Button variant=\"primary\" onClick={handleClose}>\n            Aceptar\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n);\n\nconst WidthHeightSetbackEditor = ({\n  width,\n  setWidth,\n  height,\n  setHeight,\n  setback,\n  setSetback,\n}) => {\n  return (\n    <>\n      <Row>\n        <Form.Label as={Col} htmlFor=\"width\">\n          Ancho [m]:\n        </Form.Label>\n        <Col>\n          <input\n            id=\"width\"\n            className=\"form-control editor edit-text\"\n            type=\"text\"\n            size=\"7\"\n            value={width}\n            onChange={(ev) => {\n              setWidth(ev.currentTarget.value.replace(\",\", \".\"));\n            }}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Form.Label as={Col} htmlFor=\"height\">\n          Alto [m]:\n        </Form.Label>\n        <Col>\n          <input\n            id=\"height\"\n            className=\"form-control editor edit-text\"\n            type=\"text\"\n            size=\"7\"\n            value={height}\n            onChange={(ev) => {\n              setHeight(ev.currentTarget.value.replace(\",\", \".\"));\n            }}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Form.Label as={Col} htmlFor=\"setback\">\n          Retranqueo [m]:\n        </Form.Label>\n        <Col>\n          <input\n            id=\"setback\"\n            className=\"form-control editor edit-text\"\n            type=\"text\"\n            size=\"7\"\n            value={setback}\n            onChange={(ev) => {\n              setSetback(ev.currentTarget.value.replace(\",\", \".\"));\n            }}\n          />\n        </Col>\n      </Row>\n    </>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport {\n  NameFromIdFmt,\n  WindowGeomFmt,\n  WindowGeomIconFmt,\n  WinAreaFmt,\n  FshobstFmt,\n  WindowUFmt,\n} from \"../tables/Formatters\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { GeometryWindowEditor } from \"./GeometryEditors\";\nimport { WINCONS, WALL } from \"../../stores/types\";\n\n// Tabla de huecos del edificio\nconst HuecosTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const winPropsMap = appstate.energy_indicators.props.windows;\n  const winconsMap = appstate.getIdNameMap(WINCONS);\n  const wallsMap = appstate.getIdNameMap(WALL);\n  const winconsOpts = appstate.getElementOptions(WINCONS);\n  const wallsOpts = appstate.getElementOptions(WALL);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const wallData = Object.fromEntries(\n    appstate.walls.map((w) => [\n      w.id,\n      { azimuth: w.geometry.azimuth, tilt: w.geometry.tilt, name: w.name },\n    ])\n  );\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre que identifica el hueco\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        const u_value_window = winPropsMap[row.id].u_value;\n        const u_value = !isNaN(u_value_window)\n          ? Number(u_value_window).toFixed(2)\n          : \"-\";\n        return `Hueco id: ${row.id}, U: ${u_value} W/m²K`;\n      },\n    },\n    {\n      dataField: \"cons\",\n      text: \"Construcción\",\n      align: \"center\",\n      headerStyle: () => ({ width: \"20%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: winconsMap,\n      headerTitle: () => \"Construcción del hueco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      editor: {\n        type: Type.SELECT,\n        options: winconsOpts,\n      },\n    },\n    {\n      dataField: \"wall\",\n      text: \"Opaco\",\n      align: \"center\",\n      headerStyle: () => ({ width: \"20%\" }),\n      editor: {\n        type: Type.SELECT,\n        options: wallsOpts,\n      },\n      formatter: NameFromIdFmt,\n      formatExtraData: wallsMap,\n      headerTitle: () => \"Opaco al que pertenece el hueco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"geometry\",\n      text: \"Geometría\",\n      align: \"center\",\n      formatter: WindowGeomIconFmt,\n      formatExtraData: wallData,\n      title: WindowGeomFmt,\n      headerTitle: () =>\n        \"Descripción geométrica del hueco (posición, ancho, alto, retranqueo). Posición en coordenadas de muro [x, y]. Para elementos sin definición geométrica completa la posición es una lista vacía.\",\n      editorRenderer: (editorProps, value, row) => (\n        <GeometryWindowEditor {...editorProps} value={value} name={row.name} />\n      ),\n      headerAlign: \"center\",\n      headerClasses: \"text-light bg-secondary\",\n    },\n    {\n      dataField: \"area\",\n      isDummyField: true,\n      editable: false,\n      text: \"A\",\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WinAreaFmt,\n      formatExtraData: winPropsMap,\n      headerTitle: () => \"Superficie proyectada del hueco (m²)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          A<sub>w,p</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>\n              [m<sup>2</sup>]\n            </i>\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"fshobst\",\n      isDummyField: true,\n      editable: false,\n      text: \"fshobst\",\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: FshobstFmt,\n      formatExtraData: winPropsMap,\n      headerTitle: () =>\n        \"Factor reductor por sombreamiento por obstáculos externos (comprende todos los elementos exteriores al hueco como voladizos, aletas laterales, retranqueos, obstáculos remotos, etc.), para el mes de julio (fracción). Este valor puede asimilarse al factor de sombra del hueco (FS). El Documento de Apoyo DA DB-HE/1 recoge valores del factor de sombra FS para considerar el efecto de voladizos, retranqueos, aletas laterales o lamas exteriores.\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          F<sub>sh;obst</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"window_u\",\n      isDummyField: true,\n      editable: false,\n      text: \"window U\",\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WindowUFmt,\n      formatExtraData: winPropsMap,\n      headerTitle: () => \"Transmitancia térmica del hueco [W/m²K]\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          U<sub>w</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²K]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.windows}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          // Convierte a número campos numéricos\n          if ([\"A\", \"fshobst\"].includes(column.dataField)) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      rowClasses={(row, _rowIdx) => {\n        const classes = [];\n        // Errores\n        if (error_ids_danger.includes(row.id)) {\n          classes.push(\"id_error_danger\");\n        }\n        // Avisos\n        if (error_ids_warning.includes(row.id)) {\n          classes.push(\"id_error_warning\");\n        }\n        // clase para elementos fuera de la ET\n        if (!winPropsMap[row.id].is_tenv) {\n          classes.push(\"outsidetenv\");\n        }\n        return classes.join(\" \");\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(HuecosTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { WINDOW } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport HuecosTable from \"./HuecosTable\";\n// import { update_fshobst } from \"wasm-envolventecte\";\n\n// Vista de huecos del edificio\nconst HuecosView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Huecos del edificio{\" \"}\n            <small className=\"text-muted\">({appstate.windows.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={WINDOW}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <HuecosTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n      <Row className=\"text-info small mt-3\">\n        <Col>\n          <p>\n            <b>NOTA:</b>Se marcan en color más claro aquellos elementos que no\n            pertenecen a la ET.\n          </p>\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default HuecosView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport {\n  BoundaryFmt,\n  BoundaryOpts,\n  OpaqueGeomFmt,\n  OpaqueGeomIconFmt,\n  NameFromIdFmt,\n  WallAreaFmt,\n  WallUFmt,\n} from \"../tables/Formatters\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { GeometryOpaquesEditor } from \"./GeometryEditors\";\nimport { OrientacionesSprite } from \"../helpers/IconsOrientaciones\";\nimport { SPACE, WALLCONS } from \"../../stores/types\";\n\n// Tabla de elementos opacos\nconst OpacosTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const wallPropsMap = appstate.energy_indicators.props.walls;\n  const wallconsMap = appstate.getIdNameMap(WALLCONS);\n  const spaceMap = appstate.getIdNameMap(SPACE);\n  const wallconsOpts = appstate.getElementOptions(WALLCONS);\n  const spaceOpts = appstate.getElementOptions(SPACE);\n  const spaceOptsAndNull = appstate.getElementOptions(SPACE, true);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre que identifica el elemento opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        const u_value_wall = wallPropsMap[row.id].u_value;\n        const u_value = !isNaN(u_value_wall)\n          ? Number(u_value_wall).toFixed(2)\n          : \"-\";\n        return `Opaco id: ${row.id}, U: ${u_value} W/m²K`;\n      },\n    },\n    {\n      dataField: \"bounds\",\n      text: \"Tipo\",\n      editor: {\n        type: Type.SELECT,\n        options: BoundaryOpts,\n      },\n      align: \"center\",\n      formatter: BoundaryFmt,\n      headerTitle: () =>\n        \"Condición de contorno del elemento opaco (INTERIOR | EXTERIOR | TERRENO | ADIABÁTICO)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Tipo\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"cons\",\n      text: \"Construcción\",\n      editor: {\n        type: Type.SELECT,\n        options: wallconsOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"20%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: wallconsMap,\n      headerTitle: () => \"Construcción del opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"space\",\n      text: \"Espacio\",\n      editor: {\n        type: Type.SELECT,\n        options: spaceOpts,\n      },\n      align: \"center\",\n      formatter: NameFromIdFmt,\n      formatExtraData: spaceMap,\n      headerTitle: () => \"Espacio al que pertenece el elemento opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"next_to\",\n      text: \"Espacio ady.\",\n      editable: (cell, row) => {\n        return row.bounds === \"INTERIOR\";\n      },\n      editor: {\n        type: Type.SELECT,\n        options: spaceOptsAndNull,\n      },\n      align: \"center\",\n      formatter: NameFromIdFmt,\n      formatExtraData: spaceMap,\n      headerTitle: () =>\n        \"Espacio adyacente con el que comunica el elemento opaco, cuando este es un elemento interior\",\n      headerAlign: \"center\",\n      headerClasses: \"text-light bg-secondary\",\n    },\n    {\n      dataField: \"geometry\",\n      text: \"Geometría\",\n      align: \"center\",\n      formatter: OpaqueGeomIconFmt,\n      title: OpaqueGeomFmt,\n      headerTitle: () =>\n        \"Geometría (punto de inserción, polígono, inclinación y orientación).\",\n      editorRenderer: (editorProps, value, row) => (\n        <GeometryOpaquesEditor {...editorProps} value={value} name={row.name} />\n      ),\n      headerAlign: \"center\",\n      headerClasses: \"text-light bg-secondary\",\n      headerFormatter: () => <>Geometría</>,\n    },\n    {\n      dataField: \"area\",\n      text: \"A\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WallAreaFmt,\n      formatExtraData: wallPropsMap,\n      headerTitle: () =>\n        \"Superficie neta (sin huecos) del elemento opaco, en m²\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          A<sub>c</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>\n              [m<sup>2</sup>]\n            </i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"wall_u\",\n      text: \"wall_u\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WallUFmt,\n      formatExtraData: wallPropsMap,\n      headerTitle: () => \"Transmitancia térmica del elemento opaco [W/m²K]\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          U<sub>c</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²K]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <>\n      <OrientacionesSprite />\n      <BootstrapTable\n        data={appstate.walls}\n        keyField=\"id\"\n        striped\n        hover\n        bordered={false}\n        cellEdit={cellEditFactory({\n          mode: \"dbclick\",\n          blurToSave: true,\n          // Corrige el valor del espacio adyacente de \"\" a null\n          afterSaveCell: (oldValue, newValue, row, column) => {\n            if (\n              (column.dataField === \"next_to\" && newValue === \"\") ||\n              (column.dataField === \"bounds\" && row.bounds !== \"INTERIOR\")\n            ) {\n              row.next_to = null;\n            } else if (column.dataField === \"A\") {\n              // Convierte a número campos numéricos\n              row.A = getFloatOrOld(newValue, oldValue);\n            } else if (\n              column.dataField === \"geometry.tilt\" &&\n              newValue !== \"\"\n            ) {\n              row.geometry.tilt = getFloatOrOld(newValue, oldValue);\n            } else if (\n              column.dataField === \"geometry.azimuth\" &&\n              newValue !== \"\"\n            ) {\n              row.geometry.azimuth = getFloatOrOld(newValue, oldValue);\n            }\n          },\n        })}\n        selectRow={{\n          mode: \"checkbox\",\n          clickToSelect: true,\n          clickToEdit: true,\n          selected: selectedIds,\n          onSelect: (row, isSelected) => {\n            if (isSelected) {\n              setSelectedIds([...selectedIds, row.id]);\n            } else {\n              setSelectedIds(selectedIds.filter((it) => it !== row.id));\n            }\n          },\n          hideSelectColumn: true,\n          bgColor: \"lightgray\",\n        }}\n        rowClasses={(row, _rowIdx) => {\n          const classes = [];\n          // Errores\n          if (error_ids_danger.includes(row.id)) {\n            classes.push(\"id_error_danger\");\n          }\n          // Avisos\n          if (error_ids_warning.includes(row.id)) {\n            classes.push(\"id_error_warning\");\n          }\n          // clase para elementos fuera de la ET\n          if (!wallPropsMap[row.id].is_tenv) {\n            classes.push(\"outsidetenv\");\n          }\n          return classes.join(\" \");\n        }}\n        columns={columns}\n      />\n    </>\n  );\n};\n\nexport default observer(OpacosTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { WALL } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport OpacosTable from \"./OpacosTable\";\n\n// Vista de elementos opacos\nconst OpacosView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Elementos opacos del edificio{\" \"}\n            <small className=\"text-muted\">({appstate.walls.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={WALL}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <OpacosTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n      <Row className=\"text-info small mt-3\">\n        <Col>\n          <p>\n            <b>NOTA:</b>Se marcan en color más claro aquellos elementos que no\n            pertenecen a la ET.\n          </p>\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default OpacosView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n// Validadores ---------------------------------------------------------------\n\n// Comprueba que el valor es un número y no es negativo\nexport const validateNonNegNumber = (newValue, _row, _column) => {\n  if (newValue == null || newValue == \"\" || isNaN(newValue) || newValue < 0.0) {\n    return {\n      valid: false,\n      message: \"Debe introducir un valor numérico mayor o igual que cero\",\n    };\n  } else {\n    return true;\n  }\n};\n\n// Comprueba que el valor es un número y no es negativo o es una cadena vacía\nexport const validateNonNegNumberOrEmpty = (newValue, _row, _column) => {\n  if (newValue == \"\") {\n    return true;\n  } else if (newValue == null || isNaN(newValue) || newValue < 0.0) {\n    return {\n      valid: false,\n      message:\n        \"Debe introducir un valor numérico mayor o igual que cero o una cadena vacía\",\n    };\n  } else {\n    return true;\n  }\n};\n\n// Comprueba que el valor es un número\nexport const validateNumber = (newValue, _row, _column) => {\n  if (newValue == null || newValue == \"\" || isNaN(newValue)) {\n    return {\n      valid: false,\n      message: \"Debe introducir un valor numérico\",\n    };\n  } else {\n    return true;\n  }\n};\n\n// Comprueba que el valor es un número entero\nexport const validateIntegerNumber = (newValue, _row, _column) => {\n  if (\n    newValue == null ||\n    newValue == \"\" ||\n    isNaN(newValue) ||\n    Number(newValue) % 1 !== 0\n  ) {\n    return {\n      valid: false,\n      message: \"Debe introducir un número entero\",\n    };\n  } else {\n    return true;\n  }\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport {\n  Float2DigitsFmt,\n  ThermalBridgeTypesFmt,\n  ThermalBridgeTypesOpts,\n} from \"../tables/Formatters\";\nimport { validateNonNegNumber, validateNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\n// Tabla de puentes térmicos del edificio\nconst PTsTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"30%\" }),\n      headerTitle: (_col, _colIndex) =>\n        \"Nombre que identifica el puente térmico\",\n      headerClasses: \"text-light bg-secondary\",\n      headerFormatter: () => (\n        <>\n          Nombre\n          <br />{\" \"}\n        </>\n      ),\n      title: (_cell, row) => `Puente térmico id: ${row.id}`,\n    },\n    {\n      dataField: \"l\",\n      text: \"Longitud\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: (_col, _colIndex) => \"Longitud del puente térmico (m)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Longitud\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"kind\",\n      text: \"Tipo\",\n      align: \"center\",\n      editor: {\n        type: Type.SELECT,\n        options: ThermalBridgeTypesOpts,\n      },\n      formatter: ThermalBridgeTypesFmt,\n      headerTitle: (_col, _colIndex) =>\n        \"Tipo del puente térmico: CUBIERTA (encuentro de cubierta o suelo con fachada) | BALCÓN (suelo en vuelo exterior) | ESQUINA (encuentro de cerramientos verticales) | FORJADO (encuentro forjado-fachada) | PARTICIÓN (encuentro de partición interior con fachada, cubierta o suelo) | SOLERA (encuentra de solera o cámara ventilada con fachada) | PILAR (pilar en fachada, cubierta o suelo) | HUECO (contorno de hueco)  | GENÉRICO (puente térmico genérico))\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Tipo\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>-</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"psi\",\n      text: \"Transmitancia\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNumber,\n      headerClasses: \"text-light bg-secondary\",\n      headerAttrs: {\n        title: \"Transmitancia térmica lineal del puente térmico (W/mK)\",\n        \"text-align\": \"center\",\n      },\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &psi;\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/mK]</i>\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.thermal_bridges}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          // Convierte a número campos numéricos\n          if ([\"L\", \"psi\"].includes(column.dataField)) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(PTsTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { THERMAL_BRIDGE } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport PTsTable from \"./PTsTable\";\n\n// Vista de puentes térmicos del edificio\nconst PTsView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Puentes térmicos{\" \"}\n            <small className=\"text-muted\">\n              ({appstate.thermal_bridges.length})\n            </small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={THERMAL_BRIDGE}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <PTsTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n      <Row className=\"text-info small mt-3\">\n        <Col>\n          <p>\n            <b>NOTA</b>: Para los puentes térmicos definidos en la tabla se\n            considera, a efectos del cálculo de K, un factor de ajuste{\" \"}\n            <i>\n              b<sub>tr,x</sub> = 1.0\n            </i>\n            , de modo que solo deben incluirse aquellos pertenecientes a\n            elementos con un factor de ajuste no nulo.\n          </p>\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default PTsView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { GeometryOpaquesEditor } from \"./GeometryEditors\";\nimport { OpaqueGeomFmt, OpaqueGeomIconFmt } from \"../tables/Formatters\";\n\n// Tabla de elementos de sombra del edificio\nconst ShadesTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"30%\" }),\n      headerTitle: () => \"Nombre que identifica el elemento de sombra\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Elemento de sombra id: ${row.id}`,\n    },\n    {\n      dataField: \"geometry\",\n      text: \"Geometría\",\n      align: \"center\",\n      formatter: OpaqueGeomIconFmt,\n      title: OpaqueGeomFmt,\n      headerTitle: () =>\n        \"Geometría (punto de inserción, vértices y orientación e inclinación de la superficie.\",\n      editorRenderer: (editorProps, value, row) => (\n        <GeometryOpaquesEditor {...editorProps} value={value} name={row.name} />\n      ),\n      headerAlign: \"center\",\n      headerClasses: \"text-light bg-secondary\",\n      headerFormatter: () => <>Geometría</>,\n    },\n  ];\n  return (\n    <BootstrapTable\n      data={appstate.shades}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      tableHeaderClass=\"text-light bg-secondary\"\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          if (\n            column.dataField === \"geometry.position\" &&\n            newValue === undefined\n          ) {\n            // Corrige el valor de position de undefined a null\n            row.geometry.position = null;\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(ShadesTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport ShadesTable from \"./ShadesTable\";\nimport { SHADE } from \"../../stores/types\";\n\n// Vista de elementos de sombra del edificio\nconst ShadesView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Elementos de sombra{\" \"}\n            <small className=\"text-muted\">({appstate.shades.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={SHADE}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <ShadesTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default ShadesView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport {\n  Float2DigitsFmt,\n  InsideTeFmt,\n  MultiplierFmt,\n  NameFromIdFmt,\n  SpaceTypeFmt,\n  spaceTypesOpts,\n  SpaceAreaFmt,\n  SpaceVolumeFmt,\n  ZFmt,\n} from \"../tables/Formatters\";\nimport {\n  validateNonNegNumber,\n  validateNumber,\n  validateIntegerNumber,\n} from \"../tables/Validators\";\n\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { LOAD, THERMOSTAT } from \"../../stores/types\";\n\n// Custom editor para pertenencia a la ET\n//\n// The getElement function returns a JSX value and takes two arguments:\n//  - onUpdate: if you want to apply the modified data, call this function\n//  - props: contain customEditorParameters, whole row data, defaultValue and attrs\n// Usamos forwardRef para poder tener referencias en componentes funcionales\n// ver: https://github.com/reactjs/reactjs.org/issues/2120\nconst InsideTeEditor = React.forwardRef((props, _ref) => {\n  const { value: cellValue, onUpdate } = props;\n  const [value, setValue] = useState(cellValue);\n\n  return (\n    <input\n      type=\"checkbox\"\n      checked={value}\n      onKeyDown={(e) => {\n        if (e.key === \"Enter\") {\n          onUpdate(value);\n        }\n      }}\n      onChange={(_e) => setValue(!value)}\n      onBlur={(_e) => onUpdate(value)}\n    />\n  );\n});\n\n// Custom editor para nivel de ventilación de los espacios n_v\nconst NVEditor = React.forwardRef((props, _ref) => {\n  const { defaultValue, onUpdate } = props;\n  const [value, setValue] = useState(defaultValue);\n  const updateData = () => {\n    // onUpdate cancela la edición si se pasa null así que usamos undefined en ese caso\n    // en BootstrapTable usamos cellEdit.afterSaveCell para cambiar undefined por null\n    const res =\n      value === null || value === \"\"\n        ? undefined\n        : Number(value.replace(\",\", \".\"));\n    onUpdate(res);\n  };\n\n  return (\n    <span>\n      <input\n        type=\"text\"\n        value={value === null || undefined ? \"\" : value}\n        onKeyDown={(e) => {\n          if (e.key === \"Enter\") {\n            updateData();\n          }\n        }}\n        onChange={(e) => {\n          let val = e.currentTarget.value;\n          val =\n            val === \"\" ||\n            val === null ||\n            Number.isNaN(Number(val.replace(\",\", \".\")))\n              ? \"\"\n              : val;\n          setValue(val);\n        }}\n        onBlur={(_e) => updateData()}\n      />\n    </span>\n  );\n});\n\n// Tabla de espacios del edificio\nconst SpacesTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const spacePropsMap = appstate.energy_indicators.props.spaces;\n  const loadsMap = appstate.getIdNameMap(LOAD);\n  const loadsOpts = appstate.getElementOptions(LOAD, true);\n  const thermostatsMap = appstate.getIdNameMap(THERMOSTAT);\n  const thermostatsOpts = appstate.getElementOptions(THERMOSTAT, true);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre del espacio\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Espacio id: ${row.id}`,\n    },\n    {\n      dataField: \"multiplier\",\n      text: \"Multiplicador\",\n      align: \"center\",\n      formatter: MultiplierFmt,\n      validator: validateIntegerNumber,\n      headerTitle: () => \"Multiplicador (-). Número de espacios iguales\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          mult.\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"kind\",\n      text: \"Tipo de espacio\",\n      align: \"center\",\n      formatter: SpaceTypeFmt,\n      editor: {\n        type: Type.SELECT,\n        options: spaceTypesOpts,\n      },\n      headerTitle: () =>\n        \"Tipo de espacio: ACONDICIONADO, NO ACONDICIONADO, NO HABITABLE\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Tipo\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"inside_tenv\",\n      text: \"Interior a ET\",\n      align: \"center\",\n      formatter: InsideTeFmt,\n      editorRenderer: (\n        editorProps,\n        value,\n        _row,\n        _column,\n        _rowIndex,\n        _columnIndex\n      ) => <InsideTeEditor value={value} {...editorProps} />,\n      headerTitle: () =>\n        \"¿Pertenece el espacio al interior de la envolvente térmica?\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          ¿Interior <br />a la E.T.?\n        </>\n      ),\n    },\n    {\n      dataField: \"height\",\n      text: \"Altura\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () =>\n        \"Altura total, bruta, o de suelo a suelo, del espacio (m)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          h<sub>s-s</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    \n    {\n      dataField: \"z\",\n      text: \"z\",\n      align: \"center\",\n      formatter: ZFmt,\n      validator: validateNumber,\n      headerTitle: () => \"Cota de la planta respecto al terreno, en m\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          z\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"loads\",\n      text: \"Cargas\",\n      editor: {\n        type: Type.SELECT,\n        options: loadsOpts,\n      },\n      align: \"center\",\n      formatter: NameFromIdFmt,\n      formatExtraData: loadsMap,\n      headerTitle: () => \"Perfil de cargas del espacio\",\n      headerAlign: \"center\",\n      headerClasses: \"text-light bg-secondary\",\n    },\n    {\n      dataField: \"thermostat\",\n      text: \"Consignas\",\n      editor: {\n        type: Type.SELECT,\n        options: thermostatsOpts,\n      },\n      align: \"center\",\n      formatter: NameFromIdFmt,\n      formatExtraData: thermostatsMap,\n      headerTitle: () => \"Consignas de temperatura en el espacio\",\n      headerAlign: \"center\",\n      headerClasses: \"text-light bg-secondary\",\n    },\n    {\n      dataField: \"n_v\",\n      text: \"Infiltraciones ren/h\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      editable: (cell, row) => {\n        return row.type === \"UNINHABITED\";\n      },\n      customEditor: {\n        getElement: (onUpdate, props) => (\n          <NVEditor onUpdate={onUpdate} defaultValue={null} {...props} />\n        ),\n      },\n      headerTitle: () =>\n        \"Nivel de infiltraciones del espacio, en ren/h\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          n<sub>v</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[ren/h]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"illuminance\",\n      text: \"Iluminancia lux\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      customEditor: {\n        getElement: (onUpdate, props) => (\n          <NVEditor onUpdate={onUpdate} defaultValue={null} {...props} />\n        ),\n      },\n      headerTitle: () =>\n        \"Iluminancia media en el plano de trabajo, en lux\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          E<sub>m</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[lux]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"area\",\n      text: \"A\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: SpaceAreaFmt,\n      formatExtraData: spacePropsMap,\n      headerTitle: () => \"Superficie útil del espacio (m²)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          A<sub>use;zt</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>\n              [m<sup>2</sup>]\n            </i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"volume_net\",\n      text: \"Volumen neto\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: SpaceVolumeFmt,\n      formatExtraData: spacePropsMap,\n      headerTitle: () => \"Volumen neto del espacio, en m³\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          V<sub>net</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>\n              [m<sup>3</sup>]\n            </i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.spaces}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          if (\n            (column.dataField === \"n_v\" && newValue === undefined) ||\n            (column.dataField === \"kind\" && newValue !== \"UNINHABITED\")\n          ) {\n            // Corrige el valor de n_v de undefined a null\n            // o cambia a null cuando no son espacios no habitables\n            // TODO: esto en terciario no necesariamente es así, \n            // ya que se pueden definir las infiltraciones\n            // cuando no funcionan los equipos\n            row.n_v = null;\n          } else if (\n            (column.dataField === \"illuminance\" && newValue === undefined)\n          ) {\n            // Corrige el valor de illuminance de undefined a null\n            row.illuminance = null;\n          } else if (\n            [\"loads\", \"thermostat\"].includes(column.dataField) &&\n            newValue === \"\"\n          ) {\n            row[column.dataField] = null;\n          } else if (\n            ![\"name\", \"inside_tenv\", \"kind\", \"loads\", \"thermostat\"].includes(\n              column.dataField\n            )\n          ) {\n            // Convierte a número salvo en el caso del nombre, inside_tenv, kind, loads y thermostat\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      // clase para elementos fuera de la ET\n      rowClasses={(row, _rowIndex) => (row.inside_tenv ? null : \"outsidetenv\")}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(SpacesTable);\n// export default observer(()=> <p>Prueba</p>)\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport SpacesTable from \"./SpacesTable\";\nimport { SPACE } from \"../../stores/types\";\n\n// Vista de espacios del edificio\nconst SpacesView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Espacios del edificio{\" \"}\n            <small className=\"text-muted\">({appstate.spaces.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={SPACE}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <SpacesTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n      <Row className=\"text-info small mt-3\">\n        <Col>\n          <p>\n            <b>NOTA:</b>Se marcan en color más claro aquellos elementos que no\n            pertenecen a la ET.\n          </p>\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default SpacesView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport {\n  Alert,\n  Badge,\n  Button,\n  ButtonGroup,\n  Card,\n  Col,\n  Collapse,\n  Row,\n} from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nconst IndicatorsPanel = () => {\n  const appstate = useContext(AppState);\n  const [warnings, setWarnings] = useState(false);\n\n  const { area_ref, q_soljul_data, n50_data, K_data } =\n    appstate.energy_indicators;\n  const { climate, name } = appstate.meta;\n\n  const { K } = K_data;\n  const { q_soljul } = q_soljul_data;\n  const { n50 } = n50_data;\n\n  const errors = appstate.warnings;\n  const numavisos = errors.length;\n\n  return (\n    <>\n      <Row>\n        <Col md={9}>\n          Proyecto: <i>{name}</i>\n        </Col>\n      </Row>\n      <Row>\n        <Col md={1} title=\"Zona climática (CTE DB-HE)\">\n          <b>{climate}</b>\n        </Col>\n        <Col\n          md={2}\n          title=\"Superficie útil de los espacios habitables del edificio o parte del edificio [m²]\"\n        >\n          A<sub>util</sub> = {area_ref.toFixed(2)} m²\n        </Col>\n        <Col md={2} title=\"Transmitancia térmica global del edificio [W/m²K]\">\n          <b>\n            <i>K</i> = {K.toFixed(2)} <i>W/m²K</i>\n          </b>\n        </Col>\n        <Col md={2} title=\"Indicador de control solar [kWh/m²·mes]\">\n          <b>\n            <i>\n              q<sub>sol;jul</sub>\n            </i>{\" \"}\n            = {area_ref !== 0 ? q_soljul.toFixed(2) : \"-\"} <i>kWh/m²·mes</i>\n          </b>\n        </Col>\n        <Col md={2} title=\"Tasa de renovación de aire a 50 Pa [1/h]\">\n          <b>\n            <i>\n              n<sub>50</sub>\n            </i>{\" \"}\n            = {n50.toFixed(2)}{\" \"}\n            <i>\n              h<sup>-1</sup>\n            </i>\n          </b>\n        </Col>\n        <Col md={3} align=\"right\">\n          <ButtonGroup>\n            <Button\n              size=\"sm\"\n              variant=\"light\"\n              onClick={() => setWarnings(!warnings)}\n            >\n              Avisos{\" \"}\n              <Badge bg={numavisos > 0 ? \"primary\" : \"secondary\"}>\n                ({numavisos}){\" \"}\n              </Badge>\n            </Button>\n            {numavisos > 0 && (\n              <Button onClick={() => appstate.errors.clear()} variant=\"light\">\n                Limpiar avisos\n              </Button>\n            )}\n          </ButtonGroup>\n        </Col>\n      </Row>\n      <Collapse in={warnings}>\n        <Card body bg=\"light\" border=\"info\" className=\"mb-3\">\n          <Row>\n            <Col>\n              {errors.map((e, idx) => (\n                <Alert variant={e.level.toLowerCase()} key={`AlertId${idx}`}>\n                  {e.msg}\n                </Alert>\n              ))}\n            </Col>\n          </Row>\n        </Card>\n      </Collapse>\n    </>\n  );\n};\n\nexport default observer(IndicatorsPanel);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Container, Row } from \"react-bootstrap\";\n\nimport Footer from \"../ui/Footer\";\nimport NavBar from \"../ui/Nav\";\nimport IndicatorsPanel from \"../indicators/IndicatorsPanel\";\n\nexport const PageWithIndicators = ({ route, children }) => {\n  return (\n    <Container fluid>\n      <Row>\n        <NavBar route={route} />\n      </Row>\n      <Row style={{ background: \"lightgray\" }} className=\"pb-2 mb-2\">\n        <Col>\n          <IndicatorsPanel />\n        </Col>\n      </Row>\n      {children}\n      <Footer />\n    </Container>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row, Tabs, Tab } from \"react-bootstrap\";\n\nimport HuecosView from \"./HuecosView\";\nimport OpacosView from \"./OpacosView\";\nimport PTsView from \"./PTsView\";\nimport ShadesView from \"./ShadesView\";\nimport SpacesView from \"./SpacesView\";\nimport { PageWithIndicators } from \"../ui/PageWithIndicators\";\n\nexport const BuildingPage = ({ route, activeKey, setActiveKey }) => {\n  return (\n    <PageWithIndicators route={route}>\n      <Row>\n        <Col>\n          <Tabs\n            activeKey={activeKey}\n            onSelect={setActiveKey}\n            id=\"building_element_tabs\"\n          >\n            <Tab eventKey=\"spaces\" title=\"Espacios\" className=\"pt-3\">\n              <SpacesView />\n            </Tab>\n            <Tab eventKey=\"walls\" title=\"Opacos\" className=\"pt-3\">\n              <OpacosView />\n            </Tab>\n            <Tab eventKey=\"windows\" title=\"Huecos\" className=\"pt-3\">\n              <HuecosView />\n            </Tab>\n            <Tab eventKey=\"shadows\" title=\"Sombras\" className=\"pt-3\">\n              <ShadesView />\n            </Tab>\n            <Tab\n              eventKey=\"thermal_bridges\"\n              title=\"Puentes Térmicos\"\n              className=\"pt-3\"\n            >\n              <PTsView />\n            </Tab>\n          </Tabs>\n        </Col>\n      </Row>\n    </PageWithIndicators>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { Float2DigitsFmt, NameFromIdFmt } from \"../tables/Formatters\";\nimport { validateNonNegNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { SCHEDULE_YEAR } from \"../../stores/types\";\n\n// Tabla de cargas de los espacios\n//  {\n//    \"id\": \"6b351706-c5d1-19d2-3ef5-866eb367f90a\",\n//    \"name\": \"NIVEL_ESTANQUEIDAD_1\",\n//    \"people_schedule\": \"5c051b49-ccd9-9e69-d522-e7f20d8d8730\",\n//    \"people_sensible\": 0.0,\n//    \"people_latent\": 0.0,\n//    \"equipment\": 0.0,\n//    \"equipment_schedule\": \"5c051b49-ccd9-9e69-d522-e7f20d8d8730\",\n//    \"lighting\": 0.0,\n//    \"lighting_schedule\": \"5c051b49-ccd9-9e69-d522-e7f20d8d8730\",\n//    \"illuminance\": null,\n//    \"area_per_person\": 0.0\n//  },\nconst LoadsTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const schedulesMap = appstate.getIdNameMap(SCHEDULE_YEAR);\n  const schedulesOpts = appstate.getElementOptions(SCHEDULE_YEAR, true);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre que identifica la definición de carga\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        return `Cargas id: ${row.id}`;\n      },\n    },\n    {\n      dataField: \"area_per_person\",\n      text: \"Densidad ocupación\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Superficie por ocupante (m²/pax)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          A<sub>oc</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m²/pax]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"people_sensible\",\n      text: \"Ocup. sensible\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Carga de ocupación, parte sensible (W/m²)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>oc,sen</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"people_latent\",\n      text: \"Ocup. latente\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Carga de ocupación, parte latente (W/m²)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>oc,lat</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"people_schedule\",\n      text: \"Horario ocupación\",\n      editor: {\n        type: Type.SELECT,\n        options: schedulesOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"15%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: schedulesMap,\n      headerTitle: () => \"Horario de ocupación\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"lighting\",\n      text: \"Iluminación\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Carga de iluminación (W/m²)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>il</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"lighting_schedule\",\n      text: \"Horario iluminación\",\n      editor: {\n        type: Type.SELECT,\n        options: schedulesOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"15%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: schedulesMap,\n      headerTitle: () => \"Horario de iluminación\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"equipment\",\n      text: \"Equipos\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Carga de equipos (W/m²)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>eq</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"equipment_schedule\",\n      text: \"Horario equipos\",\n      editor: {\n        type: Type.SELECT,\n        options: schedulesOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"15%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: schedulesMap,\n      headerTitle: () => \"Horario de equipos\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.loads}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        // Corrige el valor del espacio adyacente de \"\" a null\n        // y convierte campos numéricos a número\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          switch (column.dataField) {\n            // Campos opcionales numéricos\n            case \"illuminance\":\n              if (newValue == \"\") {\n                delete row[column.dataField];\n              } else {\n                row[column.dataField] = getFloatOrOld(newValue, oldValue);\n              }\n              break;\n            // Campos opcionales textuales\n            case \"people_schedule\":\n            case \"lighting_schedule\":\n            case \"equipment_schedule\":\n              if (newValue == \"\") {\n                row[column.dataField] = null;\n              }\n              break;\n            // Conversiones numéricas\n            case \"people_sensible\":\n            case \"people_latent\":\n            case \"lighting\":\n            case \"equipment\":\n            case \"area_per_person\":\n              if (newValue !== \"\") {\n                row[column.dataField] = getFloatOrOld(newValue, oldValue);\n              }\n              break;\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      rowClasses={(row, _rowIdx) => {\n        const classes = [];\n        // Errores\n        if (error_ids_danger.includes(row.id)) {\n          classes.push(\"id_error_danger\");\n        }\n        // Avisos\n        if (error_ids_warning.includes(row.id)) {\n          classes.push(\"id_error_warning\");\n        }\n        return classes.join(\" \");\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(LoadsTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { LOAD } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport LoadsTable from \"./LoadsTable\";\n\n// Vista de cargas de los espacios\nconst LoadsView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Cargas de los espacios{\" \"}\n            <small className=\"text-muted\">({appstate.loads.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={LOAD}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <LoadsTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default LoadsView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState } from \"react\";\nimport { Modal, Button, Col, Container, Row } from \"react-bootstrap\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { Float2DigitsFmt } from \"../tables/Formatters\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\n/*\n  The getElement function from customEditor takes two arguments,\n  1. onUpdate: if you want to apply the modified data, call this function\n  2. props: contains alls customEditorParameters, \"row\" with whole row data, \"defaultValue\" with the received object, and attrs\n*/\n// Editor de horario diario (valores horarios)\n// Recibe la lista de valores horarios [f32, ...]\nexport const ScheduleHoursEditor = React.forwardRef(\n  ({ onUpdate, value, name }, _ref) => {\n    const [show, setShow] = useState(true);\n    // Lista de valores horarios\n    const hourValues = (value || []).map((p, idx) => ({\n      id: idx + 1,\n      value: p,\n    }));\n\n    const updateData = () => {\n      const newHourValues = hourValues.map((p) => p.value);\n      onUpdate(newHourValues);\n    };\n\n    const handleClose = () => {\n      setShow(false);\n      updateData();\n    };\n\n    const handleCancel = () => {\n      setShow(false);\n      return onUpdate(value);\n    };\n\n    return (\n      <Modal\n        role=\"dialog\"\n        show={show}\n        centered\n        size=\"lg\"\n        onHide={() => handleCancel()}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Definición de valores horarios ({name})</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <Container>\n            <ScheduleHoursTable hours={hourValues} />\n          </Container>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleCancel}>\n            Cancelar\n          </Button>\n          <Button variant=\"primary\" onClick={handleClose}>\n            Aceptar\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n);\n\n// Tabla con valores horarios\nconst ScheduleHoursTable = ({ hours }) => {\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"hora\",\n      text: \"Hora\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: (cell, row) => row.id,\n      headerTitle: () => \"Hora para la que se define el valor horario. \",\n      headerStyle: () => ({ width: \"10%\" }),\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"value\",\n      formatter: Float2DigitsFmt,\n      text: \"valor\",\n      align: \"center\",\n      headerTitle: (_col, _colIndex) =>\n        \"Valor que toma el horario en esta hora\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  return (\n    <Row id=\"schedule_hours_edit_table\">\n      <Col>\n        <label htmlFor=\"schedule_hours_edit_table\">Horario:</label>\n        <BootstrapTable\n          data={hours}\n          keyField=\"id\"\n          striped\n          hover\n          bordered={false}\n          cellEdit={cellEditFactory({\n            mode: \"dbclick\",\n            blurToSave: true,\n            afterSaveCell: (oldValue, newValue, row, column) => {\n              // Convierte a número campos numéricos\n              row[column.dataField] = getFloatOrOld(newValue, oldValue);\n            },\n          })}\n          columns={columns}\n        />\n      </Col>\n    </Row>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { ScheduleHoursEditor } from \"./ScheduleHoursEditor\";\nimport { DayScheduleFmt } from \"../tables/Formatters\";\n\n// Tabla de horarios diarios\n//  {\n//    \"id\": \"fa7e1d88-0fc9-5f85-77a8-efee23a76cd8\",\n//    \"name\": \"SSHSVD\",\n//    \"values\": [\n//      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,\n//      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,\n//      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0\n//    ]\n//  }\nconst SchedulesDayTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre de la definición de horario\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        return `Horario id: ${row.id}`;\n      },\n    },\n    {\n      dataField: \"values\",\n      text: \"Valores horarios diarios\",\n      align: \"center\",\n      editorRenderer: (editorProps, value, row) => (\n        <ScheduleHoursEditor {...editorProps} value={value} name={row.name} />\n      ),\n      formatter: DayScheduleFmt,\n      headerTitle: () => \"Lista de valores horarios\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      title: (cell) => `Valores horarios: ${cell}`,\n    },\n    {\n      dataField: \"n_hours\",\n      text: \"n\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: (cell, row) => row.values.length,\n      headerTitle: () => \"Horas definidas en el horario diario\",\n      headerStyle: () => ({ width: \"10%\" }),\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.schedules.day}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        // Corrige el valor del horario de \"\" a null\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          switch (column.dataField) {\n            // Campos opcionales textuales\n            case \"values\":\n              if (newValue == \"\") {\n                row[column.dataField] = [];\n              }\n              break;\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      rowClasses={(row, _rowIdx) => {\n        const classes = [];\n        // Errores\n        if (error_ids_danger.includes(row.id)) {\n          classes.push(\"id_error_danger\");\n        }\n        // Avisos\n        if (error_ids_warning.includes(row.id)) {\n          classes.push(\"id_error_warning\");\n        }\n        return classes.join(\" \");\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(SchedulesDayTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { SCHEDULE_DAY } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport SchedulesDayTable from \"./SchedulesDayTable\";\n\n// Vista de horarios diarios\nconst SchedulesDayView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Horarios diarios{\" \"}\n            <small className=\"text-muted\">({appstate.schedules.day.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={SCHEDULE_DAY}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <SchedulesDayTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default SchedulesDayView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState } from \"react\";\nimport { Modal, Button, Col, Container, Row } from \"react-bootstrap\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { uuidv4 } from \"../../utils\";\n\nimport { Float0DigitsFmt, NameFromIdFmt } from \"../tables/Formatters\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { ListEditor } from \"../ui/ListEditor\";\n\n/*\n  The getElement function from customEditor takes two arguments,\n  1. onUpdate: if you want to apply the modified data, call this function\n  2. props: contains alls customEditorParameters, \"row\" with whole row data, \"defaultValue\" with the received object, and attrs\n*/\n// Editor de horarios anuales\n// Recibe la lista de tuplas de horario mensual y repeticiones [[uuid, f32], ...]\nexport const ScheduleCountsEditor = React.forwardRef(\n  ({ onUpdate, value, name, idMap, scheduleOpts }, _ref) => {\n    const [show, setShow] = useState(true);\n    // Lista de tuplas de [id_horario, repeticiones]\n    const [yearSchedules, setYearSchedules] = useState(\n      (value || []).map((p) => ({\n        id: uuidv4(),\n        schedule_id: p[0],\n        count: p[1],\n      }))\n    );\n\n    const updateData = () =>\n      onUpdate(yearSchedules.map((p) => [p.schedule_id, p.count]));\n\n    const handleClose = () => {\n      setShow(false);\n      updateData();\n    };\n\n    const handleCancel = () => {\n      setShow(false);\n      return onUpdate(value);\n    };\n\n    return (\n      <Modal\n        role=\"dialog\"\n        show={show}\n        centered\n        size=\"lg\"\n        onHide={() => handleCancel()}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Definición de horario ({name})</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <Container>\n            <ScheduleListTable\n              schedule={yearSchedules}\n              setSchedule={setYearSchedules}\n              idMap={idMap}\n              scheduleOpts={scheduleOpts}\n            />\n          </Container>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleCancel}>\n            Cancelar\n          </Button>\n          <Button variant=\"primary\" onClick={handleClose}>\n            Aceptar\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n);\n\n// Tabla con horarios mensuales y repeticiones\nconst ScheduleListTable = ({ schedule, setSchedule, idMap, scheduleOpts }) => {\n  // Filas seleccionadas\n  const [selected, setSelected] = useState([]);\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"schedule_id\",\n      text: \"Horario semanal\",\n      align: \"center\",\n      headerTitle: (_col, _colIndex) => \"Horario semanal\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      formatter: NameFromIdFmt,\n      formatExtraData: idMap,\n      editor: {\n        type: Type.SELECT,\n        options: scheduleOpts,\n      },\n    },\n    {\n      dataField: \"count\",\n      formatter: Float0DigitsFmt,\n      text: \"Repeticiones\",\n      align: \"center\",\n      headerTitle: (_col, _colIndex) =>\n        \"Número de veces que se repite el horario en la semana\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  const newSchedule = () => ({ id: uuidv4(), schedule_id: \"\", count: 1 });\n\n  return (\n    <Row id=\"sched_edit_table\">\n      <Col>\n        <label htmlFor=\"sched_edit_table\">Horario:</label>\n        <ListEditor\n          list={schedule}\n          setList={setSchedule}\n          newElement={newSchedule}\n          selectedIds={selected}\n          setSelectedIds={setSelected}\n        />\n        <BootstrapTable\n          data={schedule}\n          keyField=\"id\"\n          striped\n          hover\n          bordered={false}\n          cellEdit={cellEditFactory({\n            mode: \"dbclick\",\n            blurToSave: true,\n            afterSaveCell: (oldValue, newValue, row, column) => {\n              // Convierte a número campos numéricos\n              if ([\"count\"].includes(column.dataField)) {\n                row[column.dataField] = getFloatOrOld(newValue, oldValue);\n              }\n            },\n          })}\n          selectRow={{\n            mode: \"checkbox\",\n            clickToSelect: true,\n            clickToEdit: true,\n            selected: selected,\n            onSelect: (row, isSelected, _rowIndex, _e) => {\n              if (isSelected) {\n                setSelected([...selected, row.id]);\n              } else {\n                setSelected(selected.filter((it) => it !== row.id));\n              }\n            },\n            hideSelectColumn: true,\n            bgColor: \"lightgray\",\n          }}\n          columns={columns}\n        />\n      </Col>\n    </Row>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { SCHEDULE_DAY } from \"../../stores/types\";\nimport { CountScheduleFmt } from \"../tables/Formatters\";\nimport { ScheduleCountsEditor } from \"./ScheduleCountsEditor\";\n\n// Tabla de horarios semanales\n//  {\n//    \"id\": \"fa7e1d88-0fc9-5f85-77a8-efee23a76cd8\",\n//    \"name\": \"SSHSV\",\n//    \"values\": [\n//      [\n//        \"de9a3b5d-c024-aee7-1907-6498ef6427f4\",\n//        5\n//      ],\n//      [\n//        \"1dce7386-0848-5404-d2f2-3bcde8f9d086\",\n//        1\n//      ],\n//      [\n//        \"6836973b-5a43-97d6-840e-825f4bdcbeb9\",\n//        1\n//      ]\n//    ]\n//  }\nconst SchedulesWeekTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const daySchedulesMap = appstate.getIdNameMap(SCHEDULE_DAY);\n  const daySchedulesOpts = appstate.getElementOptions(SCHEDULE_DAY);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre de la definición de horario\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        return `Horario id: ${row.id}`;\n      },\n    },\n    {\n      dataField: \"values\",\n      text: \"Horarios diarios\",\n      align: \"center\",\n      editorRenderer: (editorProps, value, row) => (\n        <ScheduleCountsEditor\n          {...editorProps}\n          value={value}\n          name={row.name}\n          idMap={daySchedulesMap}\n          scheduleOpts={daySchedulesOpts}\n        />\n      ),\n      formatter: CountScheduleFmt,\n      formatExtraData: daySchedulesMap,\n      headerTitle: () => \"Lista de horarios diarios\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"n_days\",\n      text: \"n\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: (cell, row) =>\n        row.values.map(([_id, count]) => count).reduce((a, b) => a + b, 0),\n      headerTitle: () => \"Días definidos en el horario semanal\",\n      headerStyle: () => ({ width: \"10%\" }),\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.schedules.week}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        // Corrige el valor del horario de \"\" a null\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          switch (column.dataField) {\n            // Campos opcionales textuales\n            case \"values\":\n              if (newValue == \"\") {\n                row[column.dataField] = [];\n              }\n              break;\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      rowClasses={(row, _rowIdx) => {\n        const classes = [];\n        // Errores\n        if (error_ids_danger.includes(row.id)) {\n          classes.push(\"id_error_danger\");\n        }\n        // Avisos\n        if (error_ids_warning.includes(row.id)) {\n          classes.push(\"id_error_warning\");\n        }\n        return classes.join(\" \");\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(SchedulesWeekTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { SCHEDULE_WEEK } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport SchedulesWeekTable from \"./SchedulesWeekTable\";\n\n// Vista de horarios semanales\nconst SchedulesWeekView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Horarios semanales{\" \"}\n            <small className=\"text-muted\">({appstate.schedules.week.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={SCHEDULE_WEEK}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <SchedulesWeekTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default SchedulesWeekView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { SCHEDULE_WEEK } from \"../../stores/types\";\nimport { CountScheduleFmt } from \"../tables/Formatters\";\nimport { ScheduleCountsEditor } from \"./ScheduleCountsEditor\";\n\n// Tabla de horarios anuales\n//  {\n//    \"id\": \"fa7e1d88-0fc9-5f85-77a8-efee23a76cd8\",\n//    \"name\": \"SSHA\",\n//    \"values\": [\n//      [\n//        \"SSHSI\",\n//        21\n//      ],\n//      [\n//        \"SSHSV\",\n//        18\n//      ],\n//      [\n//        \"SSHSI\",\n//        13\n//      ]\n//    ]\n//  }\nconst SchedulesYearTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const weekSchedulesMap = appstate.getIdNameMap(SCHEDULE_WEEK);\n  const weekSchedulesOpts = appstate.getElementOptions(SCHEDULE_WEEK);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre de la definición de horario\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        return `Horario id: ${row.id}`;\n      },\n    },\n    {\n      dataField: \"values\",\n      text: \"Horarios semanales\",\n      align: \"center\",\n      editorRenderer: (editorProps, value, row) => (\n        <ScheduleCountsEditor\n          {...editorProps}\n          value={value}\n          name={row.name}\n          idMap={weekSchedulesMap}\n          scheduleOpts={weekSchedulesOpts}\n        />\n      ),\n      formatter: CountScheduleFmt,\n      formatExtraData: weekSchedulesMap,\n      headerTitle: () => \"Lista de horarios semanales\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"n_weeks\",\n      text: \"n\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: (cell, row) =>\n        row.values.map(([_id, count]) => count).reduce((a, b) => a + b, 0),\n      headerTitle: () => \"Semanas definidas en el horario anual\",\n      headerStyle: () => ({ width: \"10%\" }),\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.schedules.year}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        // Corrige el valor del horario de \"\" a null\n        // y convierte campos numéricos a número\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          switch (column.dataField) {\n            // Campos opcionales textuales\n            case \"values\":\n              if (newValue == \"\") {\n                row[column.dataField] = [];\n              }\n              break;\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      rowClasses={(row, _rowIdx) => {\n        const classes = [];\n        // Errores\n        if (error_ids_danger.includes(row.id)) {\n          classes.push(\"id_error_danger\");\n        }\n        // Avisos\n        if (error_ids_warning.includes(row.id)) {\n          classes.push(\"id_error_warning\");\n        }\n        return classes.join(\" \");\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(SchedulesYearTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { SCHEDULE_YEAR } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport SchedulesYearTable from \"./SchedulesYearTable\";\n\n// Vista de horarios anuales\nconst SchedulesYearView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Horarios anuales{\" \"}\n            <small className=\"text-muted\">({appstate.schedules.year.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={SCHEDULE_YEAR}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <SchedulesYearTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default SchedulesYearView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { SCHEDULE_YEAR } from \"../../stores/types\";\nimport { NameFromIdFmt } from \"../tables/Formatters\";\n\n// Tabla de consignas de los espacios\n//  {\n//    \"id\": \"2c7c691b-af33-66da-ec4b-eb51ad42ce3e\",\n//    \"name\": \"Residencial\",\n//    \"temp_max\": \"d02b9100-8895-0f1a-4f70-0bb216479f55\",\n//    \"temp_min\": \"026bc569-dc14-ade8-f130-e5da31fc74b8\"\n//  }\nconst ThermostatsTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const schedulesMap = appstate.getIdNameMap(SCHEDULE_YEAR);\n  const schedulesOpts = appstate.getElementOptions(SCHEDULE_YEAR, true);\n\n  // Lista de IDs con errores\n  const errors = appstate.warnings;\n  const error_ids_warning = errors\n    .filter((e) => e.level === \"WARNING\")\n    .map((e) => e.id);\n  const error_ids_danger = errors\n    .filter((e) => e.level === \"DANGER\")\n    .map((e) => e.id);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true, text: \"ID\" },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre que identifica la definición de consignas\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => {\n        return `Consignas id: ${row.id}`;\n      },\n    },\n    {\n      dataField: \"temp_max\",\n      text: \"Consigna alta (REF)\",\n      editor: {\n        type: Type.SELECT,\n        options: schedulesOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"25%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: schedulesMap,\n      headerTitle: () => \"Consigna alta (REF)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"temp_min\",\n      text: \"Consigna baja (CAL)\",\n      editor: {\n        type: Type.SELECT,\n        options: schedulesOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"25%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: schedulesMap,\n      headerTitle: () => \"Consigna baja (CAL)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.thermostats}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        // Corrige el valor del espacio adyacente de \"\" a null\n        // y convierte campos numéricos a número\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          switch (column.dataField) {\n            // Campos opcionales textuales\n            case \"temp_max\":\n            case \"temp_min\":\n              if (newValue == \"\") {\n                row[column.dataField] = null;\n              }\n              break;\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      rowClasses={(row, _rowIdx) => {\n        const classes = [];\n        // Errores\n        if (error_ids_danger.includes(row.id)) {\n          classes.push(\"id_error_danger\");\n        }\n        // Avisos\n        if (error_ids_warning.includes(row.id)) {\n          classes.push(\"id_error_warning\");\n        }\n        return classes.join(\" \");\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(ThermostatsTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { THERMOSTAT } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport ThermostatsTable from \"./ThermostatsTable\";\n\n// Vista de consignas de los espacios\nconst ThermostatsView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h4>\n            Consignas de los espacios{\" \"}\n            <small className=\"text-muted\">({appstate.thermostats.length})</small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={THERMOSTAT}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <ThermostatsTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </>\n  );\n});\n\nexport default ThermostatsView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row, Tabs, Tab } from \"react-bootstrap\";\n\nimport { PageWithIndicators } from \"../ui/PageWithIndicators\";\nimport LoadsView from \"./LoadsView\";\nimport SchedulesDayView from \"./SchedulesDayView\";\nimport SchedulesWeekView from \"./SchedulesWeekView\";\nimport SchedulesYearView from \"./SchedulesYearView\";\nimport ThermostatsView from \"./ThermostatsView\";\n\nexport const UsesPage = ({ route, activeKey, setActiveKey }) => {\n  return (\n    <PageWithIndicators route={route}>\n      <Row>\n        <Col>\n          <Tabs\n            activeKey={activeKey}\n            onSelect={setActiveKey}\n            id=\"building_element_tabs\"\n          >\n            <Tab eventKey=\"loads\" title=\"Cargas\" className=\"pt-3\">\n              <LoadsView />\n            </Tab>\n            <Tab eventKey=\"thermostats\" title=\"Consignas\" className=\"pt-3\">\n              <ThermostatsView />\n            </Tab>\n            <Tab\n              eventKey=\"schedules_year\"\n              title=\"Horarios anuales\"\n              className=\"pt-3\"\n            >\n              <SchedulesYearView />\n            </Tab>\n            <Tab\n              eventKey=\"schedules_week\"\n              title=\"Horarios semanales\"\n              className=\"pt-3\"\n            >\n              <SchedulesWeekView />\n            </Tab>\n            <Tab\n              eventKey=\"schedules_day\"\n              title=\"Horarios diarios\"\n              className=\"pt-3\"\n            >\n              <SchedulesDayView />\n            </Tab>\n          </Tabs>\n        </Col>\n      </Row>\n    </PageWithIndicators>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport {\n  Modal,\n  Button,\n  ButtonGroup,\n  Col,\n  Container,\n  Row,\n  ButtonToolbar,\n} from \"react-bootstrap\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport iconplus from \"../img/baseline-add-24px.svg\";\nimport iconless from \"../img/baseline-remove-24px.svg\";\nimport iconselectall from \"../img/select-rows.svg\";\nimport iconselectnone from \"../img/unselect-rows.svg\";\nimport iconduplicate from \"../img/outline-file_copy-24px.svg\";\nimport iconarrowup from \"../img/arrow_up.svg\";\nimport iconarrowdown from \"../img/arrow_down.svg\";\n\nimport { uuidv4 } from \"../../utils\";\nimport AppState, { EMPTY_ID } from \"../../stores/AppState\";\n\nimport { Float3DigitsFmt, NameFromIdFmt } from \"../tables/Formatters\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { MATERIAL } from \"../../stores/types\";\n\n/*\n  The getElement function from customEditor takes two arguments,\n  1. onUpdate: if you want to apply the modified data, call this function\n  2. props: contains alls customEditorParameters, \"row\" with whole row data, \"defaultValue\" with the received object, and attrs\n*/\n// Editor de capas de construcciones de opacos (id = UUID de material, e= espesor)\n// Recibe las capas de una construcción [{id, e}, ...]\nexport const LayersEditor = React.forwardRef(\n  ({ onUpdate, value, name }, _ref) => {\n    const [show, setShow] = useState(true);\n    // Lista de puntos 2D del polígono como objetos\n    const [layers, setLayers] = useState(\n      (value || []).map((layer) => ({ id: uuidv4(), ...layer }))\n    );\n\n    const updateData = () => {\n      const polygon = layers.map((p) => ({ material: p.material, e: p.e }));\n      return onUpdate(polygon);\n    };\n\n    const handleClose = () => {\n      setShow(false);\n      updateData();\n    };\n\n    const handleCancel = () => {\n      setShow(false);\n      return onUpdate(value);\n    };\n\n    return (\n      <Modal\n        role=\"dialog\"\n        show={show}\n        centered\n        size=\"lg\"\n        onHide={() => handleCancel()}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Construcción de elementos opacos ({name})</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <Container>\n            <LayersTable layers={layers} setLayers={setLayers} />\n          </Container>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleCancel}>\n            Cancelar\n          </Button>\n          <Button variant=\"primary\" onClick={handleClose}>\n            Aceptar\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    );\n  }\n);\n\n// Tabla de puentes térmicos del edificio\nconst LayersTable = ({ layers, setLayers }) => {\n  const appstate = useContext(AppState);\n  const matsMap = appstate.getIdNameMap(MATERIAL);\n  const materialOpts = appstate.getElementOptions(MATERIAL);\n\n  // Filas de puntos 2D seleccionados\n  const [selected, setSelected] = useState([]);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"material\",\n      text: \"Material de opaco\",\n      editor: {\n        type: Type.SELECT,\n        options: materialOpts,\n      },\n      formatter: NameFromIdFmt,\n      formatExtraData: matsMap,\n      align: \"left\",\n      headerTitle: (_col, _colIndex) => \"Material de opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => <>Material</>,\n    },\n    {\n      dataField: \"e\",\n      formatter: Float3DigitsFmt,\n      text: \"Espesor\",\n      align: \"center\",\n      headerTitle: (_col, _colIndex) => \"Espesor de la capa\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Espesor\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <Row id=\"ctable\">\n      <Col>\n        <p htmlFor=\"ctable\">Capas (de exterior a interior):</p>\n        <AddRemovePolyButtonGroup\n          layers={layers}\n          setLayers={setLayers}\n          selectedIds={selected}\n          setSelectedIds={setSelected}\n        />\n        <BootstrapTable\n          data={layers}\n          keyField=\"id\"\n          striped\n          hover\n          bordered={false}\n          cellEdit={cellEditFactory({\n            mode: \"dbclick\",\n            blurToSave: true,\n            afterSaveCell: (oldValue, newValue, row, column) => {\n              // Convierte a número campos numéricos\n              if ([\"e\"].includes(column.dataField)) {\n                row[column.dataField] = getFloatOrOld(newValue, oldValue);\n              }\n            },\n          })}\n          selectRow={{\n            mode: \"checkbox\",\n            clickToSelect: true,\n            clickToEdit: true,\n            selected: selected,\n            onSelect: (row, isSelected, _rowIndex, _e) => {\n              if (isSelected) {\n                setSelected([...selected, row.id]);\n              } else {\n                setSelected(selected.filter((it) => it !== row.id));\n              }\n            },\n            hideSelectColumn: true,\n            bgColor: \"lightgray\",\n          }}\n          columns={columns}\n        />\n      </Col>\n    </Row>\n  );\n};\n\nconst AddRemovePolyButtonGroup = ({\n  layers,\n  setLayers,\n  selectedIds,\n  setSelectedIds,\n}) => {\n  return (\n    <ButtonToolbar>\n      <ButtonGroup\n        className=\"mr-2\"\n        aria-label=\"Barra de modificación de líneas\"\n      >\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Añadir una capa al final de la tabla\"\n          onClick={() => {\n            const element = { id: uuidv4(), material: EMPTY_ID, e: 0.1 };\n            setLayers([...layers, element]);\n            // seleccionamos nuevo elemento recién creado\n            setSelectedIds([element.id]);\n          }}\n        >\n          <img src={iconplus} alt=\"Añadir capa\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Duplicar capas seleccionadas de la tabla\"\n          onClick={() => {\n            const newids = [];\n            selectedIds.forEach((id) => {\n              const selectedIndex = layers.findIndex((h) => h.id === id);\n              if (selectedIndex !== -1) {\n                const idx = selectedIndex >= 0 ? selectedIndex : 0;\n                const selectedObj = layers[idx];\n                const dupObj = {\n                  ...selectedObj,\n                  id: uuidv4(),\n                };\n                newids.push(dupObj.id);\n                layers.splice(idx + 1, 0, dupObj);\n                setLayers(layers);\n              }\n            });\n            // Reseleccionamos lo nuevo\n            setSelectedIds(newids);\n          }}\n        >\n          <img src={iconduplicate} alt=\"Duplicar capas\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Eliminar capas seleccionadas de la tabla\"\n          onClick={() => {\n            if (selectedIds.length > 0) {\n              const indices = layers.reduce((acc, cur, idx) => {\n                if (selectedIds.includes(cur.id)) {\n                  acc.push(idx);\n                }\n                return acc;\n              }, []);\n              const minidx = Math.max(0, Math.min(...indices) - 1);\n              const newPoly = layers.filter((h) => !selectedIds.includes(h.id));\n              // Selecciona el elemento anterior al primero seleccionado salvo que no queden elementos o sea el primero, o nada si no hay elementos\n              if (newPoly.length > 0) {\n                setSelectedIds([newPoly[minidx].id]);\n              } else {\n                setSelectedIds([]);\n              }\n              setLayers(newPoly);\n            }\n          }}\n        >\n          <img src={iconless} alt=\"Eliminar capa\" />\n        </Button>\n      </ButtonGroup>\n      <ButtonGroup aria-label=\"Barra de selección y deselección de capas\">\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Seleccionar todas las capas de la tabla\"\n          onClick={() => {\n            setSelectedIds(layers.map((e) => e.id));\n          }}\n        >\n          <img src={iconselectall} alt=\"Seleccionar todo\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Deseleccionar todas las filas de la tabla\"\n          onClick={() => {\n            setSelectedIds([]);\n          }}\n        >\n          <img src={iconselectnone} alt=\"Deseleccionar todo\" />\n        </Button>\n      </ButtonGroup>\n      <ButtonGroup aria-label=\"Barra de subir o bajar filas\">\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Subir primer elemento seleccionado en la tabla\"\n          onClick={() => {\n            if (layers.length < 2) return;\n            const selection = selectedIds[0];\n\n            const idx = layers.findIndex((h) => selection === h.id);\n            if (idx < 1) return;\n            const prev = layers[idx - 1];\n            const elem = layers[idx];\n\n            setLayers([\n              ...layers.slice(0, idx - 1),\n              elem,\n              prev,\n              ...layers.splice(idx + 1),\n            ]);\n          }}\n        >\n          <img src={iconarrowup} alt=\"Subir filas\" />\n        </Button>\n        <Button\n          variant=\"primary\"\n          size=\"sm\"\n          title=\"Bajar primer elemento seleccionado en la tabla\"\n          onClick={() => {\n            if (layers.length < 2) return;\n            const selection = selectedIds[0];\n\n            const idx = layers.findIndex((h) => selection === h.id);\n            if (idx > layers.length - 2 || idx < 0) return;\n            const elem = layers[idx];\n            const next = layers[idx + 1];\n\n            setLayers([\n              ...layers.slice(0, idx),\n              next,\n              elem,\n              ...layers.splice(idx + 2),\n            ]);\n          }}\n        >\n          <img src={iconarrowdown} alt=\"Bajar filas\" />\n        </Button>\n      </ButtonGroup>\n    </ButtonToolbar>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport {\n  Float2DigitsFmt,\n  WallConsResistanceFmt,\n  WallConsThicknessFmt,\n  LayersFmt,\n} from \"../tables/Formatters\";\nimport { validateNonNegNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { LayersEditor } from \"./LayersEditors\";\n\n// Tabla de opacos del edificio\nconst WallConsTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const wallconsPropsMap = appstate.energy_indicators.props.wallcons;\n  const walls_Co100 = appstate.energy_indicators.n50_data.walls_c.toFixed(2);\n  const mats = appstate.cons.materials;\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"30%\" }),\n      headerTitle: () => \"Nombre que identifica la construcción de opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Construcción de opaco id: ${row.id}`,\n    },\n    {\n      dataField: \"layers\",\n      text: \"Capas\",\n      align: \"center\",\n      formatter: LayersFmt,\n      formatExtraData: mats,\n      headerTitle: () => \"Capas de la construcción (nº)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          Capas\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[nº]</i>{\" \"}\n          </span>\n        </>\n      ),\n      editorRenderer: (editorProps, value, row) => (\n        <LayersEditor {...editorProps} value={value} name={row.name} />\n      ),\n      title: (_cell, row) =>\n        `Construcción de opaco:\\n ${row.layers\n          .map(\n            ({ material, e }) =>\n              \"- \" +\n              mats.find((m) => m.id == material)?.name +\n              \": \" +\n              e.toFixed(2)\n          )\n          .join(\"\\n\")}`,\n    },\n    {\n      dataField: \"absorptance\",\n      text: \"Absortividad\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Absortividad térmica de la solución constructiva (-)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &alpha;\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"thickness\",\n      text: \"Espesor\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WallConsThicknessFmt,\n      formatExtraData: wallconsPropsMap,\n      headerTitle: () => \"Espesor total de la composición de capas (m)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          e<br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"resistance\",\n      text: \"Resistencia intrínseca\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WallConsResistanceFmt,\n      formatExtraData: wallconsPropsMap,\n      headerTitle: () =>\n        \"Resistencia térmica de la solución constructiva (sin resistencias superficiales) (m²·K/W)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          R<sub>c;op</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m²·K/W]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"C_o\",\n      isDummyField: true,\n      text: \"C_o\",\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-readonly\",\n      formatter: () => walls_Co100,\n      formatExtraData: walls_Co100,\n      headerTitle: () =>\n        \"Coeficiente de caudal de aire de la parte opaca de la envolvente térmica (a 100 Pa). Varía según n50 de ensayo o tipo de edificio (nuevo / existente)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>o</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            [m<sup>3</sup>/h·m<sup>2</sup>]\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.cons.wallcons}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          // Convierte a número campos numéricos\n          if (\n            [\"thickness\", \"resistance\", \"absorptance\"].includes(\n              column.dataField\n            )\n          ) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(WallConsTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { WALLCONS } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport WallConsTable from \"./WallConsTable\";\n\n// Vista de construcciones de opacos del edificio\nconst WallConsView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <h4>\n            Construcciones de Opacos{\" \"}\n            <small className=\"text-muted\">\n              ({appstate.cons.wallcons.length})\n            </small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={WALLCONS}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <WallConsTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </Col>\n  );\n});\n\nexport default WallConsView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory, { Type } from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport {\n  Float2DigitsFmt,\n  NameFromIdFmt,\n  WinconsUFmt,\n  WinconsGglwiFmt,\n} from \"../tables/Formatters\";\nimport { validateNonNegNumber, validateNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\nimport { FRAME, GLASS } from \"../../stores/types\";\n\n// Tabla de construcciones de huecos del edificio\nconst WinConsTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n  const winconsPropsMap = appstate.energy_indicators.props.wincons;\n  const glassMap = appstate.getIdNameMap(GLASS);\n  const frameMap = appstate.getIdNameMap(FRAME);\n  const glassOpts = appstate.getElementOptions(GLASS);\n  const frameOpts = appstate.getElementOptions(FRAME);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"20%\" }),\n      headerTitle: () => \"Nombre que identifica la construcción de hueco\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Construcción de hueco id: ${row.id}`,\n    },\n    {\n      dataField: \"glass\",\n      text: \"Vidrio\",\n      editor: {\n        type: Type.SELECT,\n        options: glassOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"20%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: glassMap,\n      headerTitle: () => \"Tipo de vidrio del hueco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"frame\",\n      text: \"Marco\",\n      editor: {\n        type: Type.SELECT,\n        options: frameOpts,\n      },\n      align: \"center\",\n      headerStyle: () => ({ width: \"20%\" }),\n      formatter: NameFromIdFmt,\n      formatExtraData: frameMap,\n      headerTitle: () => \"Tipo de marco del hueco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n    },\n    {\n      dataField: \"f_f\",\n      text: \"F_f\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () =>\n        \"Fracción de marco de la construcción de hueco (-)\\n0.0 = sin marco, 1.0 = completamente opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          F<sub>f</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"delta_u\",\n      text: \"delta_u\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNumber,\n      headerTitle: () =>\n        \"Procentaje de incremento de trasnmitancia por intercalarios o cajones de persiana (%)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &Delta;<sub>U</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[%]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"g_glshwi\",\n      text: \"g_gl;sh;wi\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () =>\n        \"Factor solar del hueco con la protección solar móvil activada (-)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          g<sub>gl;sh;wi</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"c_100\",\n      text: \"C_100\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () =>\n        \"Coeficiente de permeabilidad al aire del hueco a 100 Pa (m³/hm²).\\n\" +\n        \"La clase de permeabilidad al aire de los huecos, \" +\n        \"según la norma UNE EN 12207:2000 es:\\n\" +\n        \"Clase 1: Cw;100 ≤ 50m3/hm2,\\nClase 2: Cw;100 ≤ 27 m³/hm²,\\n\" +\n        \"Clase 3: Cw;100 ≤ 9 m³/hm²,\\nClase 4: Cw;100 ≤ 3 m³/hm².\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>h;100</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m³/h·m²]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"U\",\n      text: \"U_w\",\n      isDummyField: true,\n      editable: false,\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WinconsUFmt,\n      formatExtraData: winconsPropsMap,\n      headerTitle: () =>\n        \"Transmitancia térmica del hueco (W/m²K).\\nSe especifica en su posición final y teniendo en cuenta las resistencias superficiales correspondientes.\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          U<sub>w</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²K]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"gglwi\",\n      isDummyField: true,\n      editable: false,\n      text: \"g_gl;wi\",\n      align: \"center\",\n      classes: \"td-column-computed-readonly\",\n      formatter: WinconsGglwiFmt,\n      formatExtraData: winconsPropsMap,\n      headerTitle: () =>\n        \"Factor solar del hueco sin la protección solar activada (g_glwi = g_gln * 0.90) (-).\\nTiene en cuenta el factor de difusión del vidrio y la transmitancia a incidencia normal.\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          g<sub>gl;wi</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.cons.wincons}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          if (\n            [\"f_f\", \"delta_u\", \"g_glshwi\", \"c_100\"].includes(column.dataField)\n          ) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(WinConsTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { WINCONS } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport WinConsTable from \"./WinConsTable\";\n\n// Vista de construcciones de huecos del edificio\nconst WinConsView = () => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <h4>\n            Construcciones de Huecos{\" \"}\n            <small className=\"text-muted\">\n              ({appstate.cons.wincons.length})\n            </small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={WINCONS}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <WinConsTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </Col>\n  );\n};\n\nexport default observer(WinConsView);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { Float1DigitsFmt, Float3DigitsFmt } from \"../tables/Formatters\";\nimport { validateNonNegNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\n// Tabla de materiales para opacos del edificio\nconst MaterialsTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"40%\" }),\n      headerTitle: () =>\n        \"Nombre que identifica de forma única el material de opaco\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Material de opaco id: ${row.id}`,\n    },\n    {\n      dataField: \"resistance\",\n      text: \"Resistencia térmica\",\n      align: \"center\",\n      formatter: Float3DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Resistencia térmica (m²K/W)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          R<br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[m²K/W]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"conductivity\",\n      text: \"Conductividad térmica\",\n      align: \"center\",\n      formatter: Float3DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Conductividad térmica (W/mK)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &lambda;\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/mK]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"density\",\n      text: \"Densidad\",\n      align: \"center\",\n      editable: (_cell, row) =>\n        row.conductivity == undefined || row.conductivity == null\n          ? false\n          : true,\n      validator: validateNonNegNumber,\n      formatter: Float1DigitsFmt,\n      headerTitle: () => \"Densidad del material (kg/m³)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &rho;\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[kg/m³]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"specific_heat\",\n      text: \"Calor específico\",\n      align: \"center\",\n      editable: (_cell, row) =>\n        row.conductivity == undefined || row.conductivity == null\n          ? false\n          : true,\n      validator: validateNonNegNumber,\n      formatter: Float1DigitsFmt,\n      headerTitle: () => \"Calor específico del material (J/kg·K)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          C<sub>p</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[J/kg K]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"vapour_diff\",\n      text: \"Factor de difusividad al vapor de agua\",\n      align: \"center\",\n      formatter: Float1DigitsFmt,\n      headerTitle: () =>\n        \"Factor de difusividad al vapor de agua del material (J/kg·K)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &mu;\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.cons.materials}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        beforeSaveCell: (oldValue, newValue, row, column) => {\n          // Aseguramos que la columna esté definida antes de intentar modificarla\n          row[column.dataField] = null;\n        },\n\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          // Convierte a número campos numéricos\n          if (\n            [\"density\", \"specific_heat\", \"vapour_diff\"].includes(\n              column.dataField\n            )\n          ) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n          // Si se define  el material por resistencia dejar en null campos por propiedades\n          if (column.dataField === \"resistance\") {\n            row[\"resistance\"] = getFloatOrOld(newValue, oldValue);\n            row?.conductivity ? delete row[\"conductivity\"] : null;\n            row?.density ? delete row[\"density\"] : null;\n            row?.specific_heat ? delete row[\"specific_heat\"] : null;\n          }\n          // Si se define  el material por propiedades dejar resistencia a null y completar resto a valor por defecto\n          if (column.dataField === \"conductivity\") {\n            row[\"conductivity\"] = getFloatOrOld(newValue, oldValue);\n            row?.resistance ? delete row[\"resistance\"] : null;\n            row?.density ? null : (row[\"density\"] = 1000.0);\n            row?.specific_heat ? null : (row[\"specific_heat\"] = 1000.0);\n          }\n          if (column.dataField === \"density\") {\n            row[\"density\"] = getFloatOrOld(newValue, oldValue);\n            row?.resistance ? delete row[\"resistance\"] : null;\n            row?.conductivity ? null : (row[\"conductivity\"] = 1.0);\n            row?.specific_heat ? null : (row[\"specific_heat\"] = 1000.0);\n          }\n          if (column.dataField === \"specific_heat\") {\n            row[\"specific_heat\"] = getFloatOrOld(newValue, oldValue);\n            row?.resistance ? delete row[\"resistance\"] : null;\n            row?.conductivity ? null : (row[\"conductivity\"] = 1.0);\n            row?.density ? null : (row[\"density\"] = 1000.0);\n          }\n          row[\"vapour_diff\"] === null ? delete row[\"vapour_diff\"] : null;\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(MaterialsTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { MATERIAL } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport MaterialsTable from \"./MaterialsTable\";\n\n// Vista de construcciones de opacos del edificio\nconst MaterialsView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <h4>\n            Materiales de opacos{\" \"}\n            <small className=\"text-muted\">\n              ({appstate.cons.materials.length})\n            </small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={MATERIAL}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <MaterialsTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </Col>\n  );\n});\n\nexport default MaterialsView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { Float2DigitsFmt } from \"../tables/Formatters\";\nimport { validateNonNegNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\n// Tabla de materiales para opacos del edificio\nconst GlassesTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"40%\" }),\n      headerTitle: () =>\n        \"Nombre que identifica de forma única el tipo de vidrio\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Vidrio id: ${row.id}`,\n    },\n    {\n      dataField: \"u_value\",\n      text: \"U\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Transmitancia térmica del vidrio (W/m²K)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          U<br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²K]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"g_gln\",\n      text: \"Factor solar del vidrio a incidencia normal\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Factor solar del vidrio a incidencia normal (-)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          g<sub>gl;n</sub>\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.cons.glasses}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          // Convierte a número campos numéricos\n          if ([\"u_value\", \"g_gln\"].includes(column.dataField)) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(GlassesTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { GLASS } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport GlassesTable from \"./GlassesTable\";\n\n// Vista de construcciones de opacos del edificio\nconst GlassesView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <h4>\n            Vidrios{\" \"}\n            <small className=\"text-muted\">\n              ({appstate.cons.glasses.length})\n            </small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={GLASS}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <GlassesTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </Col>\n  );\n});\n\nexport default GlassesView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport cellEditFactory from \"react-bootstrap-table2-editor\";\n\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { Float2DigitsFmt } from \"../tables/Formatters\";\nimport { validateNonNegNumber } from \"../tables/Validators\";\nimport { getFloatOrOld } from \"../tables/utils\";\n\n// Tabla de materiales para opacos del edificio\nconst FamesTable = ({ selectedIds, setSelectedIds }) => {\n  const appstate = useContext(AppState);\n\n  const columns = [\n    { dataField: \"id\", isKey: true, hidden: true },\n    {\n      dataField: \"name\",\n      text: \"Nombre\",\n      classes: \"font-weight-bold\",\n      headerStyle: () => ({ width: \"40%\" }),\n      headerTitle: () =>\n        \"Nombre que identifica de forma única el tipo de marco\",\n      headerClasses: \"text-light bg-secondary\",\n      title: (_cell, row) => `Marco id: ${row.id}`,\n    },\n    {\n      dataField: \"u_value\",\n      text: \"U\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Transmitancia térmica del marco (W/m²K)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          U<br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[W/m²K]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n    {\n      dataField: \"absorptivity\",\n      text: \"Absortividad del marco\",\n      align: \"center\",\n      formatter: Float2DigitsFmt,\n      validator: validateNonNegNumber,\n      headerTitle: () => \"Absortividad del marco (-)\",\n      headerClasses: \"text-light bg-secondary\",\n      headerAlign: \"center\",\n      headerFormatter: () => (\n        <>\n          &alpha;\n          <br />\n          <span style={{ fontWeight: \"normal\" }}>\n            <i>[-]</i>{\" \"}\n          </span>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <BootstrapTable\n      data={appstate.cons.frames}\n      keyField=\"id\"\n      striped\n      hover\n      bordered={false}\n      cellEdit={cellEditFactory({\n        mode: \"dbclick\",\n        blurToSave: true,\n        afterSaveCell: (oldValue, newValue, row, column) => {\n          // Convierte a número campos numéricos\n          if ([\"u_value\", \"absorptivity\"].includes(column.dataField)) {\n            row[column.dataField] = getFloatOrOld(newValue, oldValue);\n          }\n        },\n      })}\n      selectRow={{\n        mode: \"checkbox\",\n        clickToSelect: true,\n        clickToEdit: true,\n        selected: selectedIds,\n        onSelect: (row, isSelected) => {\n          if (isSelected) {\n            setSelectedIds([...selectedIds, row.id]);\n          } else {\n            setSelectedIds(selectedIds.filter((it) => it !== row.id));\n          }\n        },\n        hideSelectColumn: true,\n        bgColor: \"lightgray\",\n      }}\n      columns={columns}\n    />\n  );\n};\n\nexport default observer(FamesTable);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState, useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { FRAME } from \"../../stores/types\";\n\nimport AddRemoveButtonGroup from \"../ui/AddRemoveButtonGroup\";\nimport FramesTable from \"./FramesTable\";\n\n// Vista de construcciones de opacos del edificio\nconst FramesView = observer(() => {\n  const appstate = useContext(AppState);\n  const [selected, setSelected] = useState([]);\n\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <h4>\n            Marcos{\" \"}\n            <small className=\"text-muted\">\n              ({appstate.cons.frames.length})\n            </small>\n          </h4>\n        </Col>\n        <Col md=\"auto\">\n          <AddRemoveButtonGroup\n            elementType={FRAME}\n            selectedIds={selected}\n            setSelectedIds={setSelected}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <FramesTable selectedIds={selected} setSelectedIds={setSelected} />\n        </Col>\n      </Row>\n    </Col>\n  );\n});\n\nexport default FramesView;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row, Tabs, Tab } from \"react-bootstrap\";\n\nimport WallConsView from \"./WallConsView\";\nimport WinConsView from \"./WinConsView\";\nimport { PageWithIndicators } from \"../ui/PageWithIndicators\";\nimport MaterialsView from \"./MaterialsView\";\nimport GlassesView from \"./GlassesView\";\nimport FramesView from \"./FramesView\";\n\nconst ConsPage = ({ route, activeKey, setActiveKey }) => {\n  return (\n    <PageWithIndicators route={route}>\n      <Row>\n        <Col>\n          <Tabs\n            activeKey={activeKey}\n            onSelect={setActiveKey}\n            id=\"constructions_tabs\"\n          >\n            <Tab eventKey=\"wallcons\" title=\"Cons. opacos\" className=\"pt-3\">\n              <WallConsView />\n            </Tab>\n            <Tab eventKey=\"windowcons\" title=\"Cons. huecos\" className=\"pt-3\">\n              <WinConsView />\n            </Tab>\n            <Tab eventKey=\"materials\" title=\"Materiales\" className=\"pt-3\">\n              <MaterialsView />\n            </Tab>\n            <Tab eventKey=\"glasses\" title=\"Vidrios\" className=\"pt-3\">\n              <GlassesView />\n            </Tab>\n            <Tab eventKey=\"frames\" title=\"Marcos\" className=\"pt-3\">\n              <FramesView />\n            </Tab>\n          </Tabs>\n        </Col>\n      </Row>\n    </PageWithIndicators>\n  );\n};\n\nexport default ConsPage;\n","import { DoubleSide, LineBasicMaterial, MeshLambertMaterial } from \"three\";\n\nconst colorMap = {\n  Generic: 0x0000ff, // Genérico (líneas)\n  Line: 0x444444, // Bordes (líneas)\n  Selection: 0xff4444, // Selección\n  Shade: 0xa496ad, // Sombras\n  Window: 0xade1ec, // Ventanas\n  Adiabatic: 0x777777, // Adiabático\n  WallExt: 0xeecf74, // Paredes exterior\n  WallInt: 0xffce9d, // Paredes interior\n  WallGnd: 0xac8554, // Paredes terreno\n  RoofExt: 0x953e3f, // Techos exterior\n  RoofInt: 0xa54e4f, // Techos interior\n  RoofGnd: 0x5f2f2d, // Techos terreno\n  FloorExt: 0x893649, // Suelos exterior\n  FloorInt: 0x89627f, // Suelos interior\n  FloorGnd: 0x673659, // Suelos terreno\n};\n\n// Material genérico de líneas\nexport const material_generic_lines = new LineBasicMaterial({\n  name: \"generic_lines\",\n  color: colorMap[\"Generic\"],\n  linewidth: 1,\n});\n\n// Material de bordes\nexport const material_lines = new LineBasicMaterial({\n  name: \"lines\",\n  color: colorMap[\"Line\"],\n  linewidth: 1,\n});\n// Material selección\nexport const material_select = new MeshLambertMaterial({\n  name: \"select\",\n  color: colorMap[\"Selection\"],\n  side: DoubleSide,\n});\n// Sombras - violeta claro\nexport const material_shades = new MeshLambertMaterial({\n  name: \"shades\",\n  color: colorMap[\"Shade\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Ventanas azul claro\nexport const material_windows = new MeshLambertMaterial({\n  name: \"windows\",\n  color: colorMap[\"Window\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 0.5,\n});\n// Elementos adiabáticos gris\nexport const material_adiabatic = new MeshLambertMaterial({\n  name: \"adiabatic\",\n  color: colorMap[\"Adiabatic\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Paredes ocre\nexport const material_walls = new MeshLambertMaterial({\n  name: \"walls\",\n  color: colorMap[\"WallExt\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Paredes interior ocre claro\nexport const material_walls_interior = new MeshLambertMaterial({\n  name: \"walls_interior\",\n  color: colorMap[\"WallInt\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Paredes terreno ocre oscuro\nexport const material_walls_ground = new MeshLambertMaterial({\n  name: \"walls_ground\",\n  color: colorMap[\"WallGnd\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Techos rojizo\nexport const material_roofs = new MeshLambertMaterial({\n  name: \"roofs\",\n  color: colorMap[\"RoofExt\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Techos interior rojizo claro\nexport const material_roofs_interior = new MeshLambertMaterial({\n  name: \"roofs_interior\",\n  color: colorMap[\"RoofInt\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Techos terreno rojizo oscuro\nexport const material_roofs_ground = new MeshLambertMaterial({\n  name: \"roofs_ground\",\n  color: colorMap[\"RoofGnd\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Suelos con aire exterior rosado\nexport const material_floors = new MeshLambertMaterial({\n  name: \"floors\",\n  color: colorMap[\"FloorExt\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Suelos interior rosado claro\nexport const material_floors_interior = new MeshLambertMaterial({\n  name: \"floors_interior\",\n  color: colorMap[\"FloorInt\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n// Suelos terreno morado oscuro\nexport const material_floors_ground = new MeshLambertMaterial({\n  name: \"floors_ground\",\n  color: colorMap[\"FloorGnd\"],\n  side: DoubleSide,\n  transparent: true,\n  opacity: 1.0,\n});\n\n// Elige material en función del tipo de objeto\n//\n// Ahora mismo el material depende del tipo de elemento (Muro, cubierta, suelo, Window) y sus condiciones de contorno (ADIABATIC vs GROUND)\n//\n// TODO: Admitir más modos de representación:\n// - en función de si el elemento pertenece o no a la envolvente térmica\n// - en función de la U del elemento\nexport function getMaterial(mesh) {\n  const { type, bounds, subtype } = mesh.userData;\n  let material;\n  if (type === \"Wall\") {\n    if (bounds === \"ADIABATIC\") {\n      material = material_adiabatic;\n    } else if (subtype === \"FLOOR\") {\n      if (bounds === \"GROUND\") {\n        material = material_floors_ground;\n      } else if (bounds === \"INTERIOR\") {\n        material = material_floors_interior;\n      } else {\n        material = material_floors;\n      }\n    } else if (subtype === \"ROOF\") {\n      if (bounds === \"GROUND\") {\n        material = material_roofs_ground;\n      } else if (bounds === \"INTERIOR\") {\n        material = material_roofs_interior;\n      } else {\n        material = material_roofs;\n      }\n    } else {\n      if (bounds === \"GROUND\") {\n        material = material_walls_ground;\n      } else if (bounds === \"INTERIOR\") {\n        material = material_walls_interior;\n      } else {\n        material = material_walls;\n      }\n    }\n  } else if (type === \"Window\") {\n    material = material_windows;\n  } else if (type === \"Shade\") {\n    material = material_shades;\n  } else {\n    console.log(\n      `Elemento ${mesh.name} (${mesh.userData.type}), asignando material de selección por defecto`\n    );\n    material = material_select;\n  }\n  return material;\n}\n","import {\n  BufferGeometry,\n  EdgesGeometry,\n  Group,\n  LineSegments,\n  MathUtils,\n  Matrix3,\n  Matrix4,\n  Mesh,\n  ShapeUtils,\n  Vector2,\n  Vector3,\n} from \"three\";\nimport { getMaterial, material_lines } from \"./ctematerials.js\";\n\nconst { degToRad } = MathUtils;\n\n// Genera geometría del modelo\n//\n// El modelo maneja dos espacios de coordenadas, el global y el local de muro\n// Además, los ejes del modelo son en X,Y (inclinación, azimuth)\n// pero en ThreeJS usamos X,-Z\n// ThreeJS: ejes X rojo, Y verde, Z azul\n/* eslint-disable no-undefined */\nexport function initObjectsFromModel(model, scene) {\n  let buildingGroup;\n  const bGroup = scene.getObjectByName(\"BuildingGroup\");\n  if (bGroup) {\n    bGroup.remove(...bGroup.children);\n    buildingGroup = bGroup;\n  } else {\n    buildingGroup = new Group();\n    buildingGroup.name = \"BuildingGroup\";\n  }\n  buildingGroup.rotation.x = -Math.PI / 2;\n\n  let wireframeGroup;\n  const wfGroup = scene.getObjectByName(\"WireframeGroup\");\n  if (wfGroup) {\n    wfGroup.remove(...wfGroup.children);\n    wireframeGroup = wfGroup;\n  } else {\n    wireframeGroup = new Group();\n    wireframeGroup.name = \"WireframeGroup\";\n  }\n  wireframeGroup.rotation.x = -Math.PI / 2;\n\n  for (const wall of model.walls) {\n    const { geometry } = wall;\n    const { tilt, azimuth, position, polygon } = geometry;\n    // Detecta muros sin definición geométrica completa\n    if (!position || !polygon || tilt === undefined || azimuth === undefined) {\n      continue;\n    }\n    if (polygon.length < 2) {\n      // 1 punto o menos - nada\n      console.log(\"Generación de geometría incorrecta de muro: \", wall);\n      console.log(\"Sin suficientes datos de contorno: \", polygon);\n      continue;\n    }\n\n    const wallUserData = getUserData(wall);\n\n    // Conversión a coordenadas globales\n    const wallTransform = transformMatrix(tilt, azimuth, position);\n    // Conversión de coordenadas locales de muro a coordenadas de polígono de muro\n    const wallLocal2WallPolyTransform = wallLocal2WallPolygon(polygon);\n\n    // Muro\n    const wallWindows = model.windows.filter((w) => w.wall === wall.id);\n\n    const wallHoles = [];\n    for (const window of wallWindows) {\n      if (\n        !window.geometry.position ||\n        window.geometry.height * window.geometry.width === 0\n      ) {\n        continue;\n      }\n\n      // Contorno de muro en coordenadas de polígono de muro\n      const winContour = getWindowContour(window, wallLocal2WallPolyTransform);\n      const winMesh = meshFromCoords(winContour);\n      winMesh.geometry.applyMatrix4(wallTransform);\n\n      // Aplica retranqueo de huecos tomando normal del primer vértice\n      setWindowMeshSetback(window, winMesh);\n\n      // Asigna propiedades de hueco\n      winMesh.name = window.name;\n      winMesh.userData = getUserData(window, wallUserData);\n\n      // Elige material según propiedades\n      winMesh.material = getMaterial(winMesh);\n\n      // Añadir la malla al grupo\n      buildingGroup.add(winMesh);\n      // Añadir el path a la lista de huecos del muro\n      wallHoles.push(winContour);\n    }\n\n    const wallContour = polygon.map((p) => new Vector2(p[0], p[1]));\n    const wallMesh = meshFromCoords(wallContour, wallHoles);\n    wallMesh.geometry.applyMatrix4(wallTransform);\n\n    wallMesh.name = wall.name;\n    wallMesh.userData = wallUserData;\n    wallMesh.material = getMaterial(wallMesh);\n\n    buildingGroup.add(wallMesh);\n\n    // Añade wireframe\n    const wireframe = new LineSegments(\n      new EdgesGeometry(wallMesh.geometry),\n      material_lines\n    );\n    wireframe.renderOrder = 1; // wireframes en segundo lugar\n    wireframeGroup.add(wireframe);\n  }\n\n  // Sombras\n  const shades = model.shades || [];\n  for (let shade of shades) {\n    const { tilt, azimuth, position, polygon } = shade.geometry;\n    // Detecta sombras sin definición geométrica completa\n    if (!position || !polygon || tilt === undefined || azimuth === undefined) {\n      continue;\n    }\n    // Puntos insuficientes para generar una superficie\n    if (polygon.length < 3) {\n      continue;\n    }\n\n    const shadeTransform = transformMatrix(tilt, azimuth, position);\n    const contour = polygon.map((p) => new Vector2(p[0], p[1]));\n    const shadeMesh = meshFromCoords(contour);\n    shadeMesh.geometry.applyMatrix4(shadeTransform);\n\n    shadeMesh.name = shade.name;\n    shadeMesh.userData = getUserData(shade);\n    shadeMesh.material = getMaterial(shadeMesh);\n    buildingGroup.add(shadeMesh);\n  }\n\n  // Añade elementos a la escena\n  scene.add(buildingGroup);\n  scene.add(wireframeGroup);\n}\n\n// Calcula datos para mesh.userData a partir de objetos y propiedades del objeto padre\nfunction getUserData(obj, parentUserData = null) {\n  if (Object.prototype.hasOwnProperty.call(obj, \"space\")) {\n    // Es un muro\n    return {\n      id: obj.id,\n      name: obj.name,\n      type: \"Wall\",\n      bounds: obj.bounds, // ADIABATIC | GROUND | EXTERIOR | INTERIOR\n      subtype: getWallSubtype(obj), // FLOOR | ROOF | WALL\n    };\n  } else if (Object.prototype.hasOwnProperty.call(obj, \"wall\")) {\n    // Es un hueco\n    return {\n      id: obj.id,\n      name: obj.name,\n      type: \"Window\",\n      bounds: parentUserData.bounds, // ADIABATIC | GROUND | EXTERIOR | INTERIOR\n      subtype: parentUserData.subtype, // FLOOR | ROOF | WALL\n      parent: parentUserData.name,\n      parentId: parentUserData.id,\n    };\n  } else {\n    // Es una sombra\n    return {\n      id: obj.id,\n      name: obj.name,\n      type: \"Shade\",\n    };\n  }\n}\n\n// Construye malla a partir de lista de puntos (2D) de contorno y\n// lista de paths de huecos ([Path([Vector2, ...])...])\n// El contorno debe tener al menos 2 puntos (una línea)\nfunction meshFromCoords(contour, holes = []) {\n  const geom = new BufferGeometry();\n  let points;\n  if (contour.length < 3) {\n    // 2 puntos - línea\n    points = [contour[0], contour[1], contour[0]];\n  } else if (contour.length == 3 && holes.length === 0) {\n    // 3 puntos sin agujero - triángulo\n    points = [contour[0], contour[1], contour[2]];\n  } else if (contour.length === 4 && holes.length === 0) {\n    // 4 puntos sin agujero - cuadrilátero\n    points = [\n      contour[0],\n      contour[1],\n      contour[2],\n      contour[0],\n      contour[2],\n      contour[3],\n    ];\n  } else {\n    // Triangula teniendo en cuenta el contorno y los agujeros\n    // Genera los índices de vértices de la triangulación\n    const triangles = ShapeUtils.triangulateShape(contour, holes);\n    // Genera secuencia de 3 puntos a partir de los índices de triangulación\n    const pointsAll = contour.slice(0).concat(...holes);\n    points = [];\n    for (let triangle of triangles) {\n      for (let j = 0; j < 3; j++) {\n        const vertex = pointsAll[triangle[j]];\n        points.push(vertex);\n      }\n    }\n  }\n\n  geom.setFromPoints(points);\n  geom.computeVertexNormals();\n\n  const mesh = new Mesh(geom);\n  mesh.castShadow = mesh.receiveShadow = true;\n\n  return mesh;\n}\n\n// Obtener lista de puntos de contorno de un hueco\n// Los datos de hueco están en coordenadas locales de muro y se transforman en\n// coordenadas de polígono de muro\n// La posición se refiere a la esquina inferior izquierda.\nfunction getWindowContour(window, wallLocal2WallPolyTransform = null) {\n  const {\n    position: [x, y],\n    width,\n    height,\n  } = window.geometry;\n  // Generamos el hueco transformando las coordenadas a ejes locales de muro\n  let contour = [\n    new Vector2(x, y),\n    new Vector2(x + width, y),\n    new Vector2(x + width, y + height),\n    new Vector2(x, y + height),\n  ];\n  if (wallLocal2WallPolyTransform) {\n    contour = contour.map((p) => p.applyMatrix3(wallLocal2WallPolyTransform));\n  }\n  return contour;\n}\n\n// Aplica retranqueo a la malla del hueco\nfunction setWindowMeshSetback(window, mesh) {\n  // Aplica retranqueo de huecos tomando normal del primer vértice\n  const winNormal = new Vector3().fromBufferAttribute(\n    mesh.geometry.getAttribute(\"normal\"),\n    0\n  );\n  const winSetback = winNormal.multiplyScalar(-window.geometry.setback);\n  mesh.geometry.translate(...winSetback.toArray());\n\n  return mesh;\n}\n\n// Matriz de transformación de coordenadas locales de muro a coordenadas de su polígono 2D\n// Nos sirve para pasar de las coordenadas locales del muro a las coordenadas del polígono de muro en 2D\n// Se gira el eje X en la dirección del polígono de muro p1 - p0 y se traslada a p0 el origen\nfunction wallLocal2WallPolygon(wall_polygon) {\n  const v0 = wall_polygon[0];\n  const v1 = wall_polygon[1];\n  const dirX = new Vector2(v1[0] - v0[0], v1[1] - v0[1]);\n  const angleX = dirX.angle();\n  const c = Math.cos(angleX);\n  const s = Math.sin(angleX);\n  return new Matrix3().set(c, -s, v0[0], s, c, v0[1], 0, 0, 1);\n}\n\n// Matriz de transformación de los elementos del edificio\n// Traslada de coordenadas de muros a coordenadas globales (giros y desplazamientos)\n// y lleva del sistema de coordenadas X, Y al sistema X, -Z\nfunction transformMatrix(tilt, azimuth, position) {\n  const [x, y, z] = position;\n  // Aplicamos la inclinación del muro\n  const tilt_rot_mat = new Matrix4().makeRotationX(degToRad(tilt));\n  // Aplicamos el azimuth del muro\n  const azimuth_rot_mat = new Matrix4().makeRotationZ(degToRad(azimuth));\n  // Aplicamos la traslación en coordenadas globales\n  const trans_mat = new Matrix4().makeTranslation(x, y, z);\n\n  return trans_mat.multiply(azimuth_rot_mat).multiply(tilt_rot_mat);\n}\n\n// Devuelve subtipo de muro según inclinación: ROOF | FLOOR | WALL\nfunction getWallSubtype(wall) {\n  if (Math.abs(Math.abs(wall.geometry.tilt) - 180) < 1e-3) {\n    return \"FLOOR\";\n  } else if (Math.abs(wall.geometry.tilt) < 1e-3) {\n    return \"ROOF\";\n  }\n\n  return \"WALL\";\n}\n","import { Pane } from \"tweakpane\";\nimport { MeshLambertMaterial, DoubleSide, Plane, Vector3, Box3 } from \"three\";\n\n// Material doble cara - azul\nconst material_select = new MeshLambertMaterial({\n  color: 0xff4444,\n  side: DoubleSide,\n});\n\n// Plano para clipping global (por render)\n// Podría haber un clipping local (por material)\n// https://stackoverflow.com/a/36558152\n// Para una gestión más completa de un plano Z ver\n// https://github.com/agviegas/IFC.js/commit/9be223de323e6acd936d9493eda5753a4ffe8183\nconst globalClippingPlane = new Plane(new Vector3(0, -1, 0), 1);\n\nexport default class GUIView {\n  constructor(renderer, scene, containerRef) {\n    this.renderer = renderer;\n    this.scene = scene;\n\n    this.params = {\n      inspectMode: false,\n      opacity: 1.0,\n      selectedElementName: \"\",\n      showExteriorRoofs: true,\n      showExteriorWalls: true,\n      showExteriorFloors: true,\n      showExteriorWindows: true,\n      showInteriorWalls: true,\n      showGroundWalls: true,\n      showAdiabaticWalls: true,\n      showShades: true,\n      zClipping: false,\n      zClippingValue: 0.5,\n    };\n    this.lastSelected = null;\n\n    this.initPane(containerRef.current);\n    this.pane.hidden = false;\n  }\n\n  dispose() {\n    this.pane.dispose();\n  }\n\n  initPane(container) {\n    this.pane = new Pane({\n      title: \"Visor EnvolventeCTE\",\n      expanded: false,\n      container,\n    });\n\n    // Apartado de inspección\n    const folder = this.pane.addFolder({ title: \"Inspección de elementos\" });\n    // TODO: modo de renderizado (transmitancia, condiciones de contorno)\n    // folder.addInput(this, 'renderSelected', { label: 'render', options: this.renderOptions }).on('change', this.onRenderChange.bind(this));\n    folder.addInput(this.params, \"inspectMode\", {\n      label: \"Modo de inspección\",\n    });\n    folder\n      .addInput(this.params, \"selectedElementName\", {\n        label: \"Resalta elemento\",\n      })\n      .on(\"change\", this.onselectedElementChange.bind(this));\n\n    // Apartado de visualización\n    const folder2 = this.pane.addFolder({\n      title: \"Visualización\",\n    });\n\n    folder2\n      .addInput(this.params, \"opacity\", {\n        label: \"Opacidad\",\n        min: 0.0,\n        max: 1.0,\n        step: 0.1,\n      })\n      .on(\"change\", this.onOpacityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showExteriorRoofs\", {\n        label: \"Cubiertas exteriores\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showExteriorWalls\", {\n        label: \"Muros exteriores\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showExteriorFloors\", {\n        label: \"Suelos exteriores\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showExteriorWindows\", {\n        label: \"Huecos exteriores\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showInteriorWalls\", {\n        label: \"Elementos interiores\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showGroundWalls\", {\n        label: \"Elementos terreno\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showAdiabaticWalls\", {\n        label: \"Elementos Adiabáticos\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    folder2\n      .addInput(this.params, \"showShades\", {\n        label: \"Sombras\",\n      })\n      .on(\"change\", this.onVisibilityChange.bind(this));\n\n    // Apartado de clipping\n    const folder3 = this.pane.addFolder({\n      title: \"Sección por plano Z\",\n    });\n    folder3\n      .addInput(this.params, \"zClipping\", {\n        label: \"Cortar por plano Z\",\n      })\n      .on(\"change\", () => {\n        if (this.params.zClipping) {\n          // Se activa el corte por plano Z\n          this.renderer.clippingPlanes = [globalClippingPlane];\n\n          // Calcula valores extremos de Z (-Y en threejs) y fija max - 2 como punto de corte\n          const bbox = new Box3().setFromObject(\n            this.scene.getObjectByName(\"BuildingGroup\")\n          );\n          const zCut = Math.round(bbox.max.y) - 2;\n          this.params.zClippingValue = zCut;\n          globalClippingPlane.setComponents(0, -zCut, 0, 1);\n\n          // Genera slider para seleccionar altura de corte\n          this.clippingValueController = folder3\n            .addInput(this.params, \"zClippingValue\", {\n              label: \"Cota (Z) de corte\",\n              min: Math.round(bbox.min.y) - 1,\n              max: Math.round(bbox.max.y) + 1,\n              step: 0.25,\n            })\n            .on(\"change\", (event) => {\n              globalClippingPlane.setComponents(0, -event.value, 0, 1);\n            });\n        } else {\n          // Se desactiva el corte por plano Z\n          this.renderer.clippingPlanes = [];\n          this.clippingValueController.dispose();\n        }\n      });\n  }\n\n  toggle() {\n    if (!this.pane.hidden) {\n      this.pane.hidden = true;\n    } else {\n      this.pane.hidden = false;\n    }\n  }\n\n  onOpacityChange(event) {\n    const buildingObjects = this.scene.getObjectByName(\"BuildingGroup\");\n    buildingObjects.traverse((child) => {\n      if (child.material && child.userData.type !== \"Window\") {\n        child.material.opacity = event.value;\n      }\n    });\n  }\n\n  onselectedElementChange(event) {\n    // Limpia última selección\n    if (this.lastSelected) {\n      this.lastSelected.material = this.lastSelected.userData.oldMaterial;\n    }\n    // Selecciona nuevo elemento\n    const element = this.scene\n      .getObjectByName(\"BuildingGroup\")\n      .getObjectByName(event.value);\n    if (element) {\n      this.lastSelected = element;\n      this.lastSelected.userData.oldMaterial = element.material;\n      element.material = material_select;\n    }\n  }\n\n  onVisibilityChange(event) {\n    // \"showExteriorFloors\",\"showExteriorWindows\",\"showInteriorWalls\",\"showGroundWalls\",\"showAdiabaticWalls\",\"showShades\",\n    const key = event.presetKey;\n    let selector;\n    if (key === \"showExteriorRoofs\") {\n      selector = (bounds, type, subtype) =>\n        bounds === \"EXTERIOR\" && type === \"Wall\" && subtype === \"ROOF\";\n    } else if (key === \"showExteriorWalls\") {\n      selector = (bounds, type, subtype) =>\n        bounds === \"EXTERIOR\" && type === \"Wall\" && subtype === \"WALL\";\n    } else if (key === \"showExteriorFloors\") {\n      selector = (bounds, type, subtype) =>\n        bounds === \"EXTERIOR\" && type === \"Wall\" && subtype === \"FLOOR\";\n    } else if (key === \"showExteriorWindows\") {\n      selector = (bounds, type, _subtype) =>\n        bounds === \"EXTERIOR\" && type === \"Window\";\n    } else if (key === \"showInteriorWalls\") {\n      selector = (bounds, _type, _subtype) => bounds === \"INTERIOR\";\n    } else if (key === \"showGroundWalls\") {\n      selector = (bounds, _type, _subtype) => bounds === \"GROUND\";\n    } else if (key === \"showAdiabaticWalls\") {\n      selector = (bounds, _type, _subtype) => bounds === \"ADIABATIC\";\n    } else if (key === \"showShades\") {\n      selector = (_bounds, type, _subtype) => type === \"Shade\";\n    } else {\n      return;\n    }\n    const buildingObjects = this.scene.getObjectByName(\"BuildingGroup\");\n    buildingObjects.traverse((child) => {\n      const {\n        userData: { bounds, type, subtype },\n      } = child;\n      if (selector(bounds, type, subtype)) {\n        child.visible = event.value;\n      }\n    });\n  }\n}\n","import React, { useContext, useRef, useEffect } from \"react\";\nimport { observer } from \"mobx-react\";\nimport { autorun } from \"mobx\";\n\nimport * as THREE from \"three\";\nimport {\n  AmbientLight,\n  AxesHelper,\n  // CameraHelper,\n  DirectionalLight,\n  DirectionalLightHelper,\n  GridHelper,\n  Group,\n  Mesh,\n  PerspectiveCamera,\n  PlaneGeometry,\n  Raycaster,\n  Scene,\n  ShadowMaterial,\n  Shape,\n  ShapeGeometry,\n  Vector3,\n  WebGLRenderer,\n} from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\n\nimport { initObjectsFromModel } from \"./ctemodel.js\";\nimport GUIView from \"./gui/GUIView\";\nimport AppState from \"../../stores/AppState\";\n\nconst style = {\n  display: \"flex\",\n  flexFlow: \"row\",\n  height: \"75vh\",\n};\n\nconst ThreeView = () => {\n  const appstate = useContext(AppState);\n  // Referencia a nodo DOM en el que se monta el ThreeView\n  const domNodeRef = useRef(null);\n  // Referencia a nodo DOM del panel de control\n  const guiPaneRef = useRef(null);\n  // Referencia a Controles de cámara\n  const cameraControlRef = useRef();\n\n  const model = {\n    walls: appstate.walls,\n    windows: appstate.windows,\n    shades: appstate.shades,\n  };\n\n  // Inicializa ThreeJS\n  // Renderer\n  const renderer = new WebGLRenderer({\n    antialias: true,\n    alpha: true,\n  });\n  renderer.setPixelRatio(window.devicePixelRatio);\n  renderer.shadowMap.enabled = true;\n  renderer.physicallyCorrectLights = true;\n\n  // Cámara\n  const camera = new PerspectiveCamera(\n    50,\n    window.innerWidth / window.innerHeight,\n    0.1,\n    1000\n  );\n  camera.position.set(10, 30, 50);\n  camera.lookAt(new Vector3(0, 0, 0));\n  camera.up.set(0, 1, 0); // Tenemos \"arriba\" en +Y (valor por defecto)\n\n  // Escena\n  const scene = new Scene();\n\n  // Introduce suelo y luces\n  initGround(scene);\n  initLights(scene);\n\n  // Al renderizar por primera vez:\n  // - Monta control de cámara\n  // - Monta panel de control general\n  // - Configura visualización inicial (tamaño, aspect ratio, etc)\n  // - Añade elemento del DOM del renderer\n  // - Conecta eventos de teclado y mouse\n  // - Inicia bucle de animación\n  // - Devuelve destructor para ejecutar al desmontar el control\n  useEffect(() => {\n    const domNode = domNodeRef.current;\n\n    // Control de cámara\n    const cameraControl = new OrbitControls(camera, domNode);\n    cameraControl.enableDamping = true;\n    cameraControl.enabled = true;\n    cameraControl.update();\n    cameraControlRef.current = cameraControl;\n\n    // Inicializa cámara\n    camera.aspect = domNode.clientWidth / domNode.clientHeight;\n\n    // Panel de control\n    const gui = new GUIView(renderer, scene, guiPaneRef);\n\n    // Renderer\n    renderer.setSize(domNode.clientWidth, domNode.clientHeight, false);\n\n    // Monta elemento en el DOM\n    domNode.appendChild(renderer.domElement);\n\n    // Conecta eventos de mouse y teclado\n    domNode.addEventListener(\"keydown\", (e) =>\n      onKeyDown(e, gui, cameraControlRef)\n    );\n    domNode.addEventListener(\"pointerdown\", (e) =>\n      onPointerDown(e, domNodeRef, scene, camera, gui)\n    );\n\n    // Bucle de animación\n    const animate = () => {\n      if (cameraControl) cameraControl.update();\n      resizeToDisplaySize(renderer, camera);\n      renderer.render(scene, camera);\n      return window.requestAnimationFrame(animate);\n    };\n    const requestID = animate();\n\n    // Desmonta al eliminar el componente\n    return () => {\n      const cameraControl = cameraControlRef.current;\n      window.cancelAnimationFrame(requestID);\n      if (cameraControl) cameraControl.dispose();\n      if (gui) gui.dispose();\n      if (domNodeRef.current) {\n        domNodeRef.current.removeChild(renderer.domElement);\n      }\n    };\n  }, []);\n\n  // Actualización del modelo cuando este cambie\n  useEffect(\n    () =>\n      autorun(() => {\n        initObjectsFromModel(model, scene);\n        updateCameraAndLight(scene, camera, cameraControlRef.current);\n        updateGround(scene);\n      }),\n    [model, scene, camera]\n  );\n\n  return (\n    <div style={{ position: \"relative\" }}>\n      <div\n        style={{ position: \"absolute\", top: 0, left: 0, width: \"25%\" }}\n        ref={guiPaneRef}\n      />\n      {/* Tabindex es necesario para recibir eventos de teclado en un div */}\n      <div style={style} ref={domNodeRef} tabIndex={-1} />\n    </div>\n  );\n};\n\n// Materiales para símbolo de norte y plano del suelo\nconst northSymbolCircleMaterial = new THREE.MeshLambertMaterial({\n  color: 0x884444,\n  side: THREE.DoubleSide,\n  transparent: true,\n  opacity: 0.5,\n});\n\nconst northSymbolArrowMaterial = new THREE.MeshLambertMaterial({\n  color: 0x333333,\n  side: THREE.DoubleSide,\n});\n\nconst groundPlaneMaterial = new ShadowMaterial({\n  color: 0x6c6c6c,\n  opacity: 0.75,\n});\n\n// Crea símbolo de norte\nconst createNorthSymbol = (x, y) => {\n  const radius = 1;\n  const symbolGroup = new Group();\n  symbolGroup.name = \"NorthSymbol\";\n\n  const circle = new Mesh(\n    new THREE.CircleGeometry(radius, 64),\n    northSymbolCircleMaterial\n  );\n  symbolGroup.add(circle);\n\n  const arrowShape = new Shape();\n  arrowShape.moveTo(radius, 0);\n  arrowShape.lineTo(0, radius);\n  arrowShape.lineTo(-radius, 0);\n  arrowShape.closePath();\n\n  const arrow = new Mesh(\n    new ShapeGeometry(arrowShape),\n    northSymbolArrowMaterial\n  );\n  arrow.position.set(0, 0, 0.05);\n  symbolGroup.add(arrow);\n\n  symbolGroup.rotation.x = -Math.PI / 2;\n  symbolGroup.position.set(x - 1, 0, y + 1);\n\n  return symbolGroup;\n};\n\n// Genera elemento de suelo y rejilla\n//\n// ThreeJS: ejes X rojo, Y verde, Z azul\nconst initGround = (scene) => {\n  const groundGroup = new Group();\n  groundGroup.name = \"GroundGroup\";\n\n  // Suelo de soporte transparente\n  const ground = new Mesh(new PlaneGeometry(200, 200), groundPlaneMaterial);\n  ground.name = \"World_Ground\";\n  ground.rotation.x = -Math.PI / 2;\n  ground.position.y = -0.01;\n  ground.receiveShadow = true;\n  groundGroup.add(ground);\n\n  // Grid helper con 40 divisiones de 1m\n  const gridHelper = new GridHelper(40, 40, 0x0000ff, 0x808080);\n  gridHelper.name = \"GridHelper\";\n  gridHelper.position.set(0, 0, 0);\n  // @ts-ignore\n  gridHelper.material.setValues({ opacity: 0.25, transparent: true });\n  groundGroup.add(gridHelper);\n\n  // Axes helper\n  groundGroup.add(new AxesHelper(10)); // X rojo, Y verde, Z azul\n\n  // Símbolo de norte\n  groundGroup.add(createNorthSymbol(0, 0));\n\n  // Añade elementos a la escena\n  scene.add(groundGroup);\n};\n\n// Actualiza elemento de suelo en función del tamaño del modelo cargado\nconst updateGround = (scene) => {\n  const buildingGroup = scene.getObjectByName(\"BuildingGroup\");\n  const groundGroup = scene.getObjectByName(\"GroundGroup\");\n  const bbox = new THREE.Box3().setFromObject(buildingGroup);\n  const size = new THREE.Vector3();\n  const center = new THREE.Vector3();\n  bbox.getSize(size);\n  bbox.getCenter(center);\n  const maxSize = Math.max(size.x, size.z);\n\n  // Suelo de soporte transparente\n  const ground = new Mesh(\n    new PlaneGeometry(2.5 * size.x, 2.5 * size.z),\n    groundPlaneMaterial\n  );\n  ground.name = \"World_Ground\";\n  ground.rotation.x = -Math.PI / 2;\n  ground.position.y = -0.01;\n  ground.receiveShadow = true;\n\n  groundGroup.remove(scene.getObjectByName(\"World_Ground\"));\n  groundGroup.add(ground);\n\n  // Grid helper\n  const gridHelper = new GridHelper(\n    maxSize + 2,\n    maxSize + 2,\n    0x0000ff,\n    0x808080\n  );\n  gridHelper.name = \"GridHelper\";\n  gridHelper.position.set(Math.round(center.x), 0, Math.round(center.z));\n  // @ts-ignore\n  gridHelper.material.setValues({ opacity: 0.25, transparent: true });\n\n  groundGroup.remove(scene.getObjectByName(\"GridHelper\"));\n  groundGroup.add(gridHelper);\n\n  groundGroup.remove(scene.getObjectByName(\"NorthSymbol\"));\n  groundGroup.add(createNorthSymbol(bbox.min.x, bbox.max.z));\n};\n\n// Posición solar para un azimuth y altura solar dados\n// - azimuth (S=0, E=90, W=-90)\n// - altura solar (Horiz=0, vert=90), en grados\n// Usa una posición con distancia = 100m\n// Coordenadas altura solar es sistema levógiro y con Y=arriba, X=Este, Z=Sur\nconst sunPos = (azimuth, altitude, dist = 100) => {\n  const azim = (azimuth * Math.PI) / 180;\n  const alt = (altitude * Math.PI) / 180;\n  return new Vector3(\n    Math.cos(alt) * Math.sin(azim),\n    Math.sin(alt),\n    Math.cos(alt) * Math.cos(azim)\n  ).multiplyScalar(dist);\n};\n\nconst initLights = (scene) => {\n  const group = new Group();\n  group.name = \"LightsGroup\";\n\n  // Luz ambiente\n  const light_amb = new AmbientLight(0xffffff, 2.0);\n  light_amb.name = \"AmbientLight\";\n  group.add(light_amb);\n\n  // Luz direccional. Ajustamos el tamaño para que cubra la escena\n  // y ajustamos el punto de cálculo de sombras para evitar aliasing\n  const light = new DirectionalLight(0xffffff, 3.5);\n  light.name = \"Sun\";\n  light.shadow.normalBias = 0.05;\n  light.shadow.bias = -0.00025;\n  const d = 50;\n  light.shadow.camera.left = -d;\n  light.shadow.camera.right = d;\n  light.shadow.camera.top = d;\n  light.shadow.camera.bottom = -d;\n  light.shadow.camera.far = 300; // Default 2000\n  light.shadow.mapSize.width = 512 * 4; // Default 512\n  light.shadow.mapSize.height = 512 * 4;\n  light.position.copy(sunPos(19.5, 68.8));\n  light.castShadow = true;\n  group.add(light);\n  // Helpers for shadow camera and directional light\n  // scene.add(new CameraHelper(light.shadow.camera));\n  group.add(new DirectionalLightHelper(light, 1, \"red\"));\n\n  scene.add(group);\n};\n\n// Actualiza cámara para centrar en el edificio\n//\n// En gbxmlview puede haber una estrategia interesante para actualizar, usando:\n// - una esfera en lugar de una caja (para calcular más fácil la distancia):\n// - ajustando la escala de la luz direccional\n// - moviendo el punto al que mira la luz direccional (en el centro de la esfera)\n// https://github.com/ladybug-tools/spider-gbxml-tools/blob/7ade1e3bbdfa50f07ee35520d8d11e1bbc4e3757/spider-gbxml-viewer/v-0-17-07/core-thr-three/thru-threejs-utilities.js#L88\nconst updateCameraAndLight = (scene, camera, control) => {\n  const obj = scene.getObjectByName(\"BuildingGroup\");\n  const bbox = new THREE.Box3().setFromObject(obj);\n  const size = bbox.getSize(new THREE.Vector3());\n  const center = bbox.getCenter(new THREE.Vector3());\n  const maxSize = Math.max(size.x, size.z);\n\n  // Mira hacia el edificio\n  const target = new Vector3(0, 0, 0);\n  if (obj) {\n    new THREE.Box3().setFromObject(obj).getCenter(target);\n  }\n  camera.lookAt(target);\n\n  // Ajusta distancia para ajustarse a la pantalla\n  const fitOffset = 1.2;\n  const fitHeightDistance =\n    maxSize / (2 * Math.atan((Math.PI * camera.fov) / 360));\n  const fitWidthDistance = fitHeightDistance / camera.aspect;\n  const distance = fitOffset * Math.max(fitHeightDistance, fitWidthDistance);\n\n  const direction = control.target\n    .clone()\n    .sub(camera.position)\n    .normalize()\n    .multiplyScalar(distance);\n  control.maxDistance = distance * 10;\n  control.target.copy(center);\n\n  camera.near = distance / 100;\n  camera.far = distance * 100;\n  camera.updateProjectionMatrix();\n\n  // Copia la posición del control\n  camera.position.copy(control.target).sub(direction);\n\n  // Actualiza cámara y control\n  control.update();\n\n  // Coloca luces desde el centro del edificio\n  const lights = scene.getObjectByName(\"LightsGroup\");\n  lights.position.x = center.x / 2;\n  lights.position.y = center.y / 2;\n  lights.position.z = center.z / 2;\n};\n\nconst resizeToDisplaySize = (renderer, camera) => {\n  const canvas = renderer.domElement;\n  const width = canvas.clientWidth;\n  const height = canvas.clientHeight;\n  if (canvas.width !== width || canvas.height !== height) {\n    renderer.setSize(width, height, false);\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n  }\n};\n\n// Gestiona entradas de teclado:\n// CTRL + ALT + g / p - oculta panel\n// CTRL + ALT + h - resitúa cámara en su posición original\n// CTRL + ALT + i - Activa / desactiva modo de inspección de objetos\n// Para poder conectar este manejador en un elemento div es necesario fijar la\n// propiedad tabIndex=-1 (para que el elemento se sitúe fuera del flujo de foco de entrada)\n// Ver https://webaim.org/techniques/keyboard/tabindex\nconst onKeyDown = (e, guiView, cameraControlRef) => {\n  // CTRL + ALT + g || CTRL + ALT + p\n  if (e.ctrlKey && e.altKey && (e.code === \"KeyG\" || e.code === \"KeyP\")) {\n    if (guiView) guiView.toggle();\n  }\n  // CTRL + ALT + h\n  if (e.ctrlKey && e.altKey && e.code === \"KeyH\") {\n    const cameraControl = cameraControlRef.current;\n    if (cameraControl) cameraControl.reset();\n  }\n  // CTRL + ALT + i\n  if (e.ctrlKey && e.altKey && e.code === \"KeyI\") {\n    if (guiView) {\n      guiView.params.inspectMode = !guiView.params.inspectMode;\n      guiView.pane.refresh();\n    }\n  }\n};\n\n// Muestra, en modo de inspección, una lista con los objetos bajo la localización del puntero\nconst onPointerDown = (e, domNodeRef, scene, camera, guiView) => {\n  const domNode = domNodeRef.current;\n  if (!guiView?.params?.inspectMode || !domNode) return;\n\n  // Rectángulo del elemento\n  const rect = domNode.getBoundingClientRect();\n  // Coordenadas dentro del elemento X: [0, rect.width], Y: [0, rect.height]\n  const xCoord = e.clientX - rect.left;\n  const yCoord = e.clientY - rect.top;\n  // Coordenadas X: [-1, 1], Y: [-1, 1]\n  const posX = (xCoord / rect.width) * 2 - 1;\n  const posY = -(yCoord / rect.height) * 2 + 1;\n  // Genera intersecciones, obteniendo lista de objetos de más próximo a más lejano\n  const pointer3D = new Vector3(posX, posY, 0.5);\n  const raycaster = new Raycaster();\n  raycaster.setFromCamera(pointer3D, camera);\n  const intersects = raycaster.intersectObjects(\n    scene.getObjectByName(\"BuildingGroup\").children\n  );\n\n  // Actualiza elemento de la interfaz\n  const el = getTextElement(document);\n  if (intersects.length > 0) {\n    const objectNames = intersects.map((v) => v.object.name);\n    setTextData(guiView, el, e.clientX, e.clientY, objectNames);\n  } else {\n    setTextData(guiView, el, e.clientX, e.clientY, []);\n  }\n};\n\n// Genera lista de elementos bajo el puntero y traslada a panel\nconst setTextData = (gui, el, x, y, data) => {\n  el.innerHTML = \"\";\n  if (data.length) {\n    // const ul = document.createElement(\"ul\");\n    for (let name of data) {\n      const li = document.createElement(\"li\");\n      li.style.listStyle = \"none\";\n      li.style.padding = \"3px 5px 3px 15px\";\n      li.innerHTML = name;\n      li.onmouseover = (e) => {\n        e.stopPropagation();\n        const selected = e.target;\n        // @ts-ignore\n        selected.style.background = \"#D4A017\";\n        // @ts-ignore\n        gui.onselectedElementChange({ value: selected.textContent });\n      };\n      li.onmouseleave = (e) => {\n        // @ts-ignore\n        e.target.style.background = \"none\";\n        gui.onselectedElementChange({\n          value: gui.params.selectedElementName,\n        });\n      };\n      li.onpointerdown = (e) => {\n        e.stopPropagation();\n        let selectedElement = \"\";\n        // Solo seleccionamos con pulsación del botón izquierdo\n        if (e.buttons === 1) {\n          // @ts-ignore\n          selectedElement = e.target.textContent;\n        }\n        gui.params.selectedElementName = selectedElement;\n        gui.pane.refresh();\n      };\n      el.appendChild(li);\n    }\n  }\n  el.style.left = x + \"px\";\n  el.style.top = y + \"px\";\n};\n\n// Devuelve o genera el elemento de texto en la interfaz\nfunction getTextElement(document) {\n  const el = document.getElementById(\"inspect_dom_element\");\n  if (el) {\n    return el;\n  }\n  const ll = document.createElement(\"ul\");\n  ll.id = \"inspect_dom_element\";\n  ll.style.margin = \"0\";\n  ll.style.padding = \"0\";\n  ll.style.position = \"absolute\";\n  ll.style.color = \"black\";\n  ll.style.background = \"#ffffffAA\";\n  ll.style.font = \"13px Arial, Verdana, sans-serif\";\n  ll.style.zIndex = \"100\";\n  ll.style.display = \"block\";\n  document.body.appendChild(ll);\n  return ll;\n}\n\nexport default observer(ThreeView);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\n\nimport ThreeView from \"./ThreeView\";\nimport { PageWithIndicators } from \"../ui/PageWithIndicators\";\n\nconst ThreeDPage = ({ route }) => {\n  return (\n    <PageWithIndicators route={route}>\n      <Row>\n        <Col>\n          <ThreeView />\n        </Col>\n      </Row>\n    </PageWithIndicators>\n  );\n};\n\nexport default ThreeDPage;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2018-2021 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n */\n\n/* *** Biblioteca de propiedades de los elementos de la envolvente térmica *** */\n\n// Propiedades de los vidrios\n\n// Propiedades tomadas de UNE EN 13363-Apéndice A\n// con añadidos calculados según https://www.onyxsolar.com/es/termica\n\nexport const ELEMENTOS = {\n  huecos: {\n    acristalamientos: {\n      tipos: [\n        // EN 13363-1 Anexo A - tabla A.1\n        { name: \"Vidrio sencillo\", g_gl_n: 0.85, U_gl: 5.7 },\n        { name: \"Vidrio doble\", g_gl_n: 0.75, U_gl: 3.0 },\n        { name: \"Vidrio doble bajoemisivo\", g_gl_n: 0.67, U_gl: 1.6 },\n        { name: \"Triple vidrio\", g_gl_n: 0.7, U_gl: 2.0 },\n        {\n          name: \"Triple vidrio con dos capas de bajoemisivo\",\n          g_gl_n: 0.5,\n          U_gl: 1.25,\n        },\n        { name: \"Doble ventana (vidrio sencillo)\", g_gl_n: 0.75, U_gl: 3.2 },\n      ],\n      propiedades: {\n        F_w: 0.9,\n      },\n    },\n    sombreamientos: {\n      tipos: [\n        { name: \"Ninguno\", type: \"NONE\" },\n        { name: \"Exterior\", type: \"EXT\" },\n        { name: \"Integrado\", type: \"MED\" },\n        { name: \"Interior\", type: \"INT\" },\n      ],\n      propiedades: {\n        transmitancia: [\n          // EN 13363-1 Anexo A - tabla A.2\n          { opacidad: \"Opaco\", tau_e_B: 0.0 },\n          { opacidad: \"Medianamente translúcido\", tau_e_B: 0.2 },\n          { opacidad: \"Muy translúcido\", tau_e_B: 0.4 },\n        ],\n        reflexion: [\n          // EN 13363-1 Anexo A - tabla A.2\n          { color: \"blanco\", opacidad: \"Opaco\", tau_e_B: 0.0, rho_e_B: 0.7 },\n          {\n            color: \"blanco\",\n            opacidad: \"Medianamente translúcido\",\n            tau_e_B: 0.2,\n            rho_e_B: 0.6,\n          },\n          {\n            color: \"blanco\",\n            opacidad: \"Muy translúcido\",\n            tau_e_B: 0.4,\n            rho_e_B: 0.4,\n          },\n          { color: \"pastel\", opacidad: \"Opaco\", tau_e_B: 0.0, rho_e_B: 0.5 },\n          {\n            color: \"pastel\",\n            opacidad: \"Medianamente translúcido\",\n            tau_e_B: 0.2,\n            rho_e_B: 0.4,\n          },\n          {\n            color: \"pastel\",\n            opacidad: \"Muy translúcido\",\n            tau_e_B: 0.4,\n            rho_e_B: 0.3,\n          },\n          { color: \"oscuro\", opacidad: \"Opaco\", tau_e_B: 0.0, rho_e_B: 0.3 },\n          {\n            color: \"oscuro\",\n            opacidad: \"Medianamente translúcido\",\n            tau_e_B: 0.2,\n            rho_e_B: 0.2,\n          },\n          {\n            color: \"oscuro\",\n            opacidad: \"Muy translúcido\",\n            tau_e_B: 0.4,\n            rho_e_B: 0.2,\n          },\n          { color: \"negro\", opacidad: \"Opaco\", tau_e_B: 0.0, rho_e_B: 0.1 },\n          {\n            color: \"negro\",\n            opacidad: \"Medianamente translúcido\",\n            tau_e_B: 0.2,\n            rho_e_B: 0.1,\n          },\n          {\n            color: \"negro\",\n            opacidad: \"Muy translúcido\",\n            tau_e_B: 0.4,\n            rho_e_B: 0.1,\n          },\n        ],\n      },\n    },\n  },\n};\n\n// Factor de transmitancia de energía solar total - g_t\n// con protección solar exterior - g_t_e\n// con protección solar integrada - g_t_m\n// con protección solar interior - g_t_i\n// Parámetros:\n// - U_gl: coeficiente de transmitancia de la energía solar total del acristalamiento [W/m2K]\n// - g_gl_n: factor de transmitancia de energía solar a incidencia normal del acristalamiento [-]\n// - tau_e_B: factor de transmitancia solar del dispositivo de protección solar [-]\n// - rho_e_B: factor de reflexión solar de la cara del dispositivo de protección solar del lado de la radiación [-]\n\n// Factor de transmitancia de energía solar total con protección solar exterior\nexport function g_t_e(U_gl, g_gl_n, tau_e_B, rho_e_B) {\n  const alpha_e_B = 1 - tau_e_B - rho_e_B;\n  const G = 1 / (1 / U_gl + 1 / 5 + 1 / 10); // W/m2K\n  return (\n    tau_e_B * g_gl_n + (alpha_e_B * G) / 10 + (tau_e_B * (1 - g_gl_n) * G) / 5\n  );\n}\n\n// Factor de transmitancia de energía solar total con protección solar interior\nexport function g_t_i(U_gl, g_gl_n, tau_e_B, rho_e_B) {\n  const alpha_e_B = 1 - tau_e_B - rho_e_B;\n  const G = 1 / (1 / U_gl + 1 / 30); // W/m2K\n  return g_gl_n * (1 - g_gl_n * rho_e_B - (alpha_e_B * G) / 30);\n}\n\n// Factor de transmitancia de energía solar total con protección solar integrado\n// Válido cuando:\n// - El acristalamiento exterior no está recubierto\n// - El acristalamiento interior está o no recubierto\nexport function g_t_m(U_gl, g_gl_n, tau_e_B, rho_e_B) {\n  const alpha_e_B = 1 - tau_e_B - rho_e_B;\n  const G = 1 / (1 / U_gl + 1 / 3); // W/m2K\n  return (\n    tau_e_B * g_gl_n + (g_gl_n * (alpha_e_B + (1 - g_gl_n) * rho_e_B) * G) / 3\n  );\n}\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n// Propiedades de los huecos a partir de la definición del tipo de vidrio y protecciones solares móviles\n// Cálculo de los factores multiplicadores del factor solar para HULC y otros procedimientos\n\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport { Col, Form, Card, Row } from \"react-bootstrap\";\n\nimport { ELEMENTOS, g_t_e, g_t_i, g_t_m } from \"./elements\";\n\nconst ACRISTALAMIENTOS = ELEMENTOS.huecos.acristalamientos;\nconst SOMBREAMIENTOS = ELEMENTOS.huecos.sombreamientos;\nconst TIPOSVIDRIO = ACRISTALAMIENTOS.tipos.map((v) => v.name);\nconst TIPOSSOMBRA = SOMBREAMIENTOS.tipos.map((v) => v.name);\n\nexport const HuecosParams = (_props) => {\n  const [tipovidrio, setTipovidrio] = useState(TIPOSVIDRIO[0]);\n  const [tiposombra, setTiposombra] = useState(TIPOSSOMBRA[0]);\n  const [tau_e_B, setTau_e_B] = useState(1);\n  const [rho_e_B, setRho_e_B] = useState(0);\n\n  // funciones para dar a los componentes hijos, con declaración de dependencias\n  const wrapperSetTau_e_B = useCallback(\n    (val) => {\n      setTau_e_B(val);\n    },\n    [setTau_e_B]\n  );\n  const wrapperSetRho_e_B = useCallback(\n    (val) => {\n      setRho_e_B(val);\n    },\n    [setRho_e_B]\n  );\n\n  const vidrio = ACRISTALAMIENTOS.tipos.find((v) => v.name === tipovidrio);\n  const F_w = ACRISTALAMIENTOS.propiedades.F_w;\n\n  const g_gl_wi = F_w * vidrio.g_gl_n || 0.0;\n  let g_gl_sh_wi;\n  if (tiposombra === \"Exterior\") {\n    g_gl_sh_wi = g_t_e(vidrio.U_gl, vidrio.g_gl_n, tau_e_B, rho_e_B);\n  } else if (tiposombra === \"Interior\") {\n    g_gl_sh_wi = g_t_i(vidrio.U_gl, vidrio.g_gl_n, tau_e_B, rho_e_B);\n  } else if (tiposombra === \"Integrado\") {\n    g_gl_sh_wi = g_t_m(vidrio.U_gl, vidrio.g_gl_n, tau_e_B, rho_e_B);\n  } else {\n    g_gl_sh_wi = g_gl_wi;\n  }\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <p className=\"lead\">\n            Propiedades térmicas de los huecos según UNE-EN ISO 52022-1:2017\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"well\">\n        <Col>\n          <Form>\n            <Form.Group as={Row} controlId=\"formControlsGlassType\">\n              <Col as={Form.Label} md={4}>\n                Tipo de vidrio:\n              </Col>{\" \"}\n              <Col md={8}>\n                <Form.Control\n                  value={tipovidrio}\n                  size=\"sm\"\n                  onChange={(e) => setTipovidrio(e.target.value)}\n                  as=\"select\"\n                  placeholder=\"select\"\n                >\n                  {TIPOSVIDRIO.map((v) => (\n                    <option value={v} key={\"tipovidrio_\" + v.replace(\" \", \"_\")}>\n                      {v}\n                    </option>\n                  ))}\n                </Form.Control>\n              </Col>\n            </Form.Group>\n            <Form.Group as={Row} controlId=\"formControlsHasShading\">\n              <Col as={Form.Label} md={4}>\n                Dispositivo de protección solar móvil:\n              </Col>{\" \"}\n              <Col md={8}>\n                <Form.Control\n                  value={tiposombra}\n                  size=\"sm\"\n                  onChange={(e) => setTiposombra(e.target.value)}\n                  as=\"select\"\n                  placeholder=\"select\"\n                >\n                  {TIPOSSOMBRA.map((v) => (\n                    <option value={v} key={\"tiposombra_\" + v}>\n                      {v}\n                    </option>\n                  ))}\n                </Form.Control>\n              </Col>\n            </Form.Group>\n            {tiposombra === \"Ninguno\" ? null : (\n              <SombrasForm\n                tau_e_B={tau_e_B}\n                rho_e_B={rho_e_B}\n                setTau_e_B={wrapperSetTau_e_B}\n                setRho_e_B={wrapperSetRho_e_B}\n              />\n            )}\n          </Form>\n        </Col>\n      </Row>\n      <Row className=\"mt-2\">\n        <Col>\n          <GlazingPropertiesCard\n            {...{\n              vidrio,\n              F_w,\n              tiposombra,\n              tau_e_B,\n              rho_e_B,\n              g_gl_wi,\n              g_gl_sh_wi,\n            }}\n          />\n        </Col>\n      </Row>\n      <Row className=\"mt-2\">\n        <Col>\n          <FactorsCard\n            {...{\n              vidrio,\n              tiposombra,\n              g_gl_wi,\n              g_gl_sh_wi,\n            }}\n          />\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nconst OPACIDAD = ELEMENTOS.huecos.sombreamientos.propiedades.transmitancia;\nconst REFLEXION = ELEMENTOS.huecos.sombreamientos.propiedades.reflexion;\n\n// Obtén tau y rho a partir de opacidad y color\nconst findTauRho = (opacidad, color) => {\n  const tau_e_B = OPACIDAD.find((v) => v.opacidad === opacidad).tau_e_B;\n  const rho_e_B = REFLEXION.find(\n    (v) => v.color === color && v.opacidad === opacidad\n  ).rho_e_B;\n  return [tau_e_B, rho_e_B];\n};\n\nconst SombrasForm = ({ tau_e_B, setTau_e_B, rho_e_B, setRho_e_B }) => {\n  const [opacidad, setOpacidad] = useState(OPACIDAD[0].opacidad);\n  const [color, setColor] = useState(REFLEXION[0].color);\n\n  // Actualiza el componente madre como efecto de cambiar color y opacidad\n  useEffect(() => {\n    const [tau_e_B, rho_e_B] = findTauRho(opacidad, color);\n    setTau_e_B(tau_e_B);\n    setRho_e_B(rho_e_B);\n  }, [setTau_e_B, setRho_e_B, opacidad, color]);\n\n  return (\n    <>\n      <Form.Group as={Row} controlId=\"formControlsShadingTransparency\">\n        <Form.Label column md={4}>\n          Opacidad del dispositivo de sombra móvil:\n        </Form.Label>{\" \"}\n        <Col md={6}>\n          <Form.Control\n            value={opacidad}\n            size=\"sm\"\n            onChange={(e) => {\n              setOpacidad(e.target.value);\n            }}\n            as=\"select\"\n            placeholder=\"select\"\n          >\n            {OPACIDAD.map((v) => (\n              <option\n                value={v.opacidad}\n                key={\"opacidad_\" + v.opacidad.replace(\" \", \"_\")}\n              >\n                {v.opacidad}\n              </option>\n            ))}\n          </Form.Control>\n        </Col>\n        <Form.Label column md={1}>\n          &tau;<sub>e,B</sub>:\n        </Form.Label>\n        <Col md={1}>\n          <Form.Control\n            readOnly\n            type=\"text\"\n            size=\"sm\"\n            value={tau_e_B.toFixed(2)}\n            md={1}\n          />\n        </Col>\n      </Form.Group>\n      <Form.Group as={Row} controlId=\"formControlsShadingColor\">\n        <Form.Label column md={4}>\n          Color del dispositivo de sombra móvil:\n        </Form.Label>{\" \"}\n        <Col md={6}>\n          <Form.Control\n            value={color}\n            size=\"sm\"\n            onChange={(e) => {\n              setColor(e.target.value);\n            }}\n            as=\"select\"\n            placeholder=\"select\"\n          >\n            {REFLEXION.filter((v) => v.opacidad === opacidad).map((v) => (\n              <option value={v.color} key={\"color_\" + v.color}>\n                {v.color}\n              </option>\n            ))}\n          </Form.Control>\n        </Col>\n        <Form.Label column md={1}>\n          &rho;<sub>e,B</sub>:\n        </Form.Label>\n        <Col md={1}>\n          <Form.Control\n            readOnly\n            type=\"text\"\n            size=\"sm\"\n            value={rho_e_B.toFixed(2)}\n            md={1}\n          />\n        </Col>\n      </Form.Group>\n    </>\n  );\n};\n\nconst GlazingPropertiesCard = ({\n  vidrio,\n  F_w,\n  tiposombra,\n  tau_e_B,\n  rho_e_B,\n  g_gl_wi,\n  g_gl_sh_wi,\n}) => {\n  return (\n    <Card>\n      <Card.Header>\n        Propiedades del acristalamiento ({vidrio.name.toLowerCase()},{\" \"}\n        {tiposombra === \"Ninguno\"\n          ? \"sin sombreamiento\"\n          : `sombreamiento ${tiposombra.toLowerCase()}`}\n        )\n      </Card.Header>\n      <Card.Body>\n        <Card.Text>\n          Transmitancia térmica del vidrio,{\" \"}\n          <b>\n            U<sub>gl</sub>\n          </b>{\" \"}\n          = {vidrio.U_gl.toFixed(2)}\n        </Card.Text>\n        <Card.Text>\n          Factor de transmitancia de energía solar del vidrio a incidencia\n          normal,{\" \"}\n          <b>\n            g<sub>gl;n</sub>\n          </b>{\" \"}\n          = {vidrio.g_gl_n.toFixed(2)}\n        </Card.Text>\n        <Card.Text>\n          Factor de dispersión del vidrio,{\" \"}\n          <b>\n            F<sub>w</sub>\n          </b>{\" \"}\n          = {F_w.toFixed(2)}\n        </Card.Text>\n        <Card.Text>\n          Factor de transmitancia de energía solar del vidrio, <b>sin</b> las\n          sombras solares móviles en uso normal,{\" \"}\n          <b>\n            g<sub>gl;wi</sub>\n          </b>{\" \"}\n          = F<sub>w</sub> · g<sub>gl;n</sub> = {g_gl_wi.toFixed(2)}\n        </Card.Text>\n        <Card.Text>\n          Factor de transmitancia de energía solar del vidrio, <b>con</b> las\n          sombras solares móviles en uso normal,{\" \"}\n          <b>\n            g<sub>gl;sh;wi</sub>\n          </b>{\" \"}\n          = {g_gl_sh_wi.toFixed(2)}\n        </Card.Text>\n        {tiposombra === \"Ninguno\" ? null : (\n          <Card.Text>\n            Factor de transmitancia solar del dispositivo de sombra móvil, &tau;\n            <sub>e,B</sub>: {tau_e_B.toFixed(2)}\n          </Card.Text>\n        )}\n        {tiposombra === \"Ninguno\" ? null : (\n          <Card.Text>\n            Factor de reflexión solar del dispositivo de sombra móvil, &rho;\n            <sub>e,B</sub>: {rho_e_B.toFixed(2)}\n          </Card.Text>\n        )}\n      </Card.Body>\n    </Card>\n  );\n};\n\nconst FactorsCard = ({ vidrio, tiposombra, g_gl_wi, g_gl_sh_wi }) => {\n  let [fshwithsummer, setFshwithSummer] = useState(\"1\");\n  let [fshwithwinter, setFshwithWinter] = useState(\"1\");\n  let [buildingUseCoef, setBuildingUseCoef] = useState(0.7);\n\n  let f_sh_with_summer = Number(fshwithsummer.replace(\",\", \".\")).toFixed(2);\n  let f_sh_with_winter = Number(fshwithwinter.replace(\",\", \".\")).toFixed(2);\n\n  let g_gl_sh_wi_on =\n    (1.0 - f_sh_with_summer) * g_gl_wi + f_sh_with_summer * g_gl_sh_wi;\n\n  let g_gl_sh_wi_off =\n    (1.0 - f_sh_with_winter) * g_gl_wi + f_sh_with_winter * g_gl_sh_wi;\n\n  let g_gl_wi_ref_on = g_gl_wi * buildingUseCoef;\n  let g_gl_wi_ref_off = g_gl_wi;\n\n  return (\n    <Card>\n      <Card.Header>\n        Coeficiente de corrección por dispositivo de sombra estacional (\n        {vidrio.name.toLowerCase()},{\" \"}\n        {tiposombra === \"Ninguno\"\n          ? \"sin sombreamiento\"\n          : `sombreamiento ${tiposombra.toLowerCase()}`}\n        ),{\" \"}\n        <b>\n          F<sub>g;estacional</sub>\n        </b>\n      </Card.Header>\n      <Card.Body>\n        <Form>\n          <Form.Group as={Row} controlId=\"formControlsBuildingUse\">\n            <Form.Label column md={6}>\n              Uso del edificio:\n            </Form.Label>{\" \"}\n            <Col md={2}>\n              <Form.Control\n                as=\"select\"\n                size=\"sm\"\n                defaultValue={buildingUseCoef}\n                onChange={(e) => {\n                  setBuildingUseCoef(e.target.value);\n                }}\n              >\n                <option value={0.7}>Residencial privado</option>\n                <option value={1.0}>Otros usos</option>\n              </Form.Control>\n            </Col>\n            <Col>\n              <i>Residencial privado, k=0.7, resto k=1.0</i>\n            </Col>\n          </Form.Group>\n          <Form.Group as={Row} controlId=\"formControlsFshwithSummer\">\n            <Form.Label column md={6}>\n              Factor de reducción por sombras móviles medio <b>durante</b> el\n              periodo / meses de activación, f<sub>sh;with;on</sub>:\n            </Form.Label>{\" \"}\n            <Col md={2}>\n              <Form.Control\n                type=\"input\"\n                size=\"sm\"\n                value={fshwithsummer}\n                onChange={(e) => {\n                  setFshwithSummer(e.target.value);\n                }}\n                placeholder=\"1.0\"\n                step=\"0.01\"\n              />\n            </Col>\n            <Col>\n              <i>Tiempo de activación respecto al tiempo total con radiación</i>\n            </Col>\n          </Form.Group>\n          <Form.Group as={Row} controlId=\"formControlsFshwithSummer\">\n            <Form.Label column md={6}>\n              Factor de reducción por sombras móviles medio <b>fuera</b> del\n              periodo / meses de activación, f<sub>sh;with;off</sub>:\n            </Form.Label>{\" \"}\n            <Col md={2}>\n              <Form.Control\n                type=\"input\"\n                size=\"sm\"\n                value={fshwithwinter}\n                onChange={(e) => {\n                  setFshwithWinter(e.target.value);\n                }}\n                placeholder=\"1.0\"\n                step=\"0.01\"\n              />\n            </Col>\n            <Col>\n              <i>Tiempo de activación respecto al tiempo total con radiación</i>\n            </Col>\n          </Form.Group>\n        </Form>\n\n        <hr />\n\n        <h5>\n          Periodo / meses <b>CON</b> activación de las protecciones solares\n          móviles\n        </h5>\n\n        <p>\n          Factor de transmitancia de energía solar del vidrio, g\n          <sub>gl;sh;wi;on</sub> = (1.0 - f<sub>sh;with;on</sub>) · g<sub>gl;wi</sub> + f<sub>sh;with;on</sub> · g<sub>gl;sh;wi</sub> = {g_gl_sh_wi_on.toFixed(2)}\n        </p>\n        <p>\n          Valor de referencia<sup>*</sup>, g<sub>sh;wi;ref;on</sub> = g\n          <sub>gl;wi</sub> · {Number(buildingUseCoef).toFixed(2)} ={\" \"}\n          {g_gl_wi_ref_on.toFixed(2)}\n        </p>\n        <p>\n          <b>Coeficiente de corrección</b> del factor solar,{\" \"}\n          <b>\n            F<sub>g;on</sub>\n          </b>{\" \"}\n          = g<sub>gl;sh;wi;on</sub> / g<sub>sh;wi;ref;on</sub> ={\" \"}\n          <b>{(g_gl_sh_wi_on / g_gl_wi_ref_on).toFixed(2)}</b>\n        </p>\n\n        <hr />\n\n        <h5>\n          Periodo / meses <b>SIN</b> activación de las protecciones solares\n          móviles\n        </h5>\n        <p>\n          Factor de transmitancia de energía solar del vidrio, g\n          <sub>gl;sh;wi;off</sub> = (1.0 - f<sub>sh;with;off</sub>) · g<sub>gl;wi</sub> + f<sub>sh;with;off</sub> · g<sub>gl;sh;wi</sub> = {g_gl_sh_wi_off.toFixed(2)}\n        </p>\n        <p>\n          Valor de referencia, g<sub>sh;wi;ref;off</sub> = g<sub>gl;wi</sub> ={\" \"}\n          {g_gl_wi_ref_off.toFixed(2)}\n        </p>\n        <p>\n          <b>Coeficiente de corrección</b> del factor solar,{\" \"}\n          <b>\n            F<sub>g;off</sub>\n          </b>{\" \"}\n          = g<sub>gl;sh;wi;off</sub> / g<sub>sh;wi;ref;off</sub> ={\" \"}\n          <b>{(g_gl_sh_wi_off / g_gl_wi_ref_off).toFixed(2)}</b>\n        </p>\n\n        <hr />\n\n        <div className=\"text-muted my-3\">\n          <b>NOTAS</b>:\n          <ul>\n            <li>\n              Para el periodo de no activación puede ser más adecuado usar un\n              factor F<sub>g;off</sub>=1.0\n            </li>\n            <li>\n              Los valores de los factores de reducción medios para los periodos\n              de activación y no activación pueden obtenerse en el apartado de\n              &quot;Ayudas &gt; Factores de reducción por sombras&quot; en las\n              columnas correspondientes a los meses correspondientes\n              (inicialmente JUN-SET para el periodo de activación y el resto de\n              meses para el de no activación).\n            </li>\n            <li>\n              Debe tenerse en cuenta que el periodo / meses de activación o no\n              activación de las sombras estacionales podría tener umbrales de\n              radiación diferenciados entre periodos.\n            </li>\n            <li>\n              Estos factores correctores del factor solar se usarían en los\n              distintos procedimientos de evaluación de la eficiencia energética\n              para afectar al factor solar estacional de referencia (g\n              <sub>gl;sh;wi;ref</sub>), calculado automáticamente por el\n              procedimiento, para obtener el factor solar estacional deseado (g\n              <sub>gl;sh;wi</sub>).\n            </li>\n            <li>\n              <sup>*</sup> El valor de referencia (g<sub>sh;wi;ref;on</sub>) se\n              corresponde aproximadamente a la que resultaría de un dispositivo\n              de sombra móvil en el interior del acristalamiento, muy traslúcido\n              y de color blanco (&tau;<sub>e,B</sub>=0.40, &rho;<sub>e,B</sub>\n              =0.40).\n            </li>\n            <li>\n              Esta ayuda utiliza las condiciones de referencia del apartado 6.5\n              del Documento Reconocido de{\" \"}\n              <a href=\"https://energia.gob.es/es-es/Participacion/Documents/propuesta-doc-reconocido-condiciones-tecnicas/Condiciones-tecnicas-evaluacion-eficiencia-energetica.pdf\">\n                Condiciones técnicas para la evaluación de la eficiencia\n                energética de edificios\n              </a>\n              .\n            </li>\n          </ul>\n        </div>\n      </Card.Body>\n    </Card>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState } from \"react\";\nimport { Col, Form, Row } from \"react-bootstrap\";\n\nimport { OrientaIcon } from \"./IconsOrientaciones\";\n\nconst MESES = \"ENE,FEB,MAR,ABR,MAY,JUN,JUL,AGO,SET,OCT,NOV,DIC\".split(\",\");\n\n// Tabla de irradiación mensual acumulada para distintas superficies orientadas e inclinadas\nconst MonthlyRadiationTable = ({ data, climatezone }) => {\n  const [showDetail, setShowDetail] = useState(false);\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <p className=\"lead\">\n            Radiación solar acumulada mensual sobre planos inclinados y\n            orientados, según UNE-EN ISO 52010-1:2017\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"mb-3\">\n        <Col>\n          <Form>\n            <Form.Check\n              checked={showDetail}\n              onChange={(_e) => setShowDetail(!showDetail)}\n              label=\"¿Mostrar detalle de irradiación directa y difusa?\"\n            />\n          </Form>\n        </Col>\n      </Row>\n      <Row>\n        <h4>\n          Irradiación solar,{\" \"}\n          <i>\n            H<sub>sol;m</sub>\n          </i>{\" \"}\n          (kWh/m²/mes), Zona climática {climatezone}\n        </h4>\n      </Row>\n      <Row>\n        <Col>\n          <table\n            id=\"radiationtable\"\n            className=\"table table-striped table-bordered table-condensed table-hover\"\n          >\n            <thead className=\"text-light bg-secondary\">\n              <tr style={{ borderBottom: \"3px solid darkgray\" }}>\n                <th className=\"col-md-1\">Superficie</th>\n                <th className=\"col-md-1\">Irradiación</th>\n                {MESES.map((m) => (\n                  <th key={m}>{m}</th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {data.map((d, idx) => {\n                return (\n                  <React.Fragment key={idx}>\n                    <tr\n                      key={\"tot_\" + d.orientation}\n                      style={\n                        showDetail\n                          ? {\n                              fontWeight: \"bold\",\n                              borderTop: \"3px solid darkgray\",\n                            }\n                          : null\n                      }\n                    >\n                      <td rowSpan={showDetail ? \"3\" : null}>\n                        <b className=\"pull-left\">{d.orientation}</b>{\" \"}\n                        <OrientaIcon dir={d.orientation} />\n                      </td>\n                      <td>Dir. + Dif.</td>\n                      {d.dir.map((v, i) => (\n                        <td\n                          key={\"tot_\" + i}\n                          style={{\n                            borderRight:\n                              i == 6 || i == 5 ? \"2px solid darkgray\" : null,\n                            backgroundColor:\n                              i == 6 ? \"rgba(100, 0, 0, 0.05)\" : null,\n                          }}\n                        >\n                          {(v + d.dif[i]).toFixed(2)}\n                        </td>\n                      ))}\n                    </tr>\n                    {showDetail ? (\n                      <tr key={\"dir_\" + d.orientation}>\n                        <td>Dir.</td>\n                        {d.dir.map((v, i) => (\n                          <td key={\"dir_\" + i}>{v.toFixed(2)}</td>\n                        ))}\n                      </tr>\n                    ) : null}\n                    {showDetail ? (\n                      <tr key={\"dif_\" + d.orientation}>\n                        <td>Dif.</td>\n                        {d.dif.map((v, i) => (\n                          <td key={\"dif_\" + i}>{v.toFixed(2)}</td>\n                        ))}\n                      </tr>\n                    ) : null}\n                  </React.Fragment>\n                );\n              })}\n            </tbody>\n          </table>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <p className=\"text-info\">\n            La tabla anterior recoge la radiación mensual acumulada para una\n            superficie horizontal y superficies verticales con la orientación\n            indicada.\n          </p>\n          <p className=\"text-info\">\n            El parámetro de control solar (\n            <b>\n              q<sub>sol;jul</sub>\n            </b>\n            ) utiliza los valores de irradiación solar acumulada corespondientes\n            al mes de julio.\n          </p>\n        </Col>\n      </Row>\n    </Col>\n  );\n};\n\nexport default MonthlyRadiationTable;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\n\n// Optimizador en https://jakearchibald.github.io/svgomg/\nconst FshwithSprite = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" display=\"none\">\n    <defs>\n      <g id=\"hueco\" opacity=\".8\">\n        <rect\n          id=\"marcoext\"\n          height=\"98\"\n          stroke=\"#000\"\n          strokeWidth=\"1\"\n          fill=\"#fff\"\n          width=\"74\"\n          y=\".5\"\n          x=\".5\"\n        />\n        <rect\n          id=\"marcoint\"\n          height=\"84\"\n          stroke=\"#000\"\n          strokeWidth=\"1\"\n          fill=\"#5c555d\"\n          width=\"59\"\n          y=\"7.5\"\n          x=\"7.5\"\n        />\n        <path\n          id=\"personaje\"\n          d=\"m12 92c0.0033-6.5 1-15 4.4-19 2.7-4 9.3-10 15-10-2.6-1.4-4.3-7.8-4.2-14-0.32-5.5 1.5-14 11-14 8.7 0.022 9.8 8.8 9.5 14 0.24 5.8-2.9 12-5.1 13 8.1 1 13 7.9 15 12 2.5 5.7 4 12 3.8 19\"\n          fillRule=\"evenodd\"\n          fill=\"#ccc\"\n        />\n      </g>\n      <rect\n        id=\"cortina\"\n        height=\"21\"\n        stroke=\"#000\"\n        fill=\"#f2f2f2\"\n        width=\"59\"\n        opacity=\".8\"\n        y=\"7.5\"\n        x=\"7.5\"\n      />\n      <symbol id=\"ventana1\" viewBox=\"0 0 75 100\">\n        <use xlinkHref=\"#hueco\" />\n      </symbol>\n      <symbol id=\"ventana2\" viewBox=\"0 0 75 100\">\n        <use xlinkHref=\"#hueco\" />\n        <use xlinkHref=\"#cortina\" />\n      </symbol>\n      <symbol id=\"ventana3\" viewBox=\"0 0 75 100\">\n        <use xlinkHref=\"#hueco\" />\n        <use xlinkHref=\"#cortina\" />\n        <use xlinkHref=\"#cortina\" y=\"21\" />\n      </symbol>\n      <symbol id=\"ventana4\" viewBox=\"0 0 75 100\">\n        <use xlinkHref=\"#hueco\" />\n        <use xlinkHref=\"#cortina\" />\n        <use xlinkHref=\"#cortina\" y=\"21\" />\n        <use xlinkHref=\"#cortina\" y=\"42\" />\n      </symbol>\n      <symbol id=\"ventana5\" viewBox=\"0 0 75 100\">\n        <use xlinkHref=\"#hueco\" />\n        <use xlinkHref=\"#cortina\" />\n        <use xlinkHref=\"#cortina\" y=\"21\" />\n        <use xlinkHref=\"#cortina\" y=\"42\" />\n        <use xlinkHref=\"#cortina\" y=\"63\" />\n      </symbol>\n    </defs>\n  </svg>\n);\n\nconst FshwithIcon = ({ fsh, width = \"1.2em\", height = \"1.6em\" }) => {\n  let name;\n  if (fsh < 0.2) {\n    name = \"ventana1\";\n  } else if (fsh < 0.4) {\n    name = \"ventana2\";\n  } else if (fsh < 0.6) {\n    name = \"ventana3\";\n  } else if (fsh < 0.8) {\n    name = \"ventana4\";\n  } else {\n    name = \"ventana5\";\n  }\n  return (\n    <svg width={width} height={height} style={{ verticalAlign: \"middle\" }}>\n      <use xlinkHref={`#${name}`} />\n    </svg>\n  );\n};\n\nexport { FshwithSprite, FshwithIcon };\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useState } from \"react\";\nimport { Col, Form, Row } from \"react-bootstrap\";\n\nimport { OrientaIcon } from \"./IconsOrientaciones\";\nimport { FshwithIcon } from \"./IconsFshwith\";\n\nconst LEVELS = [\n  {\n    value: \"f_shwith200\",\n    label:\n      \"200 W/m² - dispositivos de sombra con control y accionamiento automático\",\n  },\n  {\n    value: \"f_shwith300\",\n    label:\n      \"300 W/m² - dispositivos de sombra con accionamiento y control manual\",\n  },\n  {\n    value: \"f_shwith500\",\n    label:\n      \"500 W/m² - dispositivos de sombra en modo de calefacción (evita cargas extremas)\",\n  },\n];\nconst MESES = \"ENE,FEB,MAR,ABR,MAY,JUN,JUL,AGO,SET,OCT,NOV,DIC\".split(\",\");\nconst DAYS = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n\nconst selectedMonths = (start, end) => {\n  const startIdx = MESES.indexOf(start);\n  const endIdx = MESES.indexOf(end);\n  // console.log(MESES.slice(startIdx, endIdx + 1));\n  return [startIdx, endIdx];\n};\n\n// Tabla de factores de reducción para dispositivos solares móviles\n//\n// Para usar los iconos, OrientacionesSprite y FshwithSprite deben estar instanciados en la página\n// en la que se incruste la tabla.\n// import { OrientacionesSprite } from \"./IconsOrientaciones\"; -> <OrientacionesSprite/>\n// import { FshwithSprite } from \"./IconsFshwith\"; -> <FshwithSprite/>\nconst ShadingFactorsTable = ({ data, climatezone }) => {\n  const [showlevel, setShowlevel] = useState(\"300\");\n  const [startMonth, setStartMonth] = useState(\"JUN\");\n  const [endMonth, setEndMonth] = useState(\"SET\");\n  const [selStart, selEnd] = selectedMonths(startMonth, endMonth);\n\n  const meanSummerVals = data.map((d) => {\n    const vals = d[`f_shwith${showlevel}`].slice(selStart, selEnd + 1);\n    const days = DAYS.slice(selStart, selEnd + 1);\n    return (\n      vals\n        .map((val, idx) => [val, days[idx]])\n        .map(([val, days]) => val * days)\n        .reduce((sum, x) => sum + x) / days.reduce((sum, x) => sum + x)\n    );\n  });\n\n  const meanWinterVals = data.map((d) => {\n    const vals = d[`f_shwith${showlevel}`]\n      .slice(0, selStart)\n      .concat(d[`f_shwith${showlevel}`].slice(selEnd + 1));\n    const days = DAYS.slice(0, selStart).concat(DAYS.slice(selEnd + 1));\n    return (\n      vals\n        .map((val, idx) => [val, days[idx]])\n        .map(([val, days]) => val * days)\n        .reduce((sum, x) => sum + x) / days.reduce((sum, x) => sum + x)\n    );\n  });\n\n  return (\n    <Col>\n      <Row>\n        <Col>\n          <p className=\"lead\">\n            Factores mensuales y estacionales de reducción de la radiación solar\n            debida a protecciones solares móviles asociadas al hueco, según\n            UNE-EN ISO 52016-1:2017.\n          </p>\n        </Col>\n      </Row>\n      <Form>\n        <Form.Group as={Row} controlId=\"formControlsIrradiationLevel\">\n          <Form.Label column md={6}>\n            Nivel de irradiación sobre el hueco para la activación del\n            sombreamiento móvil (W/m²):\n          </Form.Label>\n          <Col>\n            <Form.Control\n              value={`f_shwith${showlevel}`}\n              onChange={(e) => setShowlevel(e.target.value.slice(-3))}\n              as=\"select\"\n              placeholder=\"select\"\n            >\n              {LEVELS.map(({ value, label }) => (\n                <option value={value} key={value}>\n                  {label}\n                </option>\n              ))}\n            </Form.Control>\n          </Col>\n        </Form.Group>\n      </Form>\n      <Form className=\"form-inline mb-3\">\n        <Row>\n          <Col md={6}>\n            <p>Activación de elementos de sombra estacionales:</p>\n          </Col>\n          <Form.Group as={Col} controlId=\"formControlsStartSummerMonths\">\n            <Form.Label column>Mes de inicio:</Form.Label>\n            <Form.Control\n              value={startMonth}\n              onChange={(e) => setStartMonth(e.target.value)}\n              as=\"select\"\n              placeholder=\"select\"\n            >\n              {MESES.map((z) => (\n                <option value={z} key={\"start_month_\" + z}>\n                  {z}\n                </option>\n              ))}\n            </Form.Control>\n          </Form.Group>\n          <Form.Group as={Col} controlId=\"formControlsEndSummerMonths\">\n            <Form.Label column>Mes de finalización:</Form.Label>\n            <Form.Control\n              value={endMonth}\n              onChange={(e) => setEndMonth(e.target.value)}\n              as=\"select\"\n              placeholder=\"select\"\n            >\n              {MESES.map((z) => (\n                <option value={z} key={\"end_month_\" + z}>\n                  {z}\n                </option>\n              ))}\n            </Form.Control>\n          </Form.Group>\n        </Row>\n      </Form>\n      <Row>\n        <h4>\n          Factores de reducción por sombras móviles, f<sub>sh;with</sub>, zona\n          climática {climatezone}\n        </h4>\n      </Row>\n      <Row>\n        <Col>\n          <table\n            id=\"shadingfactorstable\"\n            className=\"table table-striped table-bordered table-condensed table-hover\"\n          >\n            <thead className=\"text-light bg-secondary\">\n              <tr style={{ borderBottom: \"3px solid darkgray\" }}>\n                <th className=\"col-md-1\">Superficie</th>\n                <th>\n                  f<sub>sh;with</sub>\n                </th>\n                {MESES.map((m) => (\n                  <th key={m}>{m}</th>\n                ))}\n                <th style={{ background: \"gray\" }}>\n                  f<sub>sh;with;on</sub>\n                  <br />({MESES[selStart] + \"-\" + MESES[selEnd]})\n                </th>\n                <th style={{ background: \"gray\" }}>\n                  f<sub>sh;with;off</sub>\n                  <br />({MESES[0] + \"-\" + MESES[selStart - 1]}\n                  <br />\n                  {MESES[selEnd + 1] + \"-\" + MESES[MESES.length - 1]})\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              {data.map((d, surfidx) => {\n                const level = showlevel;\n                return (\n                  <tr key={\"f_shwith200_\" + d.orientation}>\n                    <td>\n                      <b className=\"pull-left\">{d.orientation}</b>{\" \"}\n                      <OrientaIcon dir={d.orientation} />\n                    </td>\n                    <td style={{ textAlign: \"center\" }}>I &gt; {level}</td>\n                    {d[`f_shwith${level}`].map((v, i) => (\n                      <td\n                        key={`fshwith${level}_${i}`}\n                        style={{\n                          backgroundColor:\n                            i >= selStart && i <= selEnd\n                              ? \"rgba(100, 0, 0, 0.05)\"\n                              : null,\n                          borderRight:\n                            i == selStart - 1 || i == selEnd || i == 11\n                              ? \"2px solid darkgray\"\n                              : null,\n                        }}\n                      >\n                        {v.toFixed(2)} <FshwithIcon fsh={v} />\n                      </td>\n                    ))}\n                    <td\n                      key={`fshwith_mean_${surfidx}`}\n                      style={{\n                        textAlign: \"center\",\n                        fontWeight: \"bold\",\n                        backgroundColor: \"rgba(100, 0, 0, 0.05)\",\n                        borderRight: \"2px solid darkgray\",\n                      }}\n                    >\n                      {meanSummerVals[surfidx].toFixed(2)}{\" \"}\n                      <FshwithIcon fsh={meanSummerVals[surfidx]} />\n                    </td>\n                    <td\n                      key={`fshwith_winter_mean_${surfidx}`}\n                      style={{\n                        textAlign: \"center\",\n                        fontWeight: \"bold\",\n                      }}\n                    >\n                      {meanWinterVals[surfidx].toFixed(2)}{\" \"}\n                      <FshwithIcon fsh={meanWinterVals[surfidx]} />\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <hr />\n          <div className=\"text-muted my-3\">\n            <p>NOTAS:</p>\n            <ul>\n              <li>\n                La tabla anterior recoge la fracción del tiempo (mensual) que el\n                dispositivo de sombra móvil está conectado (se supera el nivel\n                de irradiación indicado) en relación al tiempo total con\n                radiación solar disponible.\n              </li>\n              <li>\n                Estos valores pueden resultar útiles para obtener el factor\n                solar del hueco considerando los dispositivos de sombra móviles\n                (\n                <i>\n                  g<sub>gl;sh;wi</sub>\n                </i>\n                ). Para obtener valores estacionales se pueden promediar los\n                valores mensuales correspondientes a la estación (p.e. verano e\n                invierno). Véase la ayuda de <i>Huecos</i>.\n              </li>\n              <li>\n                Se puede considerar que el dispositivo está conectado cuando la\n                radiación (total) incidente supera el valor indicado (\n                <i>\n                  I &gt; 200 W/m<sup>2</sup>\n                </i>\n                ,{\" \"}\n                <i>\n                  I &gt; 300 W/m<sup>2</sup>\n                </i>\n                ,{\" \"}\n                <i>\n                  I &gt; 500 W/m<sup>2</sup>\n                </i>\n                ) y desconectado cuando se encuentra por debajo de ese valor. Es\n                decir, un valor de{\" \"}\n                <i>\n                  f<sub>sh;with</sub> = 1\n                </i>{\" \"}\n                significa que el dispositivo de sombra móvil está completamente\n                conectado o activado (p.e. un toldo extendido o una persiana\n                bajada) y un valor de{\" \"}\n                <i>\n                  f<sub>sh;with</sub> = 0\n                </i>{\" \"}\n                significa que el dispositivo de sombra móvil está completamente\n                desconectado o desactivado (p.e. un toldo recogido o una\n                persiana subida).\n              </li>\n              <li>\n                Debe tenerse en cuenta que los valores de la tabla se han\n                obtenido sin considerar el efecto de los obstáculos remotos\n                sobre el hueco. Dicha obstrucción se tiene en cuenta a través\n                del factor de obstrucción de obstáculos remotos{\" \"}\n                <b>\n                  F<sub>sh;obst</sub>\n                </b>\n                .\n              </li>\n              <li>\n                La tabla superior recoge los supestos del{\" \"}\n                <a href=\"https://www.codigotecnico.org/pdf/Documentos/HE/DA_DB-HE-1_Calculo_de_parametros_caracteristicos_de_la_envolvente.pdf\">\n                  Documento de Apoyo al Documento Básico DB-HE Ahorro de energía\n                  (DA DB-HE/1)\n                </a>\n              </li>\n            </ul>\n          </div>\n        </Col>\n      </Row>\n    </Col>\n  );\n};\n\nexport default ShadingFactorsTable;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n// TODO: incluir opciones de espacios bajo cubierta\n// Cubiertas con valores por defecto y considerando angulo 45º, n=3:\n// U_cub = 10.0 -> R_u = 0,06\n// U_cub = 5.0  -> R_u = 0,10\n// U_cub = 1.7 - 2  -> R_u = 0,20\n// U_cub = 0.6  -> R_u = 0,30\n// U_cub = 0.0  -> R_u = 0,40\n\nimport React, { useState } from \"react\";\nimport { Col, Form, Card, Row } from \"react-bootstrap\";\n\nexport const BoundaryWallResistance = (_props) => {\n  const [supInt, setSupInt] = useState(10.0);\n  const [supExt, setSupExt] = useState(20.0);\n  const [uExt, setUExt] = useState(2.0);\n  const [n, setN] = useState(3.0);\n  const [volume, setVolume] = useState(30.0);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <p className=\"lead\">\n            Resistencia térmica equivalente de espacios no calefactados\n            (acondicionados) según UNE-EN ISO 6946:2021\n          </p>\n          <p className=\"small\">\n            Cálculo de la resistencia térmica adicional para modelizar el efecto\n            de espacios no acondicionados que comunican con el ambiente\n            exterior. Facilita la modelización de medianeras a espacios no\n            habitables o no acondicionados o a espacios bajocubierta no\n            habitables, evitando la introducción de la geometría completa de\n            estos espacios.\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"well\">\n        <Col>\n          <Form>\n            <Form.Group as={Row} controlId=\"formControlsInternalArea\">\n              <Col as={Form.Label} md={2} className=\"text-end\">\n                A<sub>i</sub>:\n              </Col>\n              <Col md={1}>\n                <Form.Control\n                  type=\"number\"\n                  size=\"sm\"\n                  value={supInt}\n                  onChange={(e) =>\n                    setSupInt(Number(e.target.value.replace(\",\", \".\")))\n                  }\n                  placeholder=\"10.0\"\n                />\n              </Col>\n              <Col md={1}>m²</Col>\n              <Col className=\"text-muted small\">\n                Superficie de separación con el espacio no acondicionado.\n              </Col>\n            </Form.Group>\n\n            <Form.Group as={Row} controlId=\"formControlsExternalArea\">\n              <Col as={Form.Label} md={2} className=\"text-end\">\n                V:\n              </Col>{\" \"}\n              <Col md={1}>\n                <Form.Control\n                  type=\"number\"\n                  size=\"sm\"\n                  value={volume}\n                  onChange={(e) =>\n                    setVolume(Number(e.target.value.replace(\",\", \".\")))\n                  }\n                  placeholder=\"30.0\"\n                />\n              </Col>\n              <Col md={1}>m³</Col>\n              <Col className=\"text-muted small\">\n                Volumen del espacio no calefactado.\n              </Col>\n            </Form.Group>\n\n            <Form.Group as={Row} controlId=\"formControlsExternalArea\">\n              <Col as={Form.Label} md={2} className=\"text-end\">\n                A<sub>e</sub> = &sum;A<sub>e,k</sub>:\n              </Col>{\" \"}\n              <Col md={1}>\n                <Form.Control\n                  type=\"number\"\n                  size=\"sm\"\n                  value={supExt}\n                  onChange={(e) =>\n                    setSupExt(Number(e.target.value.replace(\",\", \".\")))\n                  }\n                  placeholder=\"20.0\"\n                />\n              </Col>\n              <Col md={1}>m²</Col>\n              <Col className=\"text-muted small\">\n                Superficies de separación entre el espacio no acondicionado y el\n                exterior.\n              </Col>\n            </Form.Group>\n\n            <Form.Group as={Row} controlId=\"formControlsExternalArea\">\n              <Col as={Form.Label} md={2} className=\"text-end\">\n                U<sub>e,m</sub> = &sum;(A<sub>e,k</sub>·U<sub>e,k</sub>)/A\n                <sub>e</sub>:\n              </Col>{\" \"}\n              <Col md={1}>\n                <Form.Control\n                  type=\"number\"\n                  size=\"sm\"\n                  value={uExt}\n                  onChange={(e) =>\n                    setUExt(Number(e.target.value.replace(\",\", \".\")))\n                  }\n                  placeholder=\"2.0\"\n                />\n              </Col>\n              <Col md={1}>W/(m²·K)</Col>\n              <Col className=\"text-muted small\">\n                Transmitancia térmica media de las superficies de separación\n                entre el espacio no acondicionado y el exterior.\n                <br />A falta de datos o de forma simplificada puede suponerse U\n                <sub>e,k</sub>=2 W/(m²·K)\n              </Col>\n            </Form.Group>\n\n            <Form.Group as={Row} controlId=\"formControlsVentilation\">\n              <Col as={Form.Label} md={2} className=\"text-end\">\n                n:\n              </Col>{\" \"}\n              <Col md={1}>\n                <Form.Control\n                  type=\"number\"\n                  size=\"sm\"\n                  value={n}\n                  onChange={(e) =>\n                    setN(Number(e.target.value.replace(\",\", \".\")))\n                  }\n                  placeholder=\"3.0\"\n                />\n              </Col>\n              <Col md={1}>ren/h</Col>\n              <Col className=\"text-muted small\">\n                Tasa de ventilación del espacio no calefactado en ren/h.\n                <br />A falta de datos o de forma simplificada puede suponerse\n                n=3 ren/h\n              </Col>\n            </Form.Group>\n          </Form>\n        </Col>\n      </Row>\n      <Row className=\"mt-4\">\n        <Col className=\"text-center\">\n          <Card>\n            <Card.Body>\n              R<sub>u</sub> ={\" \"}\n              {(supInt / (supExt * uExt + 0.33 * n * volume)).toFixed(2)} m²·K/W\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n    </>\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Tabs, Tab } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport { Page } from \"../ui/Page\";\nimport { HuecosParams } from \"./WindowProperties\";\nimport MonthlyRadiationTable from \"./MonthlyRadiationTable\";\nimport ShadingFactorsTable from \"./ShadingFactorsTable\";\nimport { OrientacionesSprite } from \"./IconsOrientaciones\";\nimport { FshwithSprite } from \"./IconsFshwith\";\nimport {BoundaryWallResistance} from \"./BoundaryWall\";\n\nconst HelpersPage = observer(({ route, activeKey, setActiveKey }) => {\n  const appstate = useContext(AppState);\n  return (\n    <Page route={route}>\n      <OrientacionesSprite />\n      <FshwithSprite />\n      <Row>\n        <Col>\n          <Tabs activeKey={activeKey} onSelect={setActiveKey} id=\"helpers_tab\">\n            <Tab eventKey=\"winproperties\" title=\"Medianeras\" className=\"pt-3\">\n              <BoundaryWallResistance />\n            </Tab>\n            <Tab eventKey=\"boundarywallresistance\" title=\"Huecos\" className=\"pt-3\">\n              <HuecosParams />\n            </Tab>\n            <Tab\n              eventKey=\"radiation\"\n              title=\"Radiación acumulada\"\n              className=\"pt-3\"\n            >\n              <MonthlyRadiationTable\n                data={appstate.climatedata}\n                climatezone={appstate.meta.climate}\n              />\n            </Tab>\n            <Tab\n              eventKey=\"fshwith\"\n              title=\"Factores de reducción por sombras\"\n              className=\"pt-3\"\n            >\n              <ShadingFactorsTable\n                data={appstate.climatedata}\n                climatezone={appstate.meta.climate}\n              />\n            </Tab>\n          </Tabs>\n        </Col>\n      </Row>\n    </Page>\n  );\n});\n\nexport default HelpersPage;\n","export default __webpack_public_path__ + \"static/media/5R1C.a7eec38e.svg\";","export default __webpack_public_path__ + \"static/media/orientaciones.321f841a.svg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Button, Col, Row, Image, Tabs, Tab } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\n\nimport { Page } from \"../ui/Page\";\n\nimport esquema5R1C from \"../img/5R1C.svg\";\nimport orientaciones from \"../img/orientaciones.svg\";\n\nconst HelpPage = () => (\n  <Page>\n    <Row>\n      <Col>\n        <h1>EnvolventeCTE</h1>\n        <p>\n          <i>EnvolventeCTE</i> es una aplicación web de ayuda al cálculo de\n          indicadores de calidad y parámetros descriptivos de la envolvente\n          térmica de los edificios para la evaluación energética y facilitar la\n          aplicación del CTE DB-HE (2019).\n        </p>\n        <p>Los indicadores y parámetros implementados son:</p>\n        <ul>\n          <li>\n            <b>Transmitancia térmica global</b> (<b>K</b>)\n          </li>\n          <li>\n            <b>Control solar</b> (\n            <b>\n              q<sub>sol;jul</sub>\n            </b>\n            )\n          </li>\n          <li>\n            <b>Relación de cambio de aire a 50Pa</b> (\n            <b>\n              n<sub>50</sub>\n            </b>\n            )\n          </li>\n          <li>\n            <b>Área útil</b> a efectos del cálculo de indicadores energéticos (A\n            <sub>útil</sub>), <b>compacidad</b> (V/A) , <b>volumen</b> bruto (V)\n            , volumen neto (V<sub>int</sub>), ...\n          </li>\n          <li>\n            <b>\n              Parámetros descriptivos de los elementos de la envolvente térmica\n            </b>{\" \"}\n            (<b>U</b>, <b>g</b>, <b>&psi;</b>...)\n          </li>\n        </ul>\n        <p>\n          Los distintos apartados del programa permiten introducir y editar los\n          componentes de la envolvente térmica del edificio, sus construcciones\n          y materiales y los datos generales del proyecto (zona climática y\n          otros), pudiendo visualizar una imagen 3D del modelo y obtener\n          informes sobre el comportamiento energético y de las mediciones del\n          modelo.\n        </p>\n        <p>\n          Esta información puede también importarse desde otros programas,\n          permitiendo en la actualidad archivos <b>.ctehexml</b> de la\n          Herramienta Unificada LIDER-CALENER (HULC) o archivos <b>.json</b>{\" \"}\n          propios.\n        </p>\n        <p>\n          Además, el apartado de <Link to=\"/helpers\">Ayudas</Link> proporciona\n          utilidades para el cálculo de parámetros descriptivos de algunos\n          elementos de la envolvente térmica a partir de sus características.\n        </p>\n        <p>Los campos pueden ser editados haciendo doble click sobre ellos.</p>\n      </Col>\n    </Row>\n    <Row>\n      <Col>\n        <Tabs>\n          <Tab eventKey={1} title=\"Proyecto\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>Datos generales de proyecto</h4>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <p>\n                  Este apartado recoge datos y metadatos generales del proyecto.\n                </p>\n              </Col>\n            </Row>\n          </Tab>\n          <Tab eventKey={2} title=\"Elementos\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>Espacios y superficies</h4>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <p>\n                  Este apartado recoge la definición geométrica y constructiva\n                  de los espacios y elementos (opacos, huecos, puentes térmicos\n                  y elementos de sombra) que configuran el modelo.\n                </p>\n              </Col>\n            </Row>\n          </Tab>\n          <Tab eventKey={3} title=\"Construcción\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>Construcciones y materiales</h4>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <p>\n                  Este apartado recoge los tipos de construcciones de huecos y\n                  opacos, así como materiales, vidrios y tipos de marco usados\n                  en el modelo.\n                </p>\n              </Col>\n            </Row>\n          </Tab>\n          <Tab eventKey={4} title=\"Uso\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>Uso</h4>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <p>\n                  Este apartado recoge los perfiles de uso, consignas y horarios\n                  definidos en el modelo.\n                </p>\n              </Col>\n            </Row>\n          </Tab>\n          <Tab eventKey={5} title=\"Vista3D\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>Visualización 3D</h4>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <p>\n                  Este apartado muestra una imagen tridimensional e interactiva\n                  del modelo.\n                </p>\n                <p>\n                  Permite explorar, activar, desactivar y cambiar el modo de\n                  visualización de las distintas superficies.\n                </p>\n              </Col>\n            </Row>\n          </Tab>\n          <Tab eventKey={6} title=\"Informes\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>HE1 - Indicadores de calidad de la envolvente térmica</h4>\n              </Col>\n            </Row>\n            <Row>\n              <Col md={8}>\n                <p>\n                  Este apartado muestra un informe de indicadores y parámetros\n                  de caracterización de la envolvente térmica (transmitancia\n                  térmica global, control solar, permeabilidad al aire).\n                </p>\n                <p>\n                  Los indicadores de calidad en la envolvente térmica se basan\n                  en los definidos en el CTE HE 2019 y basados en otros\n                  descritos en la UNE EN ISO 52016‐1.\n                </p>\n              </Col>\n              <Col md={4}>\n                <Image fluid alt=\"Esquema 5R1C EN 13790\" src={esquema5R1C} />\n              </Col>\n            </Row>\n          </Tab>\n          <Tab eventKey={7} title=\"Ayudas\" className=\"pt-3\">\n            <Row>\n              <Col>\n                <h4>Medianeras</h4>\n\n                <p>\n                  Este apartado permite el cálculo de las resistencias térmicas\n                  adicionales equivalentes a espacios no calefactados de acuerdo\n                  a la UNE-EN ISO 6946:2001.\n                </p>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <h4>Huecos</h4>\n\n                <p>\n                  Este apartado permite el cálculo de las propiedades térmicas\n                  de huecos y parámetros de funcionamiento para el cálculo\n                  energético de acuerdo a la UNE-EN ISO 52022-1:2017.\n                </p>\n                <p>\n                  Por ejemplo, se puede obtener: la\n                  <i>transmitancia térmica</i> (U<sub>H</sub>), el{\" \"}\n                  <i>factor solar del vidrio a incidencia normal</i> (g\n                  <sub>gl;n</sub>), el <i>factor solar del hueco</i> (g\n                  <sub>gl;wi</sub>), el{\" \"}\n                  <i>\n                    factor solar del hueco teniendo en cuenta los sombreamientos\n                    solares móviles\n                  </i>\n                  (g<sub>gl;sh;wi</sub>) o los coeficientes de corrección por\n                  dispositivo de sombra estacional.\n                </p>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <h4>Parámetros climáticos</h4>\n                <p>\n                  En la sección de <i>Parámetros</i> se recogen aquellos\n                  parámetros de la envolvente térmica relacionados con el clima\n                  exterior.\n                </p>\n                <p>\n                  La aplicación calcula, para superficies inclinadas y\n                  orientadas, los valores de:\n                </p>\n                <ul>\n                  <li>\n                    <b>\n                      Irradiación acumulada mensual (\n                      <i>\n                        H<sub>sol;m</sub>\n                      </i>\n                      )\n                    </b>\n                  </li>\n                  <li>\n                    <b>\n                      factor de reducción para sombreamientos solares móviles (\n                      <i>\n                        f<sub>sh;with</sub>\n                      </i>\n                      )\n                    </b>{\" \"}\n                    de superficies inclinadas y orientadas.\n                  </li>\n                </ul>\n                <p>\n                  Los cálculos para las distintas orientaciones y climas usan\n                  valores obtenidos a partir de los archivos climáticos de\n                  referencia del <i>CTE DB-HE</i> y el procedimiento de la norma{\" \"}\n                  <i>UNE-EN ISO 52010‐1:2017</i>.\n                </p>\n                <p>\n                  <Button\n                    variant=\"info\"\n                    size=\"xsmall\"\n                    href=\"http://www.codigotecnico.org/images/stories/pdf/ahorroEnergia/CTEdatosMET_20140418.zip\"\n                    target=\"_blank\"\n                  >\n                    Descargar climas de referencia de codigotecnico.org{\" \"}\n                  </Button>\n                  .\n                </p>\n              </Col>\n            </Row>\n            <Row>\n              <Col>\n                <h4>Orientaciones de los elementos de la envolvente</h4>\n                <Col md={{ span: 8, offset: 2 }}>\n                  <Image\n                    fluid\n                    alt=\"Roseta de orientaciones de superficies\"\n                    src={orientaciones}\n                  />\n                </Col>\n              </Col>\n            </Row>\n          </Tab>\n        </Tabs>\n      </Col>\n    </Row>\n  </Page>\n);\n\nexport default HelpPage;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport { APP_VERSION } from \"../../version.js\";\nimport React from \"react\";\nimport { Alert, Col, Image, Row } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\n\nimport { Page } from \"../ui/Page.js\";\nimport imglogo from \"../img/logo.svg\";\n\nconst MainPage = () => {\n  return (\n    <Page>\n      <Row>\n        <Col md={3} className=\"text-center\">\n          <Image src={imglogo} width=\"90%\" />\n          <Alert variant=\"warning\">\n            <b>NOTA:</b> Esta aplicación y la información contenida en ella{\" \"}\n            <b>no tienen valor reglamentario</b>.\n          </Alert>\n        </Col>\n        <Col md={9}>\n          <Row>\n            <Col>\n              <h1>\n                EnvolventeCTE <small>(v.{APP_VERSION})</small>\n              </h1>\n              <p>\n                Aplicación para el cálculo de indicadores de calidad y\n                parámetros descriptivos de la envolvente térmica de los\n                edificios para la evaluación energética y aplicación del CTE\n                DB-HE (2019):\n              </p>\n              <ul>\n                <li>\n                  <b>transmitancia térmica global</b> (<b>K</b>)\n                </li>\n                <li>\n                  <b>tasa de renovación de aire a 50 Pa</b> (\n                  <b>\n                    n<sub>50</sub>\n                  </b>\n                  ) y valor de referencia (n<sub>50,ref</sub>)\n                </li>\n                <li>\n                  <b>parámetro de control solar</b> (\n                  <b>\n                    q<sub>sol;jul</sub>\n                  </b>\n                  )\n                </li>\n                <li>\n                  área útil a efectos del cálculo de indicadores energéticos (A\n                  <sub>util</sub>), compacidad (<b>V/A</b>) , volumen bruto (\n                  <b>V</b>) , volumen neto (\n                  <b>\n                    V<sub>int</sub>\n                  </b>\n                  ), ...\n                </li>\n              </ul>\n\n              <p>Los distintos apartados del programa permiten:</p>\n              <ul>\n                <li>\n                  <Link to=\"/project\">Proyecto</Link>: cargar datos, visualizar\n                  y editar los datos generales del modelo.\n                </li>\n                <li>\n                  <Link to=\"/elements\">Elementos</Link>: visualizar, introducir,\n                  editar los espacios y superficies del edificio y su envolvente\n                  térmica.\n                </li>\n                <li>\n                  <Link to=\"/constructions\">Construcción</Link>: visualizar,\n                  introducir, editar los materiales y construcciones usados en\n                  el modelo.\n                </li>\n                <li>\n                  <Link to=\"/uses\">Usos</Link>: visualizar, introducir, editar\n                  las cargas y condiciones operacionales de los espacios del\n                  modelo.\n                </li>\n                <li>\n                  <Link to=\"/3d\">Vista3D</Link>: explorar visualmente el modelo.\n                </li>\n                <li>\n                  <Link to=\"/reports\">Informes</Link>: mostrar una evaluación de\n                  los indicadores de eficiencia energética del modelo o sus\n                  mediciones.\n                </li>\n                <li>\n                  <Link to=\"/helpers\">Ayudas</Link>: herramientas para el\n                  cálculo de parámetros descriptivos de algunos elementos de la\n                  envolvente térmica y visualización de datos climáticos.\n                </li>\n              </ul>\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n    </Page>\n  );\n};\n\nexport default MainPage;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\n// Tabla de desglose de K\n// https://embed.plnkr.co/plunk/MV01Dl\n// https://medium.com/@jeffbutsch/using-d3-in-react-with-hooks-4a6c61f1d102\n// Elementos de data: { title, a, au, type, u_mean, k_contrib, k_pct, format = false, color },\nconst KChart = ({\n  data,\n  format,\n  width = 800,\n  height = 400,\n  bar_value_padding = 4,\n}) => {\n  const d3Container = useRef();\n  format =\n    format ||\n    ((d) =>\n      d === null || d === undefined || isNaN(d) ? \"-\" : `${d.toFixed(1)}%`);\n\n  useEffect(\n    () => {\n      const container = d3Container.current;\n      const margin = { top: 30, right: 30, bottom: 30, left: 60 },\n        chart_width = width - margin.left - margin.right,\n        chart_height = height - margin.top - margin.bottom;\n\n      if (data && container) {\n        // Limpia imagen preexistente\n        d3.select(container).selectChildren().remove();\n\n        // Genera imagen\n        const svg = d3\n          .select(container)\n          .attr(\"class\", \"canvas\")\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n        // Título\n        svg\n          .append(\"text\")\n          .attr(\"x\", chart_width / 2)\n          .attr(\"y\", 0 - margin.top / 2)\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"16px\")\n          .style(\"text-decoration\", \"underline\")\n          .text(\"Descomposición de K por elementos y tipos [%]\");\n\n        // X axis\n        const x = d3\n          .scaleBand()\n          .range([0, chart_width])\n          .domain(data.map((d) => d.short_title))\n          .padding(0.1);\n\n        const areSubtype = data.map((d) => d.type !== \"Tipo\");\n        // X ticks\n        svg\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(0, ${chart_height})`)\n          .call(d3.axisBottom(x))\n          .selectAll(\"text\")\n          .attr(\"transform\", \"translate(0,5)\")\n          .attr(\"font-weight\", (_, i) => (areSubtype[i] ? \"normal\" : \"bold\"))\n          .style(\"text-anchor\", \"middle\");\n\n        // Y axis\n        const [min, max] = d3.extent(data, (d) => d.k_pct);\n        const y = d3\n          .scaleLinear()\n          .domain([Math.min(0, min), max])\n          .range([chart_height, 0])\n          .nice();\n\n        svg.append(\"g\").call(d3.axisLeft(y));\n\n        // Rótulo eje Y (girado)\n        svg\n          .append(\"text\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", 0 - margin.left)\n          .attr(\"x\", 0 - height / 2)\n          .attr(\"dy\", \"1em\")\n          .style(\"text-anchor\", \"middle\")\n          .text(\"K [%]\");\n\n        // Y = 0\n        svg\n          .append(\"g\")\n          .attr(\"class\", \"baseline\")\n          .attr(\"transform\", `translate(0, ${y(0)})`)\n          .call(d3.axisBottom(x).tickSize(0).tickFormat(\"\"));\n\n        // Bars\n        const bar = svg\n          .selectAll(\"mybar\")\n          .data(data)\n          .enter()\n          .append(\"g\")\n          .attr(\"class\", (d) => `bar ${d.k_pct < 0 ? \"negative\" : \"positive\"}`);\n\n        bar\n          .append(\"rect\")\n          .attr(\n            \"x\",\n            (d) =>\n              x(d.short_title) +\n              x.bandwidth() * (d.type === \"Tipo\" ? 0.0 : 0.25)\n          )\n          .attr(\"y\", (d) => y(Math.max(0, d.k_pct)))\n          .attr(\"width\", (d) => x.bandwidth() * (d.type === \"Tipo\" ? 1.0 : 0.5))\n          .attr(\"height\", (d) => Math.abs(y(d.k_pct) - y(0)))\n          .attr(\"mask\", (d) =>\n            d.type === \"Tipo\" ? null : \"url(#mask-diagonal)\"\n          )\n          .attr(\"fill\", (d) => d.color);\n\n        bar\n          .append(\"text\")\n          .attr(\"x\", (d) => x(d.short_title) + x.bandwidth() / 2)\n          .attr(\"y\", (d) => y(Math.max(0, d.k_pct)) - bar_value_padding)\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"font-weight\", (_, i) => (areSubtype[i] ? \"normal\" : \"bold\"))\n          .text((d) => format(d.k_pct));\n      }\n    },\n    // Array de dependencias.\n    // El bloque se ejecuta cuando cambia cualquiera de estas variables\n    [data, height, width, bar_value_padding, format]\n  );\n\n  return (\n    <svg\n      className=\"d3-component\"\n      width={width}\n      height={height}\n      ref={d3Container}\n    />\n  );\n};\n\nexport default KChart;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Table } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport KChart from \"./KChart\";\nimport { round_or_dash } from \"../../utils\";\n\nconst formatted = (elem, bold = false) => (bold ? <b>{elem}</b> : <>{elem}</>);\n\nconst KDetail = () => {\n  const appstate = useContext(AppState);\n  const { K, summary, roofs, floors, walls, windows, ground, tbs } =\n    appstate.energy_indicators.K_data;\n  const {\n    a,\n    au,\n    opaques_a,\n    opaques_au,\n    windows_a,\n    windows_au,\n    tbs_l,\n    tbs_psil,\n  } = summary;\n\n  // Elementos detallados: título, a, au, tipo, ¿con formato especial?\n  const all_elements = [\n    [\"Huecos\", \"Huecos\", windows.a, windows.au, \"Tipo\", true, \"#0096e1\"],\n    [\"Opacos\", \"Opacos\", opaques_a, opaques_au, \"Tipo\", true, \"#a0401a\"],\n    [\n      \"- Fachadas (O-W)\",\n      \"O-W\",\n      walls.a,\n      walls.au,\n      \"TipoOpaco\",\n      false,\n      \"#eedaa3\",\n    ],\n    [\n      \"- Cubiertas (O-R)\",\n      \"O-R\",\n      roofs.a,\n      roofs.au,\n      \"TipoOpaco\",\n      false,\n      \"#c28586\",\n    ],\n    [\n      \"- Suelos (O-F)\",\n      \"O-F\",\n      floors.a,\n      floors.au,\n      \"TipoOpaco\",\n      false,\n      \"#c99fde\",\n    ],\n    [\n      \"- Cerramientos en contacto con el terreno (O-G)\",\n      \"O-G\",\n      ground.a,\n      ground.au,\n      \"TipoOpaco\",\n      false,\n      \"#d3aa86\",\n    ],\n    [\"Puentes térmicos\", \"PTs\", tbs_l, tbs_psil, \"Tipo\", true, \"#447c2c\"],\n    [\n      \"- Cubierta o suelo con fachada (R)\",\n      \"TB-R\",\n      tbs.roof.l,\n      tbs.roof.psil,\n      \"TipoPT\",\n      false,\n      \"#c281ac\",\n    ],\n    [\n      \"- Balcón (B)\",\n      \"TB-B\",\n      tbs.balcony.l,\n      tbs.balcony.psil,\n      \"TipoPT\",\n      false,\n      \"#c28bb5\",\n    ],\n    [\n      \"- Esquina de fachadas (C)\",\n      \"TB-C\",\n      tbs.corner.l,\n      tbs.corner.psil,\n      \"TipoPT\",\n      false,\n      \"#eee8a4\",\n    ],\n    [\n      \"- Frente de forjado (IF)\",\n      \"TB-IF\",\n      tbs.intermediate_floor.l,\n      tbs.intermediate_floor.psil,\n      \"TipoPT\",\n      false,\n      \"#bda7de\",\n    ],\n    [\n      \"- Partición interior con envolvente (IW)\",\n      \"TB-IW\",\n      tbs.internal_wall.l,\n      tbs.internal_wall.psil,\n      \"TipoPT\",\n      false,\n      \"#d8eea8\",\n    ],\n    [\n      \"- Elementos contra el terreno con fachada (GF)\",\n      \"TB-GF\",\n      tbs.ground_floor.l,\n      tbs.ground_floor.psil,\n      \"TipoPT\",\n      false,\n      \"#d3ca86\",\n    ],\n    [\n      \"- Pilar (P)\",\n      \"TB-P\",\n      tbs.pillar.l,\n      tbs.pillar.psil,\n      \"TipoPT\",\n      false,\n      \"#98de7b\",\n    ],\n    [\n      \"- Contorno de huecos (W)\",\n      \"TB-W\",\n      tbs.window.l,\n      tbs.window.psil,\n      \"TipoPT\",\n      false,\n      \"#91decf\",\n    ],\n    [\n      \"- Genérico (G)\",\n      \"TB-G\",\n      tbs.generic.l,\n      tbs.generic.psil,\n      \"TipoPT\",\n      false,\n      \"#a200ff\",\n    ],\n  ];\n\n  const k_data = build_k_data(K, a, all_elements).filter(({ a }) => a > 0.001);\n\n  return (\n    <>\n      <Row className=\"mb-4 print-section\">\n        <Col>\n          <h3 className=\"mb-4\">Transmitancia térmica global (K)</h3>\n          <p>\n            La{\" \"}\n            <b>\n              transmitancia térmica global (<i>K</i>)\n            </b>{\" \"}\n            cuantifica la facilidad de <b>intercambiar calor por conducción</b>{\" \"}\n            a través del <b>conjunto de la envolvente</b> térmica (huecos,\n            opacos y puentes térmicos).\n          </p>\n          <p>\n            Su cálculo se basa en el coeficiente global de transmisión de calor\n            (\n            <i>\n              H<sub>tr,adj</sub>\n            </i>\n            ) repercutido por la superficie de intercambio con el exterior.\n          </p>\n          <p>\n            <u>Coeficiente global de transmisión de calor</u>, H\n            <sub>tr,adj</sub>*:\n          </p>\n          <p className=\"text-center\">\n            H<sub>tr,adj</sub> &asymp; &sum;<sub>x</sub> b<sub>tr,x</sub> ·\n            [&sum;\n            <sub>i</sub> A<sub>x,i</sub> · U<sub>x,i</sub> (huecos + opacos) +\n            &sum;<sub>k</sub> l<sub>x,k</sub> · ψ<sub>x,k</sub> (PTs)] ={\" \"}\n            {windows_au.toFixed(2)} W/K (huecos) + {opaques_au.toFixed(2)} W/K\n            (opacos) + {tbs_psil.toFixed(2)} W/K (PTs) = {au.toFixed(2)} W/K{\" \"}\n          </p>\n          <p className=\"small\">\n            * <i>UNE EN ISO 13790:2008</i>, 8.3.1, ec. (17) e{\" \"}\n            <i>ISO/FDIS 52016-1</i>, 6.6.5.2, ec. (108).\n          </p>\n          <p>\n            <u>Superficie de intercambio térmico de la envolvente</u>, A\n            <sub>int</sub>\n            **:\n          </p>\n          <p className=\"text-center\">\n            A<sub>int</sub> = &sum; b<sub>tr,x</sub> · A<sub>x</sub> ={\" \"}\n            {windows_a.toFixed(2)} m² (huecos) + {opaques_a.toFixed(2)} m²\n            (opacos) = {a.toFixed(2)} m²\n          </p>\n          <p className=\"small\">\n            ** CTE DB-HE 2019. &quot;superficie de intercambio térmico de la\n            envolvente&quot;\n          </p>\n          <p>\n            <u>Valor del indicador</u>, K:\n          </p>\n          <p className=\"text-center\">\n            K = H<sub>tr,adj</sub> / A<sub>int</sub> &asymp; {au.toFixed(2)} /{\" \"}\n            {a.toFixed(2)} = {K.toFixed(2)} <i>W/m²K</i>\n          </p>\n          <p className=\"text-center h4 border border-dark p-4\">\n            <b>\n              K = {K.toFixed(2)} <i>W/m²K</i>\n            </b>\n          </p>\n        </Col>\n      </Row>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"0\"\n        height=\"0\"\n        style={{ position: \"absolute\" }}\n      >\n        <defs>\n          <pattern\n            id=\"pattern-diagonal\"\n            width=\"10\"\n            height=\"10\"\n            patternUnits=\"userSpaceOnUse\"\n            patternTransform=\"rotate(45)\"\n          >\n            <rect x=\"0\" y=\"0\" width=\"8\" height=\"15\" fill=\"white\" />\n          </pattern>\n          <mask id=\"mask-diagonal\">\n            <rect width=\"2000\" height=\"500\" fill=\"url(#pattern-diagonal)\" />\n          </mask>\n        </defs>\n      </svg>\n      <Row className=\"print-section\">\n        <Col>\n          {k_data.length > 0 ? <KElementsTable K={K} data={k_data} /> : null}\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col className=\"text-center\">\n          {k_data.length > 0 ? <KChart data={k_data} width={1200} /> : null}\n        </Col>\n      </Row>\n    </>\n  );\n};\n\n// Tabla de desglose de K\nconst KElementsTable = ({ K, data }) => {\n  const elem_tr = (\n    { title, a, au, u_mean, k_contrib, k_pct, color, format = false },\n    key = null\n  ) => (\n    <tr key={key}>\n      <td style={{ width: \"2em\", background: `${color}` }} />\n      <td>{formatted(title, format)}</td>\n      <td className=\"text-center\">{formatted(round_or_dash(a), format)}</td>\n      <td className=\"text-center\">{formatted(round_or_dash(au), format)}</td>\n      <td className=\"text-center\">\n        {formatted(round_or_dash(u_mean), format)}\n      </td>\n      <td className=\"text-center\">\n        {formatted(round_or_dash(k_contrib), format)}\n      </td>\n      <td className=\"text-center\">\n        {formatted(round_or_dash(k_pct, 1), format)}\n      </td>\n    </tr>\n  );\n\n  return (\n    <Table striped bordered hover size=\"sm\" className=\"small\">\n      <thead style={{ background: \"lightGray\" }}>\n        <tr>\n          <th colSpan=\"2\">Elemento</th>\n          <th className=\"text-center\">\n            A o L<br />\n            [m² o m]\n          </th>\n          <th className=\"text-center\">\n            A·U o ψ·L\n            <br />\n            [W/K]\n          </th>\n          <th className=\"text-center\">\n            U o ψ media\n            <br />\n            [W/m²K]\n          </th>\n          <th className=\"text-center\">\n            &Delta;K\n            <br />\n            [W/m²K]\n          </th>\n          <th className=\"text-center\">\n            K\n            <br />\n            [%]\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        {data.map((e, idx) => elem_tr(e, idx))}\n        <tr>\n          <td colSpan=\"2\">\n            <b>TOTAL</b>\n          </td>\n          <td />\n          <td />\n          <td className=\"text-center\">\n            <b>{K.toFixed(2)}</b>\n          </td>\n          <td className=\"text-center\">\n            <b>{K.toFixed(2)}</b>\n          </td>\n          <td className=\"text-center\">\n            <b>100.0</b>\n          </td>\n        </tr>\n      </tbody>\n    </Table>\n  );\n};\n\n// Genera datos a partir de lista\nconst build_k_data = (K, total_a, data) => {\n  return data.map(([title, short_title, a, au, type, format, color]) => ({\n    title,\n    short_title,\n    a,\n    au,\n    type,\n    format,\n    color,\n    u_mean: U_mean(au, a),\n    k_contrib: K_contrib(au, total_a),\n    k_pct: K_pct(au, total_a, K),\n  }));\n};\n\nconst U_mean = (elem_au, elem_a) => {\n  if (elem_a && elem_a > 0.0001) {\n    return elem_au / elem_a;\n  }\n  return null;\n};\n\nconst K_contrib = (elem_au, total_a) => {\n  if (total_a && total_a > 0.0001) {\n    return elem_au / total_a;\n  }\n  return null;\n};\n\nconst K_pct = (elem_au, a, K) => {\n  if (a && a > 0.0001 && K && Math.abs(K) > 0.0001) {\n    return (100 * elem_au) / a / K;\n  }\n  return null;\n};\n\nexport default observer(KDetail);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\n// Tabla de desglose de K\n// https://embed.plnkr.co/plunk/MV01Dl\n// https://medium.com/@jeffbutsch/using-d3-in-react-with-hooks-4a6c61f1d102\n// Elementos de data: { element, color, a, u_mean, u_max, u_min },\nconst UElementsChart = ({\n  data,\n  K,\n  width = 800,\n  height = 400,\n  bar_value_padding = 4,\n}) => {\n  const d3Container = useRef();\n\n  useEffect(\n    () => {\n      const container = d3Container.current;\n      const margin = { top: 30, right: 30, bottom: 60, left: 200 },\n        chart_width = width - margin.left - margin.right,\n        chart_height = height - margin.top - margin.bottom;\n\n      const format = (d) =>\n        d === null || d === undefined || isNaN(d) ? \"-\" : `${d.toFixed(2)}`;\n\n      if (data && container) {\n        const max = Math.round(d3.max(data, (d) => d.u_max) + 0.5);\n        const filtered_data = data.filter(d => d.a > 0);\n\n        // Limpia imagen preexistente\n        d3.select(container).selectChildren().remove();\n\n        // Escalas X e Y y de color\n        const x = d3.scaleLinear().range([0, chart_width]).domain([0, max]);\n        const y = d3\n          .scaleBand()\n          .range([chart_height, 0])\n          .domain(data.map((d) => d.element));\n        // .padding(0.4);\n        const uColor = d3\n          .scaleSequential()\n          .domain([0, max])\n          .range([\"blue\", \"red\"]);\n\n        // SVG\n        const svg = d3\n          .select(container)\n          .attr(\"class\", \"canvas\")\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n        // Título\n        svg\n          .append(\"text\")\n          .attr(\"x\", chart_width / 2)\n          .attr(\"y\", 0 - margin.top / 2)\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"16px\")\n          .style(\"text-decoration\", \"underline\")\n          .text(\"U media y rango de valores por tipo de elemento [W/m²K]\");\n\n        // Axis\n        svg\n          .append(\"g\")\n          .attr(\"transform\", `translate(0, ${chart_height})`)\n          .call(d3.axisBottom(x).ticks(12))\n          .select(\".domain\")\n          .remove();\n        svg\n          .append(\"g\")\n          .call(d3.axisLeft(y).tickSizeOuter(0).tickSizeInner(-chart_width))\n          .attr(\"font-weight\", \"bold\")\n          .select(\".domain\")\n          .remove();\n\n        svg.selectAll(\".tick line\").attr(\"stroke\", \"steelBlue\");\n\n        // X axis label\n        svg\n          .append(\"text\")\n          .attr(\"text-anchor\", \"end\")\n          .attr(\"x\", chart_width)\n          .attr(\"y\", chart_height + margin.top + 20)\n          .text(\"U [W/m²K]\");\n\n        // Tooltips\n        const tooltip = d3\n          .select(\"body\")\n          .append(\"div\")\n          .attr(\"class\", \"tooltip\")\n          .style(\"opacity\", 0);\n        // Three function that change the tooltip when user hover / move / leave a cell\n        const mouseover = (e, d) => {\n          tooltip.transition().duration(200).style(\"opacity\", 1);\n          tooltip\n            .html(`U_media: ${format(d.u_mean)} W/m²K`)\n            .style(\"left\", e.pageX + 30 + \"px\")\n            .style(\"top\", e.pageY + \"px\");\n        };\n        const mousemove = (e, _d) => {\n          tooltip\n            .style(\"left\", e.pageX + 30 + \"px\")\n            .style(\"top\", e.pageY + \"px\");\n        };\n        const mouseleave = (_e, _d) => {\n          tooltip.transition().duration(200).style(\"opacity\", 0);\n        };\n\n        // Rectángulos con max y min\n        svg\n          .selectAll(\"boxes\")\n          .data(filtered_data)\n          .enter()\n          .insert(\"rect\")\n          .attr(\"x\", (d) => x(d.u_min))\n          .attr(\"width\", (d) => x(d.u_max - d.u_min))\n          .attr(\"y\", (d) => y(d.element) + y.bandwidth() * 0.1)\n          .attr(\"height\", y.bandwidth() * 0.8)\n          .style(\"fill\", (d) => d.color)\n          .style(\"opacity\", 0.3);\n\n        // Puntos de valor medio\n        svg\n          .selectAll(\"indPoints\")\n          .data(filtered_data)\n          .enter()\n          .append(\"circle\")\n          .attr(\"cx\", (d) => x(d.u_mean))\n          .attr(\"cy\", (d) => y(d.element) + y.bandwidth() / 2)\n          .attr(\"r\", 8)\n          .style(\"stroke\", \"black\")\n          .style(\"stroke-width\", 2)\n          .style(\"fill\", (d) => uColor(d.u_mean))\n          .on(\"mouseover\", mouseover)\n          .on(\"mousemove\", mousemove)\n          .on(\"mouseleave\", mouseleave);\n\n        // Línea con valor de K\n        svg\n          .append(\"line\")\n          .attr(\"x1\", x(K))\n          .attr(\"x2\", x(K))\n          .attr(\"y1\", 0)\n          .attr(\"y2\", chart_height)\n          .style(\"stroke\", \"steelBlue\")\n          .style(\"stroke-width\", 3)\n          .style(\"fill\", \"none\");\n        svg\n          .append(\"text\")\n          .style(\"stroke\", \"steelBlue\")\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"x\", x(K))\n          .attr(\"y\", 10)\n          .attr('transform', `translate(${x(K) + 20}, ${0}) rotate(90)`)\n          .text(`K: ${format(K)} [W/m²K]`);\n      }\n    },\n    // Array de dependencias.\n    // El bloque se ejecuta cuando cambia cualquiera de estas variables\n    [data, K, height, width, bar_value_padding]\n  );\n\n  return (\n    <svg\n      className=\"d3-component\"\n      width={width}\n      height={height}\n      ref={d3Container}\n    />\n  );\n};\n\nexport default UElementsChart;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Table } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport UElementsChart from \"./UChart\";\nimport { round_or_dash } from \"../../utils\";\n\nconst formatted = (elem, bold = false) => (bold ? <b>{elem}</b> : <>{elem}</>);\n\nconst IndicatorsUDetail = () => {\n  const appstate = useContext(AppState);\n  const { K, roofs, floors, walls, windows, ground } =\n    appstate.energy_indicators.K_data;\n\n  // Elementos detallados: título, a, au, tipo, ¿con formato especial?\n  const all_elements = [\n    [\"Huecos\", windows, \"#0096e1\"],\n    [\"Fachadas (O-W)\", walls, \"#eedaa3\"],\n    [\"Cubiertas (O-R)\", roofs, \"#c28586\"],\n    [\"Suelos (aire) (O-F)\", floors, \"#c99fde\"],\n    [\"Elem. contacto con terreno (O-G)\", ground, \"#d3aa86\"],\n  ];\n\n  const k_data = all_elements.map(\n    ([element, { a, au, u_mean, u_min, u_max }, color]) => ({\n      element,\n      color,\n      a,\n      au,\n      u_mean,\n      u_min,\n      u_max,\n    })\n  );\n\n  return (\n    <>\n      <Row className=\"print-section\">\n        <Col>\n          <h3 className=\"mb-4\">Transmitancia térmica de huecos y opacos (U)</h3>\n          <p>\n            La <b>transmitancia térmica (U)</b> cuantifica la facilidad de{\" \"}\n            <b>intercambiar calor por conducción</b> a través de los distintos{\" \"}\n            <b>elementos de la envolvente térmica</b> del edificio.\n          </p>\n          <p>\n            Su cálculo corresponde con el coeficiente de transmisión de calor\n            (U) de los elementos opacos y huecos pertenecientes a la envolvente\n            térmica.*\n          </p>\n          <p className=\"small\">\n            * <i>UNE-EN ISO 13789</i>, <i>UNE-EN ISO 6946</i>,{\" \"}\n            <i>UNE-EN ISO 13370</i>, <i>UNE-EN ISO 10077-1</i>,{\" \"}\n            <i>UNE-EN ISO 12631</i>.\n          </p>\n        </Col>\n      </Row>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"0\"\n        height=\"0\"\n        style={{ position: \"absolute\" }}\n      >\n        <defs>\n          <pattern\n            id=\"pattern-diagonal\"\n            width=\"10\"\n            height=\"10\"\n            patternUnits=\"userSpaceOnUse\"\n            patternTransform=\"rotate(45)\"\n          >\n            <rect x=\"0\" y=\"0\" width=\"8\" height=\"15\" fill=\"white\" />\n          </pattern>\n          <mask id=\"mask-diagonal\">\n            <rect width=\"2000\" height=\"500\" fill=\"url(#pattern-diagonal)\" />\n          </mask>\n        </defs>\n      </svg>\n      <Row className=\"print-section\">\n        <Col>{k_data.length > 0 ? <UElementsTable data={k_data} /> : null}</Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col className=\"text-center\">\n          {k_data.length > 0 ? (\n            <UElementsChart data={k_data} K={K} width={1200} />\n          ) : null}\n        </Col>\n      </Row>\n    </>\n  );\n};\n\n// Tabla de desglose de U de huecos y opacos\nconst UElementsTable = ({ data }) => (\n  <Table striped bordered hover size=\"sm\" className=\"small\">\n    <thead style={{ background: \"lightGray\" }}>\n      <tr>\n        <th colSpan=\"2\">Elemento</th>\n        <th className=\"text-center\">\n          A<br />\n          [m²]\n        </th>\n        <th className=\"text-center\">\n          A·U\n          <br />\n          [W/K]\n        </th>\n        <th className=\"text-center\">\n          U<sub>media</sub>\n          <br />\n          [W/m²K]\n        </th>\n        <th className=\"text-center\">\n          U<sub>min</sub>\n          <br />\n          [W/m²K]\n        </th>\n        <th className=\"text-center\">\n          U<sub>max</sub>\n          <br />\n          [W/m²K]\n        </th>\n      </tr>\n    </thead>\n    <tbody>\n      {data.map(\n        (\n          { element, a, au, u_mean, u_min, u_max, color, format = false },\n          key\n        ) => (\n          <tr key={key}>\n            <td style={{ width: \"2em\", background: `${color}` }} />\n            <td>{formatted(element, format)}</td>\n            <td className=\"text-center\">\n              {formatted(round_or_dash(a), format)}\n            </td>\n            <td className=\"text-center\">\n              {formatted(round_or_dash(au), format)}\n            </td>\n            <td className=\"text-center\">\n              {formatted(round_or_dash(u_mean), format)}\n            </td>\n            <td className=\"text-center\">\n              {formatted(round_or_dash(u_min), format)}\n            </td>\n            <td className=\"text-center\">\n              {formatted(round_or_dash(u_max), format)}\n            </td>\n          </tr>\n        )\n      )}\n    </tbody>\n  </Table>\n);\n\nexport default observer(IndicatorsUDetail);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\n// Gráfica de desglose de q_soljul\nexport const QSolJulChartBar = ({\n  data,\n  format,\n  width = 800,\n  height = 400,\n  bar_value_padding = 4,\n}) => {\n  const d3Container = useRef();\n  format =\n    format ||\n    ((d) =>\n      d === null || d === undefined || isNaN(d) ? \"-\" : `${d.toFixed(1)}%`);\n\n  useEffect(\n    () => {\n      const container = d3Container.current;\n      const margin = { top: 30, right: 30, bottom: 30, left: 60 },\n        chart_width = width - margin.left - margin.right,\n        chart_height = height - margin.top - margin.bottom;\n\n      if (data && container) {\n        // Limpia imagen preexistente\n        d3.select(container).selectChildren().remove();\n\n        // Genera imagen\n        const svg = d3\n          .select(container)\n          .attr(\"class\", \"canvas\")\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n        // Título\n        svg\n          .append(\"text\")\n          .attr(\"x\", width / 2)\n          .attr(\"y\", 0 - margin.top / 2)\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"16px\")\n          .style(\"text-decoration\", \"underline\")\n          .text(\"Descomposición de q_sol;jul por orientaciones [%]\");\n\n        // X axis\n        const x = d3\n          .scaleBand()\n          .range([0, chart_width])\n          .domain(data.map((d) => d.orient))\n          .padding(0.1);\n\n        // X ticks\n        svg\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(0, ${chart_height})`)\n          .call(d3.axisBottom(x))\n          .selectAll(\"text\")\n          .attr(\"transform\", \"translate(0,5)\")\n          .style(\"text-anchor\", \"middle\");\n\n        // Y axis\n        const [min, max] = d3.extent(data, (d) => d.q_pct);\n        const y = d3\n          .scaleLinear()\n          .domain([Math.min(0, min), max])\n          .range([chart_height, 0])\n          .nice();\n\n        svg.append(\"g\").call(d3.axisLeft(y));\n\n        // Rótulo eje Y (girado)\n        svg\n          .append(\"text\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", 0 - margin.left)\n          .attr(\"x\", 0 - height / 2)\n          .attr(\"dy\", \"1em\")\n          .style(\"text-anchor\", \"middle\")\n          .text(\"q_sol;jul [%]\");\n\n        // Bars\n        const bar = svg.selectAll(\"mybar\").data(data).enter().append(\"g\");\n\n        bar\n          .append(\"rect\")\n          .attr(\"x\", (d) => x(d.orient))\n          .attr(\"y\", (d) => y(d.q_pct))\n          .attr(\"width\", x.bandwidth())\n          .attr(\"height\", (d) => y(0) - y(d.q_pct))\n          .attr(\"fill\", (d) => d.color);\n\n        bar\n          .append(\"text\")\n          .attr(\"x\", (d) => x(d.orient) + x.bandwidth() / 2)\n          .attr(\"y\", (d) => y(Math.max(0, d.q_pct)) - bar_value_padding)\n          .attr(\"text-anchor\", \"middle\")\n          .text((d) => format(d.q_pct));\n      }\n    },\n    // Array de dependencias.\n    // El bloque se ejecuta cuando cambia cualquiera de estas variables\n    [data, height, width, bar_value_padding, format]\n  );\n\n  return (\n    <svg\n      className=\"d3-component\"\n      width={width}\n      height={height}\n      ref={d3Container}\n    />\n  );\n};\n\n// Gráfica de desglose de q_soljul\nexport const QSolJulChartWindRose = ({\n  data,\n  format,\n  width = 800,\n  height = 400,\n  bar_value_padding = 4,\n}) => {\n  const d3Container = useRef();\n  format =\n    format ||\n    ((d) =>\n      d === null || d === undefined || isNaN(d) ? \"-\" : `${d.toFixed(1)}%`);\n\n  useEffect(\n    () => {\n      const container = d3Container.current;\n      const margin = { top: 40, right: 30, bottom: 10, left: 30 },\n        chart_width = width - margin.left - margin.right,\n        chart_height = height - margin.top - margin.bottom;\n\n      const cx = chart_width / 2;\n      const cy = chart_height / 2;\n      const radius = Math.min(cx, cy);\n      const outerRadius = radius - 35;\n      const innerRadius = 0.4 * radius;\n      const angleOffset = 180 / 8;\n\n      if (data && container) {\n        // Limpia imagen preexistente\n        d3.select(container).selectChildren().remove();\n\n        // Genera imagen\n        const svg = d3\n          .select(container)\n          .attr(\"class\", \"canvas\")\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top / 2})`);\n\n        // Título\n        svg\n          .append(\"text\")\n          .attr(\"x\", cx)\n          .attr(\"y\", 0)\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"16px\")\n          .style(\"text-decoration\", \"underline\")\n          .text(\"Descomposición de q_sol;jul por orientaciones [%]\");\n\n        const chart = svg.append(\"g\");\n        chart.attr(\"transform\", `translate(${cx}, ${cy})`);\n\n        const dataOrientations = [\"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\"];\n\n        // Escala de porcentajes sobre el radio\n        const max_pct = 20 * Math.ceil(d3.max(data, (d) => d.q_pct) / 20);\n        const y = d3\n          .scaleLinear()\n          .range([innerRadius, outerRadius])\n          .domain([0, max_pct]);\n        // the xScale is for the bars, one full turn around circle\n        const x = d3\n          .scaleBand()\n          .range([0 + Math.PI / 8, 2 * Math.PI + Math.PI / 8])\n          .domain(dataOrientations)\n          .align(0);\n\n        // Arc for pie chart\n        const arc = d3\n          .arc()\n          .innerRadius(innerRadius)\n          .outerRadius((d) => y(d.data.q_pct))\n          .startAngle((d) => x(d.data.orient))\n          .endAngle((d) => x(d.data.orient) - x.bandwidth());\n\n        // Piechart layout, all equal width wedges\n        const pie = d3\n          .pie()\n          .sort(null)\n          .value((_d) => 1);\n\n        const g = chart\n          .selectAll(\".arc\")\n          .data(pie(data))\n          .join(\"g\")\n          .attr(\"class\", \"arc\")\n          .call((g) =>\n            g\n              .append(\"path\")\n              .attr(\"d\", arc)\n              .style(\"fill\", (d) => d.data.color)\n              .style(\"stroke\", \"white\")\n              .style(\"stroke-width\", \"2px\")\n              .style(\"opacity\", 0.7)\n          )\n          .call((g) =>\n            g\n              .append(\"text\")\n              .text((d) => format(d.data.q_pct))\n              .attr(\"text-anchor\", \"middle\")\n              .attr(\"font-weight\", \"bold\")\n              .attr(\"x\", (d) => arc.centroid(d)[0])\n              .attr(\"y\", (d) => arc.centroid(d)[1])\n              .attr(\"dy\", \"6px\")\n          );\n\n        // Etiqueta central\n        const txt = chart\n          .append(\"text\")\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"font-weight\", \"bold\")\n          .attr(\"dy\", \"0.5em\");\n        txt.append(\"tspan\").text(\"q\").style(\"font-size\", \"24px\");\n        txt\n          .append(\"tspan\")\n          .text(\"sol;jul\")\n          .attr(\"dy\", \"0.5em\")\n          .style(\"font-size\", \"20px\");\n\n        // Etiquetas de orientación\n        const inLowerHalf = (d) =>\n          (x(d.orient) + x.bandwidth() / 2 + Math.PI / 2) % (2 * Math.PI) <\n          Math.PI;\n\n        const label = chart\n          .append(\"g\")\n          .attr(\"class\", \"direction-labels\")\n          .selectAll(\"g\")\n          .data(pie(dataOrientations.map((d) => ({ orient: d }))))\n          .join(\"g\")\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\n            \"transform\",\n            (d) =>\n              `rotate(${\n                (x(d.data.orient) - x.bandwidth()) * (180 / Math.PI) -\n                (90 - angleOffset)\n              }) translate(${outerRadius + 10},0)`\n          );\n        label\n          .append(\"text\")\n          .attr(\"transform\", (d) =>\n            inLowerHalf(d)\n              ? \"rotate(90)translate(0,6)\"\n              : \"rotate(-90)translate(0,6)\"\n          ) // flip bottom labels\n          .text((d) => d.data.orient)\n          .attr(\"font-weight\", 500)\n          .attr(\"font-size\", 14);\n\n        // Círculos de 10%\n        const yAxis = (_g) =>\n          chart\n            .append(\"g\")\n            .attr(\"class\", \"yAxis\")\n            .selectAll(\"g\")\n            .data(y.ticks(max_pct / 20)) // .slice(1) to skip 0\n            .join(\"g\")\n            .call((g) =>\n              g\n                .append(\"circle\")\n                .attr(\"fill\", \"none\")\n                .attr(\"stroke\", \"gray\")\n                .attr(\"stroke-dasharray\", \"1,3\")\n                .attr(\"r\", y)\n            )\n            .call((g) =>\n              g\n                .append(\"text\")\n                .text((d) => `${d}%`)\n                .style(\"color\", \"gray\")\n                .attr(\"font-size\", 10)\n                .attr(\"x\", (d) => y(d + 2))\n                .attr(\"transform\", (d) => `rotate(${-50 + d})`)\n            );\n        g.call(yAxis);\n      }\n    },\n    // Array de dependencias.\n    // El bloque se ejecuta cuando cambia cualquiera de estas variables\n    [data, height, width, bar_value_padding, format]\n  );\n\n  return (\n    <svg\n      className=\"d3-component\"\n      width={width}\n      height={height}\n      ref={d3Container}\n    />\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2018-2021 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Table } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport { QSolJulChartWindRose as QSolJulChart } from \"./QSolJulChart\";\n// import { QSolJulChartBar as QSolJulChart } from \"./IndicatorsQSolJulChart\";\nimport { round_or_dash } from \"../../utils\";\n\nconst QSolJulDetail = () => {\n  const appstate = useContext(AppState);\n  const { area_ref, q_soljul_data } = appstate.energy_indicators;\n  const { q_soljul, Q_soljul, detail } = q_soljul_data;\n\n  const q_soljul_detail = Orientations.map(([orient, color]) => [\n    orient,\n    color,\n    detail[orient],\n  ])\n    .filter(([_orient, _color, det]) => det !== undefined && !isNaN(det.gains))\n    .map(\n      ([\n        orient,\n        color,\n        { fshobst_mean, gglshwi_mean, Ff_mean, a, irradiance, gains },\n      ]) => {\n        return {\n          orient,\n          color,\n          fshobst_mean,\n          gglshwi_mean,\n          Ff_mean,\n          a,\n          irradiance,\n          gains,\n          q_contrib: gains / area_ref,\n          q_pct: (100 * gains) / area_ref / q_soljul,\n        };\n      }\n    );\n\n  return (\n    <>\n      <Row className=\"print-section\">\n        <Col>\n          <h3 className=\"mb-4\">\n            Control solar de los huecos (q<sub>sol;jul</sub>)\n          </h3>\n          <p>\n            El <b>parámetro de control solar</b> cuantifica la{\" \"}\n            <b>capacidad de evitar el exceso de ganancias de radiación solar</b>\n            , gracias a las prestaciones térmicas del hueco (incluyendo los\n            dispositivos de sombra móviles) y el efecto de los obstáculos fijos\n            o remotos.\n          </p>\n          <p>\n            El cálculo se basa en las ganancias solares en el mes de julio con\n            los dispositivos de sombra de los huecos activados, Q\n            <sub>sol;jul</sub> y la superficie útil de los espacios habitables\n            de la envolvente térmica, A<sub>útil</sub>.\n          </p>\n          <p>\n            <u>\n              Ganancias solares en el mes de julio con los dispositivos de\n              sombra de los huecos activados\n            </u>\n            , Q<sub>sol;jul</sub>*:\n          </p>\n          <p className=\"text-center\">\n            Q<sub>sol;jul</sub> = &sum;<sub>k</sub>(F\n            <sub>sh,obst</sub> · g<sub>gl;sh;wi</sub> · (1 − F<sub>F</sub>) · A\n            <sub>w,p</sub> · H<sub>sol;jul</sub>) = {Q_soljul.toFixed(2)}{\" \"}\n            kWh/mes\n          </p>\n          <p className=\"small\">\n            *{\" \"}\n            <i>\n              Q<sub>H/C;sol;wi</sub>\n            </i>{\" \"}\n            <i>UNE-EN ISO 52016-1</i>, 6.5.13.2, (69) y 6.6.8.2, (123),\n            despreciando la reirradiación al cielo (Q<sub>sky;wi;jul</sub> = 0)\n            y considerando activadas las protecciones solares móviles (g = g\n            <sub>gl;sh;wi</sub>\n            ). De acuerdo a dichas normas, tampoco se consideran de forma\n            separada las componentes directa y difusa al evaluar las\n            obstrucciones solares.\n          </p>\n\n          <p>\n            <u>Superficie útil</u>, A<sub>útil</sub>**:\n          </p>\n          <p className=\"text-center\">\n            A<sub>util</sub> = {area_ref.toFixed(2)} m²\n          </p>\n          <p className=\"small\">\n            ** <i>CTE DB-HE 2019</i>. &quot;Superficie para el cálculo de los\n            indicadores de consumo&quot;.\n          </p>\n          <p>\n            <u>Valor del indicador</u>, q<sub>sol;jul</sub>:\n          </p>\n          <p className=\"text-center\">\n            q<sub>sol;jul</sub> = Q<sub>sol;jul</sub> / A<sub>util</sub> =\n            {Q_soljul.toFixed(2)} / {area_ref.toFixed(2)} ={\" \"}\n            {area_ref !== 0 ? q_soljul.toFixed(2) : \"-\"} <i>kWh/m²·mes</i>\n          </p>\n          <p className=\"text-center h4 border border-dark p-4\">\n            <b>\n              q<sub>sol;jul</sub> = {area_ref !== 0 ? q_soljul.toFixed(2) : \"-\"}{\" \"}\n              <i>kWh/m²·mes</i>\n            </b>\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"mt-4 print-section\">\n        <Col>\n          {q_soljul_detail.length > 0 ? (\n            <QSolJulTable\n              area_ref={area_ref}\n              data={q_soljul_data}\n              detail_data={q_soljul_detail}\n            />\n          ) : null}\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col className=\"text-center\">\n          {q_soljul_detail.length > 0 ? (\n            <QSolJulChart\n              area_ref={area_ref}\n              data={q_soljul_detail}\n              width={Math.max(550, 100 * q_soljul_detail.length)}\n            />\n          ) : null}\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nconst Orientations = [\n  [\"N\", \"#010164\"],\n  [\"NE\", \"#00799e\"],\n  [\"E\", \"#009e42\"],\n  [\"SE\", \"#969e00\"],\n  [\"S\", \"#ffff00\"],\n  [\"SW\", \"#ffaa00\"],\n  [\"W\", \"#aa0000\"],\n  [\"NW\", \"#9600aa\"],\n  [\"HZ\", \"#aaaaaa\"],\n];\n\n// Tabla de desglose de q_soljul\nconst QSolJulTable = (props) => {\n  const {\n    q_soljul,\n    Q_soljul,\n    a_wp,\n    irradiance_mean,\n    fshobst_mean,\n    gglshwi_mean,\n    Ff_mean,\n  } = props.data;\n  const detail_data = props.detail_data;\n  const area_ref = props.area_ref;\n\n  const elem_tr = (\n    {\n      orient,\n      color,\n      fshobst_mean,\n      gglshwi_mean,\n      Ff_mean,\n      a,\n      irradiance,\n      gains,\n    },\n    key = null\n  ) => (\n    <tr key={key}>\n      <td style={{ width: \"2em\", background: `${color}` }} />\n      <td>{orient}</td>\n      <td className=\"text-center\">{round_or_dash(fshobst_mean)}</td>\n      <td className=\"text-center\">{round_or_dash(gglshwi_mean)}</td>\n      <td className=\"text-center\">{round_or_dash(1 - Ff_mean)}</td>\n      <td className=\"text-center\">{round_or_dash(a)}</td>\n      <td className=\"text-center\">{round_or_dash(irradiance)}</td>\n      <td className=\"text-center\">{round_or_dash(gains)}</td>\n      <td className=\"text-center\">{round_or_dash(gains / area_ref)}</td>\n      <td className=\"text-center\">\n        {round_or_dash((100 * gains) / area_ref / q_soljul, 1)}\n      </td>\n    </tr>\n  );\n\n  return (\n    <Table striped bordered hover size=\"sm\" className=\"small\">\n      <thead style={{ background: \"lightGray\" }}>\n        <tr>\n          <th colSpan=\"2\">Orientación</th>\n          <th className=\"text-center\" title=\"Factor de obstáculos remotos\">\n            F<sub>sh;obst;orient</sub>\n            <br />\n            [-]\n          </th>\n          <th\n            className=\"text-center\"\n            title=\"Factor solar con dispoisivos de sombra activados\"\n          >\n            g<sub>gl;sh;wi;orient</sub>\n            <br />\n            [-]\n          </th>\n          <th\n            className=\"text-center\"\n            title=\"Fracción transparente del hueco (no ocupada por el marco)\"\n          >\n            (1 - F<sub>f;orient</sub>)\n            <br />\n            [-]\n          </th>\n          <th className=\"text-center\" title=\"Superficie de huecos\">\n            A<sub>w;p;orient</sub>\n            <br />\n            [m²]\n          </th>\n          <th\n            className=\"text-center\"\n            title=\"Irradiancia solar acumulada en el mes de julio\"\n          >\n            H<sub>sol;jul;orient</sub>\n            <br />\n            [kWh/m²·mes]\n          </th>\n          <th\n            className=\"text-center\"\n            title=\"Ganancias solares en el mes de julio con los dispositivos de sombra activados\"\n          >\n            Q<sub>sol;jul;orient</sub>\n            <br />\n            [kWh/mes]\n          </th>\n          <th\n            className=\"text-center\"\n            title=\"Fracción del parámetro de control solar imputable a la orientación\"\n          >\n            &Delta;q<sub>sol;jul</sub>\n            <br />\n            [kWh/m²·mes]\n          </th>\n          <th\n            className=\"text-center\"\n            title=\"Porcentaje del parámetro de control solar imputable a la orientación\"\n          >\n            q<sub>sol;jul</sub>\n            <br />\n            [%]\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        {detail_data.map((e, idx) => elem_tr(e, idx))}\n        <tr>\n          <td colSpan=\"2\">\n            <b>TOTAL / Promedio</b>\n          </td>\n          <td\n            className=\"text-center\"\n            title=\"Factor de obstáculos remotos medio\"\n          >\n            <b>{round_or_dash(fshobst_mean)}</b>\n          </td>\n          <td\n            className=\"text-center\"\n            title=\"Factor solar con dispoisivos de sombra activados medio\"\n          >\n            <b>{round_or_dash(gglshwi_mean)}</b>\n          </td>\n          <td\n            className=\"text-center\"\n            title=\"Fracción transparente del hueco (no ocupada por el marco) media\"\n          >\n            <b>{round_or_dash(1 - Ff_mean)}</b>\n          </td>\n          <td className=\"text-center\" title=\"Superficie de huecos\">\n            <b>{round_or_dash(a_wp)}</b>\n          </td>\n          <td\n            className=\"text-center\"\n            title=\"Irradiancia solar acumulada en el mes de julio media para los huecos\"\n          >\n            <b>{round_or_dash(irradiance_mean)}</b>\n          </td>\n          <td\n            className=\"text-center\"\n            title=\"Ganancias solares en el mes de julio con los dispositivos de sombra activados\"\n          >\n            <b>{Q_soljul.toFixed(2)}</b>\n          </td>\n          <td\n            className=\"text-center\"\n            title=\"Fracción del parámetro de control solar imputable a una orientación de huecos\"\n          >\n            <b>{round_or_dash(q_soljul)}</b>\n          </td>\n          <td className=\"text-center\">\n            <b>100.0</b>\n          </td>\n        </tr>\n      </tbody>\n    </Table>\n  );\n};\n\nexport default observer(QSolJulDetail);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\n// Gráfica de desglose de n50\nexport const N50ChartBar = ({\n  data,\n  format,\n  width = 800,\n  height = 400,\n  bar_value_padding = 4,\n}) => {\n  const d3Container = useRef();\n  format =\n    format ||\n    ((d) =>\n      d === null || d === undefined || isNaN(d) ? \"-\" : `${d.toFixed(1)}%`);\n\n  useEffect(\n    () => {\n      const container = d3Container.current;\n      const margin = { top: 30, right: 30, bottom: 30, left: 60 },\n        chart_width = width - margin.left - margin.right,\n        chart_height = height - margin.top - margin.bottom;\n\n      if (data && container) {\n        // Limpia imagen preexistente\n        d3.select(container).selectChildren().remove();\n\n        // Genera imagen\n        const svg = d3\n          .select(container)\n          .attr(\"class\", \"canvas\")\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n        // Título\n        svg\n          .append(\"text\")\n          .attr(\"x\", width / 2)\n          .attr(\"y\", 0 - margin.top / 2)\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"16px\")\n          .style(\"text-decoration\", \"underline\")\n          .text(\"Descomposición de n50 por elemento [%]\");\n\n        // X axis\n        const x = d3\n          .scaleBand()\n          .range([0, chart_width])\n          .domain(data.map((d) => d.name))\n          .padding(0.1);\n\n        // X ticks\n        svg\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(0, ${chart_height})`)\n          .call(d3.axisBottom(x))\n          .selectAll(\"text\")\n          .attr(\"transform\", \"translate(0,5)\")\n          .style(\"text-anchor\", \"middle\");\n\n        // Y axis\n        const [min, max] = d3.extent(data, (d) => d.pct);\n        const y = d3\n          .scaleLinear()\n          .domain([Math.min(0, min), max])\n          .range([chart_height, 0])\n          .nice();\n\n        svg.append(\"g\").call(d3.axisLeft(y));\n\n        // Rótulo eje Y (girado)\n        svg\n          .append(\"text\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", 0 - margin.left)\n          .attr(\"x\", 0 - height / 2)\n          .attr(\"dy\", \"1em\")\n          .style(\"text-anchor\", \"middle\")\n          .text(\"q_sol;jul [%]\");\n\n        // Bars\n        const bar = svg.selectAll(\"mybar\").data(data).enter().append(\"g\");\n\n        bar\n          .append(\"rect\")\n          .attr(\"x\", (d) => x(d.name))\n          .attr(\"y\", (d) => y(d.pct))\n          .attr(\"width\", x.bandwidth())\n          .attr(\"height\", (d) => y(0) - y(d.pct))\n          .attr(\"fill\", (d) => d.color);\n\n        bar\n          .append(\"text\")\n          .attr(\"x\", (d) => x(d.name) + x.bandwidth() / 2)\n          .attr(\"y\", (d) => y(Math.max(0, d.pct)) - bar_value_padding)\n          .attr(\"text-anchor\", \"middle\")\n          .text((d) => format(d.pct));\n      }\n    },\n    // Array de dependencias.\n    // El bloque se ejecuta cuando cambia cualquiera de estas variables\n    [data, height, width, bar_value_padding, format]\n  );\n\n  return (\n    <svg\n      className=\"d3-component\"\n      width={width}\n      height={height}\n      ref={d3Container}\n    />\n  );\n};\n\n// Gráfica de desglose de n50\nexport const N50ChartPie = ({\n  data,\n  format,\n  width = 800,\n  height = 400,\n  bar_value_padding = 4,\n}) => {\n  const d3Container = useRef();\n  format =\n    format ||\n    ((d) =>\n      d === null || d === undefined || isNaN(d) ? \"-\" : `${d.toFixed(1)}%`);\n\n  useEffect(\n    () => {\n      const container = d3Container.current;\n      const margin = { top: 30, right: 30, bottom: 30, left: 30 },\n        chart_width = width - margin.left - margin.right,\n        chart_height = height - margin.top - margin.bottom;\n      const cx = chart_width / 2;\n      const cy = chart_height / 2;\n      const radius = Math.min(chart_width, chart_height) / 2;\n\n      if (data && container) {\n        // Limpia imagen preexistente\n        d3.select(container).selectChildren().remove();\n\n        // Genera imagen\n        const svg = d3\n          .select(container)\n          .attr(\"class\", \"canvas\")\n          .append(\"g\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n        // Título\n        svg\n          .append(\"text\")\n          .attr(\"x\", chart_width / 2)\n          .attr(\"y\", 0)\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"16px\")\n          .style(\"text-decoration\", \"underline\")\n          .text(\"Descomposición de n50 por elementos [%]\");\n\n        const chart = svg.append(\"g\");\n        chart.attr(\"transform\", `translate(${cx}, ${cy})`);\n\n        chart.append(\"g\").attr(\"class\", \"slices\");\n        chart.append(\"g\").attr(\"class\", \"labels\");\n        chart.append(\"g\").attr(\"class\", \"lines\");\n\n        const pie = d3\n          .pie()\n          .sort(null)\n          .value((d) => d.pct);\n        const arc = d3\n          .arc()\n          .outerRadius(radius * 0.8)\n          .innerRadius(radius * 0.4);\n        const outerArc = d3\n          .arc()\n          .outerRadius(radius * 0.9)\n          .innerRadius(radius * 0.9);\n\n        // Sectores\n        const slice = svg\n          .select(\".slices\")\n          .selectAll(\"path.slice\")\n          .data(pie(data));\n\n        slice\n          .enter()\n          .insert(\"path\")\n          .attr(\"d\", (d) => arc(d))\n          .attr(\"fill\", (d) => d.data.color)\n          .attr(\"stroke\", \"white\")\n          .attr(\"class\", \"slice\")\n          .style(\"stroke-width\", \"2px\")\n          .style(\"opacity\", 0.7);\n\n        // Etiqueta central\n        slice\n          .enter()\n          .append(\"text\")\n          .text(\"n50\")\n          .attr(\"dy\", \"0.5em\")\n          .attr(\"font-weight\", \"bold\")\n          .attr(\"text-anchor\", \"middle\")\n          .style(\"font-size\", \"24px\");\n\n        slice.exit().remove();\n\n        // Etiquetas\n        const midAngle = (d) => d.startAngle + (d.endAngle - d.startAngle) / 2;\n\n        const text = svg.select(\".labels\").selectAll(\"text\").data(pie(data));\n\n        const txt = text\n          .enter()\n          .append(\"text\")\n          .attr(\"transform\", (d) => {\n            const pos = outerArc.centroid(d);\n            pos[0] = radius * (midAngle(d) < Math.PI ? 1 : -1);\n            return `translate(${pos[0]}, ${pos[1]})`;\n          })\n          .attr(\"dy\", \".35em\")\n          .style(\"text-anchor\", (d) =>\n            midAngle(d) < Math.PI ? \"start\" : \"end\"\n          );\n\n        // Primera línea de texto - elemento\n        txt\n          .append(\"tspan\")\n          .attr(\"font-weight\", \"bold\")\n          .attr(\"x\", \"0\")\n          .text((d) => d.data.name);\n        // segundo texto - pct\n        txt\n          .append(\"tspan\")\n          .attr(\"x\", \"0\")\n          .attr(\"dy\", \"1.5em\")\n          .text((d) => format(d.data.pct));\n\n        text.exit().remove();\n\n        // Polilíneas de conexión\n        const polyline = svg\n          .select(\".lines\")\n          .selectAll(\"polyline\")\n          .data(pie(data));\n\n        polyline\n          .enter()\n          .append(\"polyline\")\n          .attr(\"stroke\", \"black\")\n          .style(\"fill\", \"none\")\n          .attr(\"stroke-width\", 1)\n          .attr(\"points\", (d) => {\n            const posA = arc.centroid(d); // inserción en la cuña\n            const posB = outerArc.centroid(d); // ángulo de la línea\n            const posC = outerArc.centroid(d); // posición de la etiqueta, un poco movida de B\n            posC[0] = radius * 0.95 * (midAngle(d) < Math.PI ? 1 : -1);\n            return [posA, posB, posC];\n          });\n\n        polyline.exit().remove();\n      }\n    },\n    // Array de dependencias.\n    // El bloque se ejecuta cuando cambia cualquiera de estas variables\n    [data, height, width, bar_value_padding, format]\n  );\n\n  return (\n    <svg\n      className=\"d3-component\"\n      width={width}\n      height={height}\n      ref={d3Container}\n    />\n  );\n};\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Table } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport { N50ChartPie as N50Chart } from \"./N50Chart\";\n// import {N50ChartBar as N50Chart} from \"./IndicatorsN50Chart\";\nimport AppState from \"../../stores/AppState\";\nimport { round_or_dash } from \"../../utils\";\n\nconst IndicatorsN50Detail = () => {\n  const appstate = useContext(AppState);\n  const {\n    n50_ref,\n    n50,\n    walls_a,\n    walls_c,\n    walls_c_ref,\n    walls_c_a,\n    windows_a,\n    windows_c,\n    windows_c_a,\n    vol,\n  } = appstate.energy_indicators.n50_data;\n  // Paso de n50 (1/h) a CA (m³/h a 100Pa)\n  const factor_n50_to_ca = vol / 0.629;\n  const factor_ca_to_n50 = 1 / factor_n50_to_ca;\n  // Renovación total / h a 10 Pa\n  const ca_tot = n50 * factor_n50_to_ca;\n  let co_ensayo =\n    n50 < n50_ref ? (\n      <>\n        C<sub>o</sub> = {walls_c.toFixed(2)} m³/h·m², n<sub>50</sub> ={\" \"}\n        {n50.toFixed(2)}{\" \"}\n        <i>\n          h<sup>-1</sup>\n        </i>\n      </>\n    ) : (\n      <>\n        Ensayo no disponible\n        <br />C<sub>o</sub> = C<sub>o, ref</sub>\n      </>\n    );\n\n  const n50_info = [\n    [\n      \"Opacos\",\n      \"#a0401a\",\n      walls_c_a,\n      walls_c,\n      walls_a,\n      (100 * walls_c_a) / ca_tot,\n    ],\n    [\n      \"Huecos\",\n      \"#0096e1\",\n      windows_c_a,\n      windows_c,\n      windows_a,\n      (100 * windows_c_a) / ca_tot,\n    ],\n  ];\n\n  const elem_tr = ([name, color, ca, c, a, pct], key = null) => (\n    <tr key={key}>\n      <td style={{ width: \"2em\", background: `${color}` }} />\n      <td>{name}</td>\n      <td className=\"text-center\">{round_or_dash(c)}</td>\n      <td className=\"text-center\">{round_or_dash(a)}</td>\n      <td className=\"text-center\">{round_or_dash(ca)}</td>\n      <td className=\"text-center\">{round_or_dash(ca * factor_ca_to_n50)}</td>\n      <td className=\"text-center\">{round_or_dash(pct, 1)}</td>\n    </tr>\n  );\n\n  return (\n    <>\n      <Row className=\"print-section\">\n        <Col>\n          <h3 className=\"mb-4\">\n            Tasa de renovación de aire a 50 Pa (n<sub>50</sub>)\n          </h3>\n          <p>\n            Cuantifica el{\" \"}\n            <b>\n              riesgo de un intercambio excesivo de calor debido a la\n              infiltración y exfiltración de aire\n            </b>{\" \"}\n            a través de la envolvente térmica.\n          </p>\n          <p>\n            El cálculo se basa en el valor de permeabilidad obtenido con el\n            ensayo mediante el método de presurización con ventilador o,\n            alternativamente, mediante un indicador de riesgo teórico, la tasa\n            de referencia de renovación de aire a 50 Pa, n<sub>50,ref</sub>.\n          </p>\n\n          <p>\n            <u>Permeabilidad al aire de los opacos</u>, C<sub>o</sub>:\n          </p>\n          <p>\n            Valor de referencia, C<sub>o, ref</sub>*:\n          </p>\n          <p className=\"text-center\">\n            C<sub>o, ref</sub> = {walls_c_ref.toFixed(2)} m³/h·m²\n          </p>\n          <p>\n            Valor a partir de ensayo, C<sub>o</sub>**:\n          </p>\n          <p className=\"text-center\">{co_ensayo}</p>\n\n          <p className=\"small\">\n            * <i>CTE DB-HE 2019, Anejo H</i>. <br />\n            **{\" \"}\n            <i>\n              Ensayo según UNE-EN ISO 9972:2019 (sustituye a UNE-EN 13829:2002)\n            </i>\n          </p>\n\n          <p>\n            <u>Permeabilidad al aire de los huecos</u>, C<sub>h</sub>*:\n          </p>\n          <p className=\"text-center\">\n            C<sub>h</sub> = {windows_c.toFixed(2)} m³/h·m²\n          </p>\n\n          <p className=\"small\">\n            * Según <i>UNE-EN 12207:2017</i>.\n          </p>\n\n          <p>\n            <u>Valor de referencia del indicador</u>, n<sub>50,ref</sub>*:\n          </p>\n          <p className=\"text-center\">\n            <b>\n              n<sub>50, ref</sub>\n            </b>{\" \"}\n            = 0.629 · (&sum;C<sub>o, ref</sub> · A<sub>o</sub>+ &sum;C\n            <sub>h</sub>· A<sub>h</sub>) / V<sub>int</sub> = 0.629 · (\n            {walls_c_ref.toFixed(2)} · {walls_a.toFixed(2)} +{\" \"}\n            {windows_c.toFixed(2)} · {windows_a.toFixed(2)}) / {vol.toFixed(2)}{\" \"}\n            ={\" \"}\n            <b>\n              {n50_ref.toFixed(2)}{\" \"}\n              <i>\n                h<sup>-1</sup>\n              </i>\n            </b>\n          </p>\n          <p className=\"small\">\n            * <i>CTE DB-HE 2019, Anejo H</i>.\n          </p>\n\n          <p>\n            <u>Valor del indicador</u>, n<sub>50</sub>\n          </p>\n          <p className=\"text-center\">\n            C<sub>o</sub> = {walls_c.toFixed(2)} m³/h·m²\n          </p>\n          <p className=\"text-center\">\n            n<sub>50</sub> = 0.629 · (&sum;C<sub>o</sub> · A<sub>o</sub>+ &sum;C\n            <sub>h</sub>· A<sub>h</sub>) / V<sub>int</sub> = 0.629 · (\n            {walls_c.toFixed(2)} · {walls_a.toFixed(2)} + {windows_c.toFixed(2)}{\" \"}\n            · {windows_a.toFixed(2)}) / {vol.toFixed(2)} = {n50.toFixed(2)}{\" \"}\n            <i>\n              h<sup>-1</sup>\n            </i>\n          </p>\n          <p className=\"text-center h4 mb-4 border border-dark p-4\">\n            <b>\n              n<sub>50</sub> = {n50.toFixed(2)}{\" \"}\n              <i>\n                h<sup>-1</sup>\n              </i>\n            </b>\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col>\n          {n50 > 0 ? (\n            <Table striped bordered hover size=\"sm\" className=\"small\">\n              <thead style={{ background: \"lightGray\" }}>\n                <tr>\n                  <th colSpan=\"2\">Elemento</th>\n                  <th className=\"text-center\" title=\"C_i\">\n                    C<sub>i</sub>\n                    <br />\n                    [m³/h·m²]\n                  </th>\n                  <th className=\"text-center\" title=\"A_i\">\n                    A<sub>i</sub>\n                    <br />\n                    [m²]\n                  </th>\n                  <th className=\"text-center\" title=\"C_i·A_i\">\n                    C<sub>i</sub>·A<sub>i</sub>\n                    <br />\n                    [m³/h]\n                  </th>\n                  <th className=\"text-center\" title=\"n50 imputable al elemento\">\n                    &Delta;n<sub>50</sub>\n                    <br />\n                    [%]\n                  </th>\n                  <th\n                    className=\"text-center\"\n                    title=\"Porcentaje de n50 imputable al elemento\"\n                  >\n                    n<sub>50</sub>\n                    <br />\n                    [%]\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                {n50_info.map((e, idx) => elem_tr(e, idx))}\n                <tr>\n                  <td colSpan=\"4\">\n                    <b>TOTAL / Promedio</b>\n                  </td>\n                  <td\n                    className=\"text-center\"\n                    title=\"Volumen horario de intercambio de aire a 100 Pa (C_i · A_i)\"\n                  >\n                    <b>{round_or_dash(windows_c_a + walls_c_a)}</b>\n                  </td>\n                  <td\n                    className=\"text-center\"\n                    title=\"Tasa de renovación de aire a 50 Pa\"\n                  >\n                    <b>{round_or_dash(n50)}</b>\n                  </td>\n                  <td className=\"text-center\">\n                    <b>100.0</b>\n                  </td>\n                </tr>\n              </tbody>\n            </Table>\n          ) : null}\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col className=\"text-center\">\n          {n50 > 0 ? (\n            <N50Chart\n              data={n50_info.map(([name, color, _ca, _c, _a, pct]) => ({\n                name,\n                color,\n                pct,\n              }))}\n              width={550}\n            />\n          ) : null}\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nexport default observer(IndicatorsN50Detail);\n","export default __webpack_public_path__ + \"static/media/print-solid.89dc5340.svg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext, useRef } from \"react\";\nimport { Col, Row, Button } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport { APP_VERSION } from \"../../version.js\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport KDetail from \"./KDetail\";\nimport UDetail from \"./UDetail\";\nimport QSolJulDetail from \"./QSolJulDetail\";\nimport N50Detail from \"./N50Detail\";\nimport printer from \"../img/print-solid.svg\";\n\nconst He1Report = () => {\n  const kdetail = useRef(null);\n  const udetail = useRef(null);\n  const qsoljuldetail = useRef(null);\n  const n50detail = useRef(null);\n\n  const appstate = useContext(AppState);\n  const {\n    area_ref,\n    vol_env_net,\n    vol_env_gross,\n    compactness,\n    q_soljul_data,\n    n50_data,\n    K_data,\n  } = appstate.energy_indicators;\n\n  const { climate, name } = appstate.meta;\n\n  const { K } = K_data;\n  const { q_soljul } = q_soljul_data;\n  const { n50 } = n50_data;\n\n  const date = new Date(Date.now());\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h2>Comportamiento de la envolvente térmica</h2>\n        </Col>\n        <Col md={2} className=\"d-print-none text-end\">\n          <Button\n            variant=\"outline-secondary\"\n            onClick={() => window.print()}\n            title=\"Imprimir\"\n          >\n            <img\n              src={printer}\n              alt=\"Imprimir\"\n              height={25}\n              style={{ fill: \"white\" }}\n            />{\" \"}\n            Imprimir\n          </Button>\n        </Col>\n      </Row>\n      <Row style={{ background: \"whitesmoke\" }} className=\"py-4 my-3\">\n        <Col>\n          <Row>\n            <Col>\n              <h4>Resumen</h4>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={9}>\n              <big>\n                Proyecto: <i>{name}</i>\n              </big>\n            </Col>\n            <Col></Col>\n          </Row>\n          <Row>\n            <Col sm={3} title=\"Zona climática\">\n              <b>Zona climática: {climate}</b>\n            </Col>\n            <Col\n              sm={3}\n              title=\"Transmitancia térmica global del edificio [W/m²K]\"\n            >\n              <b>\n                <i>K</i> = {K.toFixed(2)} <i>W/m²K</i>\n              </b>\n            </Col>\n            <Col sm={3} title=\"Indicador de control solar [kWh/m²·mes]\">\n              <b>\n                <i>\n                  q<sub>sol;jul</sub>\n                </i>{\" \"}\n                = {area_ref !== 0 ? q_soljul.toFixed(2) : \"-\"} <i>kWh/m²/mes</i>\n              </b>\n            </Col>\n            <Col sm={3} title=\"Tasa de renovación de aire a 50 Pa [1/h]\">\n              <b>\n                <i>\n                  n<sub>50</sub>\n                </i>{\" \"}\n                = {n50.toFixed(2)}{\" \"}\n                <i>\n                  h<sup>-1</sup>\n                </i>\n              </b>\n            </Col>\n          </Row>\n          <Row>\n            <Col\n              sm={3}\n              title=\"Superficie útil de los espacios habitables del edificio o parte del edificio [m²]\"\n            >\n              A<sub>util</sub> = {area_ref.toFixed(2)} m²\n            </Col>\n            <Col\n              sm={3}\n              title=\"Volumen bruto de la envolvente térmica (volumen bruto s-s) [m³]\"\n            >\n              V = {vol_env_gross.toFixed(2)} m³\n            </Col>\n            <Col\n              sm={3}\n              title=\"Volumen interior de la envolvente térmica (volumen neto s-t) [m³]\"\n            >\n              V<sub>int</sub> = {vol_env_net.toFixed(2)} m³\n            </Col>\n            <Col\n              sm={3}\n              title=\"Compacidad de la envolvente térmica (V_tot / A) [m³/m²]\"\n            >\n              V/A = {compactness.toFixed(2)} m³/m²\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n      <Row className=\"my-4\">\n        <Col>\n          <h4>Índice</h4>\n          <ol className=\"indice\">\n            <li onClick={() => kdetail.current.scrollIntoView()}>\n              Transmitancia térmica global (K)\n            </li>\n            <li onClick={() => udetail.current.scrollIntoView()}>\n              Transmitancia térmica de huecos y opacos (U)\n            </li>\n            <li onClick={() => qsoljuldetail.current.scrollIntoView()}>\n              Control solar de los huecos (q<sub>sol;jul</sub>)\n            </li>\n            <li onClick={() => n50detail.current.scrollIntoView()}>\n              Tasa de renovación de aire a 50 Pa (n<sub>50</sub>)\n            </li>\n          </ol>\n        </Col>\n      </Row>\n\n      <hr ref={kdetail} />\n      <KDetail />\n      <hr ref={udetail} />\n      <UDetail />\n      <hr ref={qsoljuldetail} />\n      <QSolJulDetail />\n      <hr ref={n50detail} />\n      <N50Detail />\n      <div id=\"print-head\">\n        <h5>\n          EnvolventeCTE ({APP_VERSION}) - {date.toLocaleString(\"es-ES\")}\n        </h5>\n      </div>\n      {/* <div id=\"print-foot\"></div> */}\n    </>\n  );\n};\n\nexport default observer(He1Report);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext, useRef } from \"react\";\nimport { Table, Col, Row, Button } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport { APP_VERSION } from \"../../version.js\";\n\nimport AppState from \"../../stores/AppState\";\nimport { round_or_dash } from \"../../utils\";\nimport {\n  BOUNDARY_TYPES_MAP,\n  BOUNDARY_TYPES,\n  ORIENTATION_TYPES,\n  SPACE_TYPES,\n  SPACE_TYPES_MAP,\n  LOAD,\n} from \"../../stores/types\";\n\nimport printer from \"../img/print-solid.svg\";\n\nconst QuantitiesReport = () => {\n  const spaces_detail = useRef(null);\n  const opaques_detail = useRef(null);\n  const windows_detail = useRef(null);\n\n  const date = new Date(Date.now());\n\n  const appstate = useContext(AppState);\n\n  const { name } = appstate.meta;\n  const { area_ref, vol_env_net, vol_env_gross, compactness, props } =\n    appstate.energy_indicators;\n\n  let spacesData = computeSpacesRows(props.spaces);\n  let loadsIdMap = appstate.getIdNameMap(LOAD);\n\n  let wallData = computeRows(\n    appstate.cons.wallcons,\n    props.walls,\n    (e) => e.area_net * e.multiplier\n  );\n  let windowData = computeRows(\n    appstate.cons.wincons,\n    props.windows,\n    (e) => e.area * e.multiplier\n  );\n  let shadesData = computeShadesRows(props.shades);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <h2>Mediciones</h2>\n        </Col>\n        <Col md={2} className=\"d-print-none text-end\">\n          <Button\n            variant=\"outline-secondary\"\n            onClick={() => window.print()}\n            title=\"Imprimir\"\n          >\n            <img\n              src={printer}\n              alt=\"Imprimir\"\n              height={25}\n              style={{ fill: \"white\" }}\n            />{\" \"}\n            Imprimir\n          </Button>\n        </Col>\n      </Row>\n      <Row style={{ background: \"whitesmoke\" }} className=\"py-4 my-3\">\n        <Col>\n          <Row>\n            <Col>\n              <h4>Resumen</h4>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={9}>\n              <big>\n                Proyecto: <i>{name}</i>\n              </big>\n            </Col>\n            <Col></Col>\n          </Row>\n          <Row>\n            <Col\n              sm={3}\n              title=\"Superficie útil de los espacios habitables del edificio o parte del edificio [m²]\"\n            >\n              A<sub>util</sub> = {area_ref.toFixed(2)} m²\n            </Col>\n            <Col\n              sm={3}\n              title=\"Volumen bruto de la envolvente térmica (volumen bruto s-s) [m³]\"\n            >\n              V = {vol_env_gross.toFixed(2)} m³\n            </Col>\n            <Col\n              sm={3}\n              title=\"Volumen interior de la envolvente térmica (volumen neto s-t) [m³]\"\n            >\n              V<sub>int</sub> = {vol_env_net.toFixed(2)} m³\n            </Col>\n            <Col\n              sm={3}\n              title=\"Compacidad de la envolvente térmica (V_tot / A) [m³/m²]\"\n            >\n              V/A = {compactness.toFixed(2)} m³/m²\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n      <Row className=\"my-4\">\n        <Col>\n          <h4>Índice</h4>\n          <ol className=\"indice\">\n            <li onClick={() => spaces_detail.current.scrollIntoView()}>\n              Espacios\n            </li>\n            <li onClick={() => opaques_detail.current.scrollIntoView()}>\n              Opacos\n            </li>\n            <li onClick={() => windows_detail.current.scrollIntoView()}>\n              Huecos\n            </li>\n          </ol>\n        </Col>\n      </Row>\n\n      <hr ref={spaces_detail} />\n      <Row className=\"mb-4 print-section\">\n        <Col>\n          <h3 className=\"mb-4\">Espacios</h3>\n          <p>\n            Espacios pertenecientes o no a la envolvente térmica (superficies\n            interiores).\n          </p>\n          <SpacesByConceptTable data={spacesData} loadsIdMap={loadsIdMap} />\n        </Col>\n      </Row>\n\n      <hr ref={opaques_detail} />\n      <Row className=\"mb-4 print-section\">\n        <Col>\n          <h3 className=\"mb-4\">Opacos</h3>\n          <p>\n            Elementos opacos pertenecientes o no a la envolvente térmica\n            (superficies netas).\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col>\n          <h4>Muros, cubiertas, suelos y particiones interiores</h4>\n          <ByConceptTable data={wallData} />\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col>\n          <h4>Elementos de sombra</h4>\n          <ShadesByConceptTable data={shadesData} />\n        </Col>\n      </Row>\n\n      <hr ref={windows_detail} />\n      <Row className=\"mb-4 print-section\">\n        <Col>\n          <h3 className=\"mb-4\">Huecos</h3>\n          <p>Huecos pertenecientes o no a la envolvente térmica.</p>\n        </Col>\n      </Row>\n      <Row className=\"print-section\">\n        <Col>\n          <ByConceptTable data={windowData} />\n        </Col>\n      </Row>\n      <div id=\"print-head\">\n        <h5>\n          EnvolventeCTE ({APP_VERSION}) - {date.toLocaleString(\"es-ES\")}\n        </h5>\n      </div>\n      {/* <div id=\"print-foot\"></div> */}\n    </>\n  );\n};\n\nexport default observer(QuantitiesReport);\n\n// Tabla de desglose de espacios por conceptos: tenv -> nivel_acondic -> cargas\nconst SpacesByConceptTable = ({ data, loadsIdMap }) => {\n  const total_area = data.reduce((acc, e) => (acc += e.area), 0);\n  const total_volume = data.reduce((acc, e) => (acc += e.volume), 0);\n  return (\n    <Table\n      striped\n      bordered\n      hover\n      size=\"sm\"\n      className=\"small\"\n      style={{ margin: \"0 auto\", marginBottom: \"2em\", width: \"70%\" }}\n    >\n      <thead style={{ background: \"lightGray\", verticalAlign: \"top\" }}>\n        <tr>\n          <th>Tipo</th>\n          <th>Nivel de acondicionamiento</th>\n          <th>Perfil de cargas</th>\n          <th className=\"text-center\" colSpan={2} style={{ width: \"20%\" }}>\n            A<br />\n            [m²]\n          </th>\n          <th className=\"text-center\" colSpan={2} style={{ width: \"20%\" }}>\n            V<sub>int</sub>\n            <br />\n            [m³]\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        {data.map((row, idx) => (\n          <React.Fragment key={`${idx}-${row.name}`}>\n            <tr style={{ height: \"1em\" }}></tr>\n            <tr style={{ borderTop: \"2 solid black\" }}>\n              <td>\n                <i>\n                  <b>\n                    {row.inside_tenv ? \"Interior a la ET\" : \"Exterior a la ET\"}\n                  </b>\n                </i>\n              </td>\n              <td></td>\n              <td></td>\n              <td></td>\n              <td className=\"text-center\">\n                <b>{round_or_dash(row.area)}</b>\n              </td>\n              <td></td>\n              <td className=\"text-center\">\n                <b>{round_or_dash(row.volume)}</b>\n              </td>\n            </tr>\n            {row.children.map((row2, idx2) => (\n              <React.Fragment key={`${idx}-${idx2}`}>\n                <tr>\n                  <td></td>\n                  <td>\n                    <i>{SPACE_TYPES_MAP[row2.kind]}</i>\n                  </td>\n                  <td></td>\n                  <td className=\"text-center\">\n                    <u>\n                      <i>{round_or_dash(row2.area)}</i>\n                    </u>\n                  </td>\n                  <td></td>\n                  <td className=\"text-center\">\n                    <u>\n                      <i>{round_or_dash(row2.volume)}</i>\n                    </u>\n                  </td>\n                  <td></td>\n                </tr>\n                {row2.children.map((row3, idx3) => (\n                  <tr key={`${idx}-${idx2}-${idx3}`}>\n                    <td></td>\n                    <td></td>\n                    <td>{loadsIdMap[row3.loads]}</td>\n                    <td className=\"text-center\">{round_or_dash(row3.area)}</td>\n                    <td></td>\n                    <td className=\"text-center\">\n                      {round_or_dash(row3.volume)}\n                    </td>\n                    <td></td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n          </React.Fragment>\n        ))}\n        <tr style={{ height: \"1em\" }}></tr>\n        <tr style={{ background: \"lightGray\" }}>\n          <td>\n            <b>TOTAL</b>\n          </td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td className=\"text-center\">\n            <b>{round_or_dash(total_area)}</b>\n          </td>\n          <td></td>\n          <td className=\"text-center\">\n            <b>{round_or_dash(total_volume)}</b>\n          </td>\n        </tr>\n      </tbody>\n    </Table>\n  );\n};\n\n// Tabla de desglose por conceptos\nconst ByConceptTable = ({ data }) => {\n  const total = data.reduce((acc, e) => (acc += e.area), 0);\n  return (\n    <Table\n      striped\n      bordered\n      hover\n      size=\"sm\"\n      className=\"small\"\n      style={{ margin: \"0 auto\", marginBottom: \"2em\", width: \"70%\" }}\n    >\n      <thead style={{ background: \"lightGray\", verticalAlign: \"top\" }}>\n        <tr>\n          <th>Solución constructiva</th>\n          <th>Condición de contorno</th>\n          <th>Orientación</th>\n          <th className=\"text-center\" colSpan={2} style={{ width: \"20%\" }}>\n            A<br />\n            [m²]\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        {data.map((row, idx) => (\n          <React.Fragment key={`${idx}-${row.name}`}>\n            <tr style={{ height: \"1em\" }}></tr>\n            <tr style={{ borderTop: \"2 solid black\" }}>\n              <td>\n                <i>\n                  <b>{row.name}</b>\n                </i>\n              </td>\n              <td></td>\n              <td></td>\n              <td></td>\n              <td className=\"text-center\">\n                <b>{round_or_dash(row.area)}</b>\n              </td>\n            </tr>\n            {row.children.map((row2, idx2) => (\n              <React.Fragment key={`${idx}-${idx2}`}>\n                <tr>\n                  <td></td>\n                  <td>\n                    <i>{BOUNDARY_TYPES_MAP[row2.bounds]}</i>\n                  </td>\n                  <td></td>\n                  <td className=\"text-center\">\n                    <u>\n                      <i>{round_or_dash(row2.area)}</i>\n                    </u>\n                  </td>\n                  <td></td>\n                </tr>\n                {row2.children.map((row3, idx3) => (\n                  <tr key={`${idx}-${idx2}-${idx3}`}>\n                    <td></td>\n                    <td></td>\n                    <td>{row3.orientation}</td>\n                    <td className=\"text-center\">{round_or_dash(row3.area)}</td>\n                    <td></td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n          </React.Fragment>\n        ))}\n        <tr style={{ height: \"1em\" }}></tr>\n        <tr style={{ background: \"lightGray\" }}>\n          <td>\n            <b>TOTAL</b>\n          </td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td className=\"text-center\">\n            <b>{round_or_dash(total)}</b>\n          </td>\n        </tr>\n      </tbody>\n    </Table>\n  );\n};\n\n// Tabla de desglose por conceptos\nconst ShadesByConceptTable = ({ data }) => {\n  const total = data.reduce((acc, e) => (acc += e.area), 0);\n  return (\n    <Table\n      striped\n      bordered\n      hover\n      size=\"sm\"\n      className=\"small\"\n      style={{ margin: \"0 auto\", marginBottom: \"2em\", width: \"70%\" }}\n    >\n      <thead style={{ background: \"lightGray\", verticalAlign: \"top\" }}>\n        <tr>\n          <th>Condición de contorno</th>\n          <th>Orientación</th>\n          <th className=\"text-center\" style={{ width: \"20%\" }}>\n            A<br />\n            [m²]\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>\n            <b>Elementos de sombra</b>\n          </td>\n          <td></td>\n          <td className=\"text-center\">\n            <b>{round_or_dash(total)}</b>\n          </td>\n        </tr>\n        {data.map((row, idx) => (\n          <tr key={idx}>\n            <td></td>\n            <td>{row.orientation}</td>\n            <td className=\"text-center\">{round_or_dash(row.area)}</td>\n          </tr>\n        ))}\n        <tr style={{ height: \"1em\" }}></tr>\n        <tr style={{ background: \"lightGray\" }}>\n          <td>\n            <b>TOTAL</b>\n          </td>\n          <td></td>\n          <td className=\"text-center\">\n            <b>{round_or_dash(total)}</b>\n          </td>\n        </tr>\n      </tbody>\n    </Table>\n  );\n};\n\nfunction computeSpacesRows(props) {\n  const spaceLoads = [...new Set(Object.values(props).map((e) => e.loads))];\n  let data = [];\n  for (const inside_tenv of [true, false]) {\n    const tenvTotal = { inside_tenv, area: 0, volume: 0, children: [] };\n    for (const kind of SPACE_TYPES) {\n      const spaceTypeTotal = { kind, area: 0, volume: 0, children: [] };\n      for (const loads of spaceLoads) {\n        const spaceLoadsTotal = { loads, area: 0, volume: 0 };\n        const selected = Object.values(props).filter(\n          (w) =>\n            w.kind === kind &&\n            w.inside_tenv === inside_tenv &&\n            w.loads === loads\n        );\n        for (const elem of selected) {\n          const area = elem.area * elem.multiplier;\n          const volume = elem.volume_net * elem.multiplier;\n          tenvTotal.area += area;\n          spaceTypeTotal.area += area;\n          spaceLoadsTotal.area += area;\n          tenvTotal.volume += volume;\n          spaceTypeTotal.volume += volume;\n          spaceLoadsTotal.volume += volume;\n        }\n        if (spaceLoadsTotal.area > 0.01) {\n          spaceTypeTotal.children.push(spaceLoadsTotal);\n        }\n      }\n      if (spaceTypeTotal.area > 0.01) {\n        tenvTotal.children.push(spaceTypeTotal);\n      }\n    }\n    if (tenvTotal.area > 0.01) {\n      data.push(tenvTotal);\n    }\n  }\n  return data;\n}\n\nfunction computeRows(cons, props, adder = () => 1) {\n  let data = [];\n  for (const wc of cons) {\n    const id = wc.id;\n    const name = wc.name;\n    const consTotal = { name, area: 0, children: [] };\n    for (const bounds of BOUNDARY_TYPES) {\n      const boundTotal = { bounds, area: 0, children: [] };\n      for (const orientation of ORIENTATION_TYPES) {\n        const orientTotal = { orientation, area: 0 };\n        const selected = Object.values(props).filter(\n          (w) =>\n            w.orientation === orientation &&\n            w.bounds === bounds &&\n            w.cons === id\n        );\n        for (const elem of selected) {\n          const area = adder(elem);\n          consTotal.area += area;\n          boundTotal.area += area;\n          orientTotal.area += area;\n        }\n        if (orientTotal.area > 0.01) {\n          boundTotal.children.push(orientTotal);\n        }\n      }\n      if (boundTotal.area > 0.01) {\n        consTotal.children.push(boundTotal);\n      }\n    }\n    if (consTotal.area > 0.01) {\n      data.push(consTotal);\n    }\n  }\n  return data;\n}\n\nfunction computeShadesRows(props) {\n  let data = [];\n  for (const orientation of ORIENTATION_TYPES) {\n    const orientTotal = { orientation, area: 0 };\n    const selected = Object.values(props).filter(\n      (w) => w.orientation === orientation\n    );\n    for (const elem of selected) {\n      const area = elem.area;\n      orientTotal.area += area;\n    }\n    if (orientTotal.area > 0.01) {\n      data.push(orientTotal);\n    }\n  }\n  return data;\n}\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row, Tab, Tabs } from \"react-bootstrap\";\n\nimport { Page } from \"../ui/Page\";\nimport He1Report from \"./He1Report\";\nimport QuantitiesReport from \"./QuantitiesReport\";\n\nconst ReportsPage = ({ route, activeKey, setActiveKey }) => {\n  return (\n    <Page route={route}>\n      <Row>\n        <Col>\n          <Tabs\n            activeKey={activeKey}\n            onSelect={setActiveKey}\n            id=\"building_element_tabs\"\n            className=\"d-print-none\"\n          >\n            <Tab eventKey=\"he1\" title=\"HE1\" className=\"pt-3\">\n              <He1Report />\n            </Tab>\n            <Tab eventKey=\"quantities\" title=\"Mediciones\" className=\"pt-3\">\n              <QuantitiesReport />\n            </Tab>\n          </Tabs>\n        </Col>\n      </Row>\n    </Page>\n  );\n};\n\nexport default ReportsPage;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { observer } from \"mobx-react\";\nimport { Form, Row, Col } from \"react-bootstrap\";\n\nimport AppState from \"../../stores/AppState\";\n\nconst ClimateSelector = observer(({ ...props }) => {\n  const appstate = useContext(AppState);\n  return (\n    <Form.Group as={Row}>\n      <Col as={Form.Label} md={4} style={props.labelStyle}>\n        Zona Climática\n      </Col>\n      <Col md={8}>\n        <Form.Select\n          id=\"climateselector\"\n          value={appstate?.meta?.climate || \"\"}\n          onChange={(e) => {\n            appstate.meta.climate = e.target.value;\n          }}\n          placeholder=\"Zona climática\"\n        >\n          {appstate.zoneslist.map((z) => (\n            <option value={z} key={\"zone_\" + z}>\n              {z}\n            </option>\n          ))}\n        </Form.Select>\n      </Col>\n    </Form.Group>\n  );\n});\n\nexport default ClimateSelector;\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Form } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\nimport ClimateSelector from \"./ClimateSelector\";\n\n// Vista de elementos de sombra del edificio\nexport const ProjectData = observer(() => {\n  const appstate = useContext(AppState);\n  const meta = appstate.meta;\n\n  return (\n    <Row className=\"well\">\n      <Col>\n        <h4>Datos generales</h4>\n        <Form>\n          <Form.Group as={Row} controlId=\"formControlsName\">\n            <Form.Label column md={4}>\n              <b>Nombre del proyecto</b>\n            </Form.Label>{\" \"}\n            <Col md={8}>\n              <Form.Control\n                value={meta.name || \"Edificio\"}\n                onChange={(e) => (meta.name = e.target.value)}\n                placeholder=\"Nombre del proyecto\"\n              />\n            </Col>\n          </Form.Group>\n        </Form>\n        <h5>Clima</h5>\n        <ClimateSelector\n          labelStyle={{ color: \"inherit\" }}\n          className=\"mr-auto\"\n        />\n\n        <h5>Uso</h5>\n        <Form>\n          <Form.Check\n            checked={meta.is_new_building}\n            onChange={() => (meta.is_new_building = !meta.is_new_building)}\n            type=\"checkbox\"\n            label=\"Nueva construcción\"\n          />\n          <Form.Check\n            checked={meta.is_dwelling}\n            onChange={() => (meta.is_dwelling = !meta.is_dwelling)}\n            type=\"checkbox\"\n            label=\"Uso residencial privado (vivienda)\"\n          />\n          {meta.is_dwelling ? (\n            <Form.Group as={Row} controlId=\"formControlsNumberOfDwellings\">\n              <Form.Label column md={4}>\n                Número de viviendas\n              </Form.Label>{\" \"}\n              <Col md={8}>\n                <Form.Control\n                  type=\"number\"\n                  value={meta.num_dwellings}\n                  onChange={(e) =>\n                    (meta.num_dwellings = Number(\n                      e.target.value.replace(\",\", \".\")\n                    ))\n                  }\n                  placeholder=\"1\"\n                />\n              </Col>\n            </Form.Group>\n          ) : null}\n        </Form>\n\n        <h5>Ventilación e infiltraciones</h5>\n        <Form>\n          <Form.Check\n            checked={meta.n50_test_ach !== null}\n            onChange={(e) => {\n              if (e.target.checked === false) {\n                meta.n50_test_ach = null;\n              } else {\n                meta.n50_test_ach = 0.0;\n              }\n            }}\n            type=\"checkbox\"\n            label=\"Ensayo de puerta soplante disponible\"\n          />\n          {meta.n50_test_ach !== null ? (\n            <Form.Group as={Row} controlId=\"formControlsn50\">\n              <Form.Label column md={4}>\n                Tasa de intercambio de aire a 50 Pa (n<sub>50</sub>) obtenida de\n                ensayo (renh)\n              </Form.Label>{\" \"}\n              <Col md={8}>\n                <Form.Control\n                  type=\"number\"\n                  defaultValue={meta.n50_test_ach}\n                  onChange={(e) => {\n                    meta.n50_test_ach = Number(\n                      e.target.value.replace(\",\", \".\")\n                    );\n                  }}\n                  placeholder=\"0.0\"\n                  step=\"0.01\"\n                />\n              </Col>\n            </Form.Group>\n          ) : null}\n          {meta.is_dwelling ? (\n            <Form.Group as={Row} controlId=\"formControlsGlobalVentilation\">\n              <Form.Label column md={4}>\n                Ventilación global de diseño del edificio (l/s)\n              </Form.Label>{\" \"}\n              <Col md={8}>\n                <Form.Control\n                  type=\"number\"\n                  value={meta.global_ventilation_l_s || 0}\n                  onChange={(e) =>\n                    (meta.global_ventilation_l_s = Number(\n                      e.target.value.replace(\",\", \".\")\n                    ))\n                  }\n                  placeholder=\"0.0\"\n                  step=\"0.1\"\n                />\n              </Col>\n            </Form.Group>\n          ) : null}\n        </Form>\n\n        <h5>Aislamiento perimetral en soleras</h5>\n        <Form>\n          <Form.Group as={Row} controlId=\"formControls_d_perim_insulation\">\n            <Form.Label column md={4}>\n              Ancho del aislamiento perimetral (m)\n            </Form.Label>{\" \"}\n            <Col md={8}>\n              <Form.Control\n                type=\"number\"\n                value={meta.d_perim_insulation || 0.0}\n                onChange={(e) => {\n                  meta.d_perim_insulation = Number(\n                    e.target.value.replace(\",\", \".\")\n                  );\n                }}\n                placeholder=\"0.0\"\n                step=\"0.01\"\n              />\n            </Col>\n          </Form.Group>\n          <Form.Group as={Row} controlId=\"formControls_rn_perim_insulation\">\n            <Form.Label column md={4}>\n              Resistencia térmica del aislamiento perimetral (m²K/W)\n            </Form.Label>{\" \"}\n            <Col md={8}>\n              <Form.Control\n                type=\"number\"\n                value={meta.rn_perim_insulation || 0.0}\n                onChange={(e) => {\n                  meta.rn_perim_insulation = Number(\n                    e.target.value.replace(\",\", \".\")\n                  );\n                }}\n                placeholder=\"0.0\"\n                step=\"0.01\"\n              />\n            </Col>\n          </Form.Group>\n        </Form>\n      </Col>\n    </Row>\n  );\n});\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n// Área de arrastrar y soltar https://react-dropzone.js.org/\n\nimport React, { useMemo } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\n\nconst baseStyle = {\n  flex: 1,\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\",\n  padding: \"20px\",\n  borderWidth: 2,\n  borderRadius: 2,\n  borderColor: \"#eeeeee\",\n  borderStyle: \"dashed\",\n  backgroundColor: \"lavender\",\n  color: \"midnightblue\",\n  outline: \"none\",\n  transition: \"border .24s ease-in-out\",\n  height: \"100%\",\n};\n\nconst activeStyle = {\n  borderColor: \"#2196f3\",\n};\n\nconst acceptStyle = {\n  borderColor: \"#00e676\",\n};\n\nconst rejectStyle = {\n  borderColor: \"#ff1744\",\n};\n\nexport default function StyledDropzone(props) {\n  const {\n    onDrop,\n    message = (\n      <p>\n        Arrastre y suelte aquí el archivo o pulse para seleccionarlo del equipo\n      </p>\n    ),\n    accept = { \"application/json\": [\".json\"] },\n    maxFiles = 1,\n    title = \"Arrastre un archivo sobre esta zona o pulse para seleccionar del sistema de archivos.\",\n  } = props;\n  const {\n    fileRejections,\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    isDragAccept,\n    isDragReject,\n  } = useDropzone({ accept, maxFiles, onDrop });\n\n  const style = useMemo(\n    () => ({\n      ...baseStyle,\n      ...(isDragActive ? activeStyle : {}),\n      ...(isDragAccept ? acceptStyle : {}),\n      ...(isDragReject ? rejectStyle : {}),\n    }),\n    [isDragActive, isDragReject, isDragAccept]\n  );\n\n  const fileRejectionItems = fileRejections.map(({ file, errors }) => (\n    <li key={file.path}>\n      {file.path} - {file.size} bytes\n      <ul>\n        {errors.map((e) => (\n          <li key={e.code}>{e.message}</li>\n        ))}\n      </ul>\n    </li>\n  ));\n\n  return (\n    <div\n      className=\"container\"\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        height: \"100%\",\n      }}\n      title={title}\n    >\n      <div {...getRootProps({ style })}>\n        <input {...getInputProps()} />\n        {message}\n      </div>\n      {fileRejections.length === 0 ? null : (\n        <aside>\n          <p>Archivos con formato incorrecto:</p>\n          <ul>{fileRejectionItems}</ul>\n        </aside>\n      )}\n    </div>\n  );\n}\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext, useState } from \"react\";\nimport { Col, Form, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport Dropzone from \"../ui/DropZone.js\";\n\n// Vista de elementos de sombra del edificio\nexport const HulcImport = observer(() => {\n  const appstate = useContext(AppState);\n  const [purge, setPurge] = useState(false);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <p className=\"lead\">\n            Importación de un nuevo modelo o de los factores de sombras remotas\n            desde archivo de HULC\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"my-3\">\n        <Col>\n          <p>\n            Arrastre y suelte en el área inferior o pulse para importar datos\n            desde un archivo <b>.ctehexml</b> de HULC.\n          </p>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Dropzone\n            onDrop={(acceptedFiles, _rejectedFiles, _event) =>\n              appstate.handleUpload(acceptedFiles, purge)\n            }\n            accept={{ \"application/octet-stream\": [\".ctehexml\"] }}\n            message={\n              <>\n                <h3>Importación .ctehexml de HULC</h3>\n                <p className=\"text-center\">\n                  Importar y cargar nuevo modelo desde un archivo{\" \"}\n                  <i>.ctehexml</i> de HULC\n                </p>\n              </>\n            }\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Form>\n            <Form.Group>\n              <Form.Check\n                checked={purge}\n                onChange={(_e) => setPurge(!purge)}\n                label=\"Purga del modelo los elementos no utilizados\"\n                className=\"mx-auto small\"\n              />\n            </Form.Group>\n          </Form>\n        </Col>\n      </Row>\n      <Row className=\"my-3\">\n        <Col>\n          <p>\n            Arrastre y suelte en el área inferior o pulse para importar los\n            factores de sombras remotas al modelo ya cargado desde un archivo{\" \"}\n            <b>KyGananciasSolares.txt</b> de HULC. Se sustituirán los valores\n            correspondientes de los huecos.\n          </p>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Dropzone\n            onDrop={(acceptedFiles, _rejectedFiles, _event) =>\n              appstate.handleUpload(acceptedFiles)\n            }\n            accept={{ \"text/plain\": [\".txt\"] }}\n            message={\n              <>\n                <h3>Archivo KyGananciasSolares.txt de HULC</h3>\n                <p className=\"text-center\">\n                  Importa datos del factor de sombras remotas, F\n                  <sub>sh;obst</sub>, desde el archivo{\" \"}\n                  <i>KyGananciasSolares.txt</i>\n                </p>\n              </>\n            }\n          />\n        </Col>\n      </Row>\n    </>\n  );\n});\n","export default __webpack_public_path__ + \"static/media/outline-new_document-24px.18312c4b.svg\";","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext } from \"react\";\nimport { Col, Row, Button } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport iconclearmodel from \"../img/outline-new_document-24px.svg\";\n\n// Limpiar datos del modelo\nexport const EmptyModel = observer(() => {\n  const appstate = useContext(AppState);\n\n  return (\n    <>\n      <Row>\n        <Col>\n          <p className=\"lead\">Vaciar modelo actual</p>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <p>\n            Pulse este botón para partir de un modelo vacío en el que introducir\n            de cero los elementos de la envolvente térmica:\n          </p>\n          <div className=\"d-grid\">\n            <Button\n              variant=\"secondary\"\n              onClick={(_e) => appstate.clearModel()}\n              title=\"Pulse para dejar el modelo actual vacío, sin elementos definidos\"\n              style={{\n                fontSize: 20,\n                height: 50,\n                marginTop: 20,\n                marginBottom: 20,\n              }}\n            >\n              <img src={iconclearmodel} alt=\"Limpiar modelo\" /> Modelo vacío\n            </Button>\n          </div>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <div className=\"d-grid\">\n            <Button\n              variant=\"secondary\"\n              onClick={(_e) => appstate.purgeModel()}\n              title=\"Pulse para limpiar los elementos no usados del modelo\"\n              style={{\n                fontSize: 20,\n                height: 50,\n                marginTop: 20,\n                marginBottom: 20,\n              }}\n            >\n              Purga elementos no utilizados del modelo\n            </Button>\n          </div>\n        </Col>\n      </Row>\n    </>\n  );\n});\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useContext, useState } from \"react\";\nimport { Col, Form, Row } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport AppState from \"../../stores/AppState\";\n\nimport Dropzone from \"../ui/DropZone.js\";\n\n// Vista de elementos de sombra del edificio\nexport const LoadData = observer(() => {\n  const appstate = useContext(AppState);\n  const [purge, setPurge] = useState(false);\n\n  const dropHeight = \"100px\";\n  return (\n    <>\n      <Row>\n        <Col>\n          <p className=\"lead\">\n            Carga de datos desde un archivo de EnvolventeCTE\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"my-3\">\n        <Col>\n          <p>\n            Arrastre y suelte en el área inferior o pulse para importar datos\n            desde un archivo <b>.json</b> generado anteriormente por\n            EnvolventeCTE.\n          </p>\n        </Col>\n      </Row>\n      <Row className=\"my-3\">\n        <Col>\n          <Dropzone\n            onDrop={(acceptedFiles, _rejectedFiles, _event) =>\n              appstate.handleUpload(acceptedFiles, purge)\n            }\n            accept={{ \"application/json\": [\".json\"] }}\n            message={\n              <>\n                <h3>EnvolventeCTE</h3>\n                <p className=\"text-center\">\n                  Importar modelo nuevo desde archivo <i>.json</i>\n                </p>\n              </>\n            }\n            containerHeight={dropHeight}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Form>\n            <Form.Group>\n              <Form.Check\n                checked={purge}\n                onChange={(_e) => setPurge(!purge)}\n                label=\"Purga del modelo los elementos no utilizados\"\n                className=\"mx-auto small\"\n              />\n            </Form.Group>\n          </Form>\n        </Col>\n      </Row>\n    </>\n  );\n});\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React from \"react\";\nimport { Col, Row, Tabs, Tab } from \"react-bootstrap\";\nimport { observer } from \"mobx-react\";\n\nimport { PageWithIndicators } from \"../ui/PageWithIndicators\";\nimport { ProjectData } from \"./ProjectData\";\nimport { HulcImport } from \"./HulcImport\";\nimport { EmptyModel } from \"./EmptyModel\";\nimport { LoadData } from \"./LoadData\";\n\nexport const ProjectPage = observer(({ route, activeKey, setActiveKey }) => {\n  return (\n    <PageWithIndicators route={route}>\n      <Row className=\"well\">\n        <Col>\n          <Tabs activeKey={activeKey} onSelect={setActiveKey} id=\"project_tabs\">\n            <Tab eventKey=\"metadata\" title=\"Datos generales\" className=\"pt-3\">\n              <ProjectData />\n            </Tab>\n            <Tab eventKey=\"load\" title=\"Cargar datos\" className=\"pt-3\">\n              <LoadData />\n            </Tab>\n            <Tab\n              eventKey=\"hulc_import\"\n              title=\"Importar desde HULC\"\n              className=\"pt-3\"\n            >\n              <HulcImport />\n            </Tab>\n            <Tab eventKey=\"clear\" title=\"Vaciar modelo\" className=\"pt-3\">\n              <EmptyModel />\n            </Tab>\n          </Tabs>\n        </Col>\n      </Row>\n    </PageWithIndicators>\n  );\n});\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport { observer } from \"mobx-react\";\nimport React, { useContext } from \"react\";\nimport { Col, Row } from \"react-bootstrap\";\nimport AppState from \"../stores/AppState.js\";\n\nimport { Page } from \"./ui/Page.js\";\n\nconst JsonDetail = () => {\n  const appstate = useContext(AppState);\n\n  return (\n    <Page>\n      <Row>\n        <Col md={6}>\n          <h3>Modelo:</h3>\n          <pre>{JSON.stringify(appstate.getModel(), undefined, 2)}</pre>\n        </Col>\n        <Col md={6}>\n          <h3>Indicadores energéticos:</h3>\n          <pre>{JSON.stringify(appstate.energy_indicators, undefined, 2)}</pre>\n        </Col>\n      </Row>\n    </Page>\n  );\n};\n\nexport default observer(JsonDetail);\n","/* -*- coding: utf-8 -*-\n\nCopyright (c) 2016-2022 Rafael Villar Burke <pachi@rvburke.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { HashRouter, Navigate, Route, Routes } from \"react-router-dom\";\nimport { observer } from \"mobx-react\";\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n// import \"bootstrap/dist/css/bootstrap-theme.css\";\nimport \"react-bootstrap-table-next/dist/react-bootstrap-table2.min.css\";\n\nimport GuiState from \"../stores/GuiState\";\n\nimport AboutPage from \"./about/AboutPage\";\nimport { BuildingPage } from \"./building/BuildingPage\";\nimport { UsesPage } from \"./uses/UsesPage\";\nimport ConsPage from \"./constructions/ConsPage\";\nimport ThreeDPage from \"./three/ThreeDPage\";\nimport HelpersPage from \"./helpers/HelpersPage\";\nimport HelpPage from \"./help/HelpPage\";\nimport MainPage from \"./main/MainPage\";\nimport ReportsPage from \"./reports/ReportsPage\";\nimport { ProjectPage } from \"./project/ProjectPage\";\nimport JsonDetail from \"./JsonDetail\";\n\nconst App = () => {\n  const [projectActiveKey, setProjectActiveKey] = useState(\"metadata\");\n  const [buildingActiveKey, setBuildingActiveKey] = useState(\"spaces\");\n  const [consActiveKey, setConsActiveKey] = useState(\"wallcons\");\n  const [usesActiveKey, setUsesActiveKey] = useState(\"loads\");\n  const [reportActiveKey, setReportActiveKey] = useState(\"he1\");\n  const [helpersActiveKey, setHelpersActiveKey] = useState(\"winproperties\");\n\n  const guiState = useContext(GuiState);\n\n  // Manejador de teclado para mostrar pestañas con JSON\n  // https://stackoverflow.com/questions/55565444/how-to-register-event-with-useeffect-hooks\n  const handleUserKeyPress = useCallback((e) => {\n    if (e.ctrlKey && e.altKey && e.key === \"h\") {\n      guiState.toggleShowJsonTab();\n    }\n  }, []);\n  useEffect(() => {\n    window.addEventListener(\"keydown\", handleUserKeyPress);\n    return () => {\n      window.removeEventListener(\"keydown\", handleUserKeyPress);\n    };\n  }, [handleUserKeyPress]);\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route exact path=\"/\" element={<MainPage />} />\n        <Route\n          exact\n          path=\"/project\"\n          element={\n            <ProjectPage\n              activeKey={projectActiveKey}\n              setActiveKey={setProjectActiveKey}\n            />\n          }\n        />\n        <Route\n          exact\n          path=\"/elements\"\n          element={\n            <BuildingPage\n              activeKey={buildingActiveKey}\n              setActiveKey={setBuildingActiveKey}\n            />\n          }\n        />\n        <Route\n          exact\n          path=\"/constructions\"\n          element={\n            <ConsPage\n              activeKey={consActiveKey}\n              setActiveKey={setConsActiveKey}\n            />\n          }\n        />\n        <Route\n          exact\n          path=\"/uses\"\n          element={\n            <UsesPage\n              activeKey={usesActiveKey}\n              setActiveKey={setUsesActiveKey}\n            />\n          }\n        />\n        <Route exact path=\"/3d\" element={<ThreeDPage />} />\n        <Route\n          exact\n          path=\"/reports\"\n          element={\n            <ReportsPage\n              activeKey={reportActiveKey}\n              setActiveKey={setReportActiveKey}\n            />\n          }\n        />\n        <Route\n          exact\n          path=\"/helpers\"\n          element={\n            <HelpersPage\n              activeKey={helpersActiveKey}\n              setActiveKey={setHelpersActiveKey}\n            />\n          }\n        />\n        {guiState.showJsonTab && (\n          <Route exact path=\"/detail\" element={<JsonDetail />} />\n        )}\n        <Route exact path=\"/help\" element={<HelpPage />} />\n        <Route exact path=\"/about\" element={<AboutPage />} />\n        <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n      </Routes>\n    </HashRouter>\n  );\n};\n\nexport default observer(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\nimport \"./index.css\";\n\nimport { set_panic_hook, set_log_hook } from \"wasm-envolventecte\";\n\nset_panic_hook();\nset_log_hook(\"warn\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","import * as wasm from './wasm_envolventecte_bg.wasm';\n\nlet cachedTextDecoder = new TextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n\ncachedTextDecoder.decode();\n\nlet cachegetUint8Memory0 = null;\nfunction getUint8Memory0() {\n    if (cachegetUint8Memory0 === null || cachegetUint8Memory0.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nconst heap = new Array(32).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nlet heap_next = heap.length;\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet WASM_VECTOR_LEN = 0;\n\nlet cachedTextEncoder = new TextEncoder('utf-8');\n\nconst encodeString = (typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n    return cachedTextEncoder.encodeInto(arg, view);\n}\n    : function (arg, view) {\n    const buf = cachedTextEncoder.encode(arg);\n    view.set(buf);\n    return {\n        read: arg.length,\n        written: buf.length\n    };\n});\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length);\n        getUint8Memory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len);\n\n    const mem = getUint8Memory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3);\n        const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n        const ret = encodeString(arg, view);\n\n        offset += ret.written;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n\nlet cachegetInt32Memory0 = null;\nfunction getInt32Memory0() {\n    if (cachegetInt32Memory0 === null || cachegetInt32Memory0.buffer !== wasm.memory.buffer) {\n        cachegetInt32Memory0 = new Int32Array(wasm.memory.buffer);\n    }\n    return cachegetInt32Memory0;\n}\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n/**\n* @returns {string}\n*/\nexport function get_version() {\n    try {\n        const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n        wasm.get_version(retptr);\n        var r0 = getInt32Memory0()[retptr / 4 + 0];\n        var r1 = getInt32Memory0()[retptr / 4 + 1];\n        return getStringFromWasm0(r0, r1);\n    } finally {\n        wasm.__wbindgen_add_to_stack_pointer(16);\n        wasm.__wbindgen_free(r0, r1);\n    }\n}\n\n/**\n*/\nexport function set_panic_hook() {\n    wasm.set_panic_hook();\n}\n\n/**\n* @param {string} level\n*/\nexport function set_log_hook(level) {\n    var ptr0 = passStringToWasm0(level, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    wasm.set_log_hook(ptr0, len0);\n}\n\n/**\n* Carga datos de radiación acumulada mensual\n* @returns {any}\n*/\nexport function get_monthly_radiation_data() {\n    var ret = wasm.get_monthly_radiation_data();\n    return takeObject(ret);\n}\n\nlet stack_pointer = 32;\n\nfunction addBorrowedObject(obj) {\n    if (stack_pointer == 1) throw new Error('out of js stack');\n    heap[--stack_pointer] = obj;\n    return stack_pointer;\n}\n/**\n* Calcula indicadores de HE1\n* @param {any} model_js\n* @returns {any}\n*/\nexport function energy_indicators(model_js) {\n    try {\n        var ret = wasm.energy_indicators(addBorrowedObject(model_js));\n        return takeObject(ret);\n    } finally {\n        heap[stack_pointer++] = undefined;\n    }\n}\n\n/**\n* Carga datos desde cadena de texto JSON\n* @param {string} data\n* @param {boolean} purge_unused\n* @returns {any}\n*/\nexport function load_data_from_json(data, purge_unused) {\n    var ptr0 = passStringToWasm0(data, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    var ret = wasm.load_data_from_json(ptr0, len0, purge_unused);\n    return takeObject(ret);\n}\n\n/**\n* Carga datos desde cadena de texto .ctehexml\n* @param {string} data\n* @param {boolean} purge_unused\n* @returns {any}\n*/\nexport function load_data_from_ctehexml(data, purge_unused) {\n    var ptr0 = passStringToWasm0(data, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    var ret = wasm.load_data_from_ctehexml(ptr0, len0, purge_unused);\n    return takeObject(ret);\n}\n\n/**\n* Carga datos desde cadena de texto KyGananciasSolares.txt\n* @param {string} data\n* @returns {any}\n*/\nexport function load_fshobst_data_from_kyg(data) {\n    var ptr0 = passStringToWasm0(data, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    var ret = wasm.load_fshobst_data_from_kyg(ptr0, len0);\n    return takeObject(ret);\n}\n\n/**\n* Limpia modelo de elementos no usados\n* @param {any} model_js\n* @returns {any}\n*/\nexport function purge_unused(model_js) {\n    try {\n        var ret = wasm.purge_unused(addBorrowedObject(model_js));\n        return takeObject(ret);\n    } finally {\n        heap[stack_pointer++] = undefined;\n    }\n}\n\n/**\n* Espacio por defecto\n* @returns {any}\n*/\nexport function new_space() {\n    var ret = wasm.new_space();\n    return takeObject(ret);\n}\n\n/**\n* Opaco por defecto\n* @returns {any}\n*/\nexport function new_wall() {\n    var ret = wasm.new_wall();\n    return takeObject(ret);\n}\n\n/**\n* Hueco por defecto\n* @returns {any}\n*/\nexport function new_window() {\n    var ret = wasm.new_window();\n    return takeObject(ret);\n}\n\n/**\n* Sombra por defecto\n* @returns {any}\n*/\nexport function new_shade() {\n    var ret = wasm.new_shade();\n    return takeObject(ret);\n}\n\n/**\n* Puente térmico por defecto\n* @returns {any}\n*/\nexport function new_thermalbridge() {\n    var ret = wasm.new_thermalbridge();\n    return takeObject(ret);\n}\n\n/**\n* Construcción de opaco por defecto\n* @returns {any}\n*/\nexport function new_wallcons() {\n    var ret = wasm.new_wallcons();\n    return takeObject(ret);\n}\n\n/**\n* Construcción de hueco por defecto\n* @returns {any}\n*/\nexport function new_wincons() {\n    var ret = wasm.new_wincons();\n    return takeObject(ret);\n}\n\n/**\n* Material de opaco por defecto\n* @returns {any}\n*/\nexport function new_material() {\n    var ret = wasm.new_material();\n    return takeObject(ret);\n}\n\n/**\n* Vidrio por defecto\n* @returns {any}\n*/\nexport function new_glass() {\n    var ret = wasm.new_glass();\n    return takeObject(ret);\n}\n\n/**\n* Marco por defecto\n* @returns {any}\n*/\nexport function new_frame() {\n    var ret = wasm.new_frame();\n    return takeObject(ret);\n}\n\n/**\n* Metadatos por defecto\n* @returns {any}\n*/\nexport function new_meta() {\n    var ret = wasm.new_meta();\n    return takeObject(ret);\n}\n\n/**\n* Carga por defecto\n* @returns {any}\n*/\nexport function new_load() {\n    var ret = wasm.new_load();\n    return takeObject(ret);\n}\n\n/**\n* Consignas por defecto\n* @returns {any}\n*/\nexport function new_thermostat() {\n    var ret = wasm.new_thermostat();\n    return takeObject(ret);\n}\n\n/**\n* Horario diario por defecto\n* @returns {any}\n*/\nexport function new_schedule_day() {\n    var ret = wasm.new_schedule_day();\n    return takeObject(ret);\n}\n\n/**\n* Horario semanal por defecto\n* @returns {any}\n*/\nexport function new_schedule_week() {\n    var ret = wasm.new_schedule_week();\n    return takeObject(ret);\n}\n\n/**\n* Horario anual por defecto\n* @returns {any}\n*/\nexport function new_schedule_year() {\n    var ret = wasm.new_schedule_year();\n    return takeObject(ret);\n}\n\nfunction handleError(f, args) {\n    try {\n        return f.apply(this, args);\n    } catch (e) {\n        wasm.__wbindgen_exn_store(addHeapObject(e));\n    }\n}\n\nfunction getArrayU8FromWasm0(ptr, len) {\n    return getUint8Memory0().subarray(ptr / 1, ptr / 1 + len);\n}\n\nexport function __wbindgen_json_parse(arg0, arg1) {\n    var ret = JSON.parse(getStringFromWasm0(arg0, arg1));\n    return addHeapObject(ret);\n};\n\nexport function __wbindgen_json_serialize(arg0, arg1) {\n    const obj = getObject(arg1);\n    var ret = JSON.stringify(obj === undefined ? null : obj);\n    var ptr0 = passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len0;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n};\n\nexport function __wbindgen_string_new(arg0, arg1) {\n    var ret = getStringFromWasm0(arg0, arg1);\n    return addHeapObject(ret);\n};\n\nexport function __wbg_new_59cb74e423758ede() {\n    var ret = new Error();\n    return addHeapObject(ret);\n};\n\nexport function __wbg_stack_558ba5917b466edd(arg0, arg1) {\n    var ret = getObject(arg1).stack;\n    var ptr0 = passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len0;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n};\n\nexport function __wbg_error_4bb6c2a97407129a(arg0, arg1) {\n    try {\n        console.error(getStringFromWasm0(arg0, arg1));\n    } finally {\n        wasm.__wbindgen_free(arg0, arg1);\n    }\n};\n\nexport function __wbindgen_object_drop_ref(arg0) {\n    takeObject(arg0);\n};\n\nexport function __wbg_process_70251ed1291754d5(arg0) {\n    var ret = getObject(arg0).process;\n    return addHeapObject(ret);\n};\n\nexport function __wbindgen_is_object(arg0) {\n    const val = getObject(arg0);\n    var ret = typeof(val) === 'object' && val !== null;\n    return ret;\n};\n\nexport function __wbg_versions_b23f2588cdb2ddbb(arg0) {\n    var ret = getObject(arg0).versions;\n    return addHeapObject(ret);\n};\n\nexport function __wbg_node_61b8c9a82499895d(arg0) {\n    var ret = getObject(arg0).node;\n    return addHeapObject(ret);\n};\n\nexport function __wbindgen_is_string(arg0) {\n    var ret = typeof(getObject(arg0)) === 'string';\n    return ret;\n};\n\nexport function __wbg_require_2a93bc09fee45aca() { return handleError(function (arg0, arg1, arg2) {\n    var ret = getObject(arg0).require(getStringFromWasm0(arg1, arg2));\n    return addHeapObject(ret);\n}, arguments) };\n\nexport function __wbg_crypto_2f56257a38275dbd(arg0) {\n    var ret = getObject(arg0).crypto;\n    return addHeapObject(ret);\n};\n\nexport function __wbg_msCrypto_d07655bf62361f21(arg0) {\n    var ret = getObject(arg0).msCrypto;\n    return addHeapObject(ret);\n};\n\nexport function __wbg_getRandomValues_fb6b088efb6bead2() { return handleError(function (arg0, arg1) {\n    getObject(arg0).getRandomValues(getObject(arg1));\n}, arguments) };\n\nexport function __wbg_static_accessor_NODE_MODULE_33b45247c55045b0() {\n    var ret = module;\n    return addHeapObject(ret);\n};\n\nexport function __wbg_randomFillSync_654a7797990fb8db() { return handleError(function (arg0, arg1, arg2) {\n    getObject(arg0).randomFillSync(getArrayU8FromWasm0(arg1, arg2));\n}, arguments) };\n\nexport function __wbg_newnoargs_be86524d73f67598(arg0, arg1) {\n    var ret = new Function(getStringFromWasm0(arg0, arg1));\n    return addHeapObject(ret);\n};\n\nexport function __wbg_call_888d259a5fefc347() { return handleError(function (arg0, arg1) {\n    var ret = getObject(arg0).call(getObject(arg1));\n    return addHeapObject(ret);\n}, arguments) };\n\nexport function __wbg_self_c6fbdfc2918d5e58() { return handleError(function () {\n    var ret = self.self;\n    return addHeapObject(ret);\n}, arguments) };\n\nexport function __wbg_window_baec038b5ab35c54() { return handleError(function () {\n    var ret = window.window;\n    return addHeapObject(ret);\n}, arguments) };\n\nexport function __wbg_globalThis_3f735a5746d41fbd() { return handleError(function () {\n    var ret = globalThis.globalThis;\n    return addHeapObject(ret);\n}, arguments) };\n\nexport function __wbg_global_1bc0b39582740e95() { return handleError(function () {\n    var ret = global.global;\n    return addHeapObject(ret);\n}, arguments) };\n\nexport function __wbindgen_is_undefined(arg0) {\n    var ret = getObject(arg0) === undefined;\n    return ret;\n};\n\nexport function __wbg_buffer_397eaa4d72ee94dd(arg0) {\n    var ret = getObject(arg0).buffer;\n    return addHeapObject(ret);\n};\n\nexport function __wbg_new_a7ce447f15ff496f(arg0) {\n    var ret = new Uint8Array(getObject(arg0));\n    return addHeapObject(ret);\n};\n\nexport function __wbg_set_969ad0a60e51d320(arg0, arg1, arg2) {\n    getObject(arg0).set(getObject(arg1), arg2 >>> 0);\n};\n\nexport function __wbg_length_1eb8fc608a0d4cdb(arg0) {\n    var ret = getObject(arg0).length;\n    return ret;\n};\n\nexport function __wbg_newwithlength_929232475839a482(arg0) {\n    var ret = new Uint8Array(arg0 >>> 0);\n    return addHeapObject(ret);\n};\n\nexport function __wbg_subarray_8b658422a224f479(arg0, arg1, arg2) {\n    var ret = getObject(arg0).subarray(arg1 >>> 0, arg2 >>> 0);\n    return addHeapObject(ret);\n};\n\nexport function __wbindgen_object_clone_ref(arg0) {\n    var ret = getObject(arg0);\n    return addHeapObject(ret);\n};\n\nexport function __wbindgen_throw(arg0, arg1) {\n    throw new Error(getStringFromWasm0(arg0, arg1));\n};\n\nexport function __wbindgen_rethrow(arg0) {\n    throw takeObject(arg0);\n};\n\nexport function __wbindgen_memory() {\n    var ret = wasm.memory;\n    return addHeapObject(ret);\n};\n\n"],"sourceRoot":""}